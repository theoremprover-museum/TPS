			TPSJOBS-DONE
			COMPLETED TPSJOBS
	
This file functions as the second part of the file tpsjobs.  It
provides a record of completed jobs which is useful for writing
progress reports.  When you complete a job, please move its
description from tpsjobs to the file tpsjobs-done.  Add any useful
comments, the date, and your initials if they are not already there.

Initials:
PBA	Peter Andrews
FP	Frank Pfenning
DN	Dan Nesmith
SI 	Sunil Issar
MB 	Matt Bishop
HX	Hongwei Xi
HW	Huilong Wu
CEB	Chad E. Brown
MK	Mark Kaminski
RC	Remy Chretien

(In chronological order; recent accomplishments listed last.)

=======================================================================
FP		Type Inference				Early 1980's

To: Peter Andrews <pa01@gtps.math.cmu.edu>
Cc: Hongwei Xi <hwxi@cs.bu.edu>
From: Frank Pfenning <fp@cs.cmu.edu>
Reply-to: Frank Pfenning <fp@cs.cmu.edu>
Subject: Re: *****SPAM***** Type inference in ETPS and TPS 
In-reply-to: Your message of Wed, 10 Sep 2003 10:44:37 -0400.
             <200309101444.h8AEibU13305@gtps.math.cmu.edu> 
Date: Wed, 10 Sep 2003 12:16:06 -0400

Yes, I implemented it at least once, although Dale may have taken a
first pass.

Regarding the algorithm, it is straight algorithm W, where free
type variables are (implicitly) quantified for each (top-level)
declaration or definition.  I don't recall what modification Leivant has
proposed that would be relevant here.  There is only one tricky part
of the algorithm that is not covered by Milner, namely type definitions.
I haven't used TPS for such a long time, that I have forgotten
how this goes.  Can we define new type name to abbreviate complex
types?  If so, one may need to expand them during type inference.

In any case, this extension is minor so I think just calling
it Milner's algorithm W is sufficient.

  - Frank

> Date:    Wed, 10 Sep 2003 10:44:37 -0400
> To:      Frank Pfenning <fp@cs.cmu.edu>
> CC:      Hongwei Xi <hwxi@cs.bu.edu>
> From:    Peter Andrews <pa01@gtps.math.cmu.edu>
> Subject: Type inference in ETPS and TPS
> 
> Frank,
> 	I've forgotten who implemented the type inference mechanism
> used in TPS. I suppose it was you or Dale. In our paper 
> "TPS: A Theorem Proving System for Classical Type Theory",
> Journal of Automated Reasoning 16 (1996), 321-353, we wrote
> "@tps uses a type inference mechanism based on an algorithm by
> Milner @cite[milner78] as modified by Dan Leivant.", where
> milner78 is
> 
> @article(Milner78,
>  author="Robin Milner",
>  title="A Theory of Type Polymorphism in Programming",
>  journal=jcss,
>  volume=17,
>  month=aug,
>  year=1978,
>  pages="348--375")
> 
>        We need to provide an appropriate reference to Dan Leivant's
> work. In my files I found a paper on "Polymorphic Type Inference",
> with page numbers 88-98, by him, with a copyright notice 1983 ACM, but
> I haven't been able to find exactly where it appeared. It wasn't
> Communications of the ACM or the Journal of the ACM. Dan's web page
> on Research and Publications is "in preparation". Do you know whether
> this is indeed the appropriate reference, and if so, what are
> the publication details? If some other publication would be more
> appropriate, plese tell me about it.

> 					Best wishes,
> 					Peter
> 

=======================================================================



1988 Aug. 21
DN	 Less printing of the translation process:
We need to be able to set a flag so that during the translation from an
ET-proof to an ND proof we see whichever we choose from among the following
options:
1. Everything we see now.
2. The applications of tactics which are tried and work, but not those
   which fail.
3. Very little, except for an indication that the process has succeeded.
   Actually, one can envision several variations of this; how many of them
   should be available can be determined by how easy they are to implement.
   There might be a version where there is some indication of progress,
   such as the name of each tactic that is successfully applied, so that
   viewers don't feel too much in the dark as to whether anything is
   really happening.
Can save modes in the library

DN	Make TPS available on Andrew
	ETPS into Andrew. DONE command.

SI	Interface for unification so one can call it directly on
unification problems, and use it interactively

DN	Prepare font table so that we can use scribeproof with
postscript printers. Probably there should be a flag to control which printer,
or set of printers, the mss file is intended for. Don't discard the ability
to use the dover and the x9700. Insofar as possible, use portable fonts.
-- Note: scribeproof works on all postscript printers, but documentation
   such manuals should be printed on Laserwriters only, due to the scarcity
   of fonts on the LPS-40 printers (Iron, Coal).

DN	ETPS REMARKS are mailed automatically to the instructor

SI	We need a facility to access multiple libraries within TPS. In
particular, we should be able to access TPS library, our own library,
and other libraries as appropriate.

1989 March
SI	 We should add an additional attribute ABBR to GWFFS and
ABBREVIATIONS that are stored in the library. The value of this
attribute should be the list of weak-labels and abbreviations that are
used in the definition of the gwff/abbr.

SI	User interface for unification. Uses UN88


SI	Addition of comments to library items:
	It would be nice to be able to append messages to the comments
	which are attached to items in the library.

SI	A DATEREC library command which would append to the "additional
information" on a theorem in the library a record of an attempt to
prove the theorem including:
the date, the time as recorded by RUNCOUNT, the settings of certain flags
(which flags could be determined by the value of a flag RECORDFLAGS)
and a comment supplied by the user.

SI	We should be able to reformat library files. Currently when
something in the file is modified, the other records are just dumped
in there.  Hence, there should be a command which takes a library
file, and writes it in a readable way.

SI	Fix the translation from jforms to etrees so that it will
work for higher-order formulas. Done fall 1990.

1990 Nov 7 
DN	I have redefined RuleP so that now none of the lines need exist.

1990 November
DN 	The parser interprets ~.p = ~p as ~p.
        Actually done sometime last year, I think.  Done by changing 
	the prefix priority of ~, as I recall.

DN	 superscripted variables:

1.  Only strings of the form [0-9]+ can be superscripts. 

2.  The user will explicitly indicate a superscript by the use of the "^".
    E.g., "x^0", "foo^1234567".  A "^" which is not followed by a legal 
    superscript is treated as any (non-logical-constant) character would be.
    Thus "x^" is legal input, as is "^" or "^^", or "x^y".

3.  A superscript can only be used at the end of a variable, not in the middle.
    Hence "x^1y" will be parsed as "x^1(II) y(I)" (x^1 applied to y) not 
    as "x^1y(I)" (a single variable).  

4.  Generic style will show the superscripts with the ^, i.e.,  if you enter
    "x^1(I)", then it will print as "x^1(I)" when the style is generic and
    printtypes is T. 

5.  Entering "x1" results in "x1", not "x^1", i.e., superscripts will not
    be created from the user's input unless explicitly indicated.

DN	Note that the proof of x5305 (General Cantor) which we get
automatically has lots of wffs not in normal form, and looks clumsy.
See what should be done about this.

DN	Subst= rule which does both r & l, and iterates. 1991 March 6

DN	Chapter 1 of Programmer's manual. 1991 March 6

DN	Fix things so that new versions of Common Lisp won't cause
trouble.  Also make changes so test functions and defaults will be
compiled too. 1991 Mar. 13 & April 3.

DN	19 Mar 91 
1. TPS now will compile under the new CMU CL (and more likely under new 
Common Lisp standard-to-be).
2. Some improvement in defining argument types, giving marginal speedup.
3. TPS packages are now referred to as modules.  The old functions are still
 there and will work, but will give a warning message when used.
4. Fix in the way mhelp for categories was handled.

DN	19 Mar 91 	monstro-tac (Master-tactic)

DN 	1991 Apr 26	Fix SUBJECTS so that each search procedure is
a subject.

DN	1991 May	Change tps packages to tps modules in the code
and the documentation to avoid conflicts with new versions of clisp.

DN	1991 June	When using path-focused duplication and generating
primitive substitutions, the prim-subs generator will not also duplicate
variables unnecessarily.

DN	1991 June Search procedures MS91-6 and MS91-7

SI	1991 Sept 13	The unification problems corresponding to links mating
ffpairs are put into the unification tree associated with the mating in both
orders (on different nodes of the tree), so TPS will find whichever one
works and regard it as the substitution associated with that link.

MS	1991 Sept. 16	PERMUTE editor command which replaces [A * B] by [B * A] for
any binary operator *.

SI	1991 Sept.	neg-prim-sub introduced in file prim-edops

SI	1991 SEPT.  ffpairs are mated in both directions by putting
the required pairs on different branches of the unification tree
Files: "unif-match" "ms90-3-unif-tree" "ms90-3-unif-simpl" "ms90-3-top"
 "ms90-3-unif-match" (See THM125A-D.)

	1991 SEPT.  Installation of eneg-tac:
 "ml-tactics-prop" "ml.exp"

PBA	1991 Oct	diy has been altered to call runcount and
sound bell on completion
 "diy"

SI	1991 Oct. 1	
After backtracking TPS continues working on the same path, which
prevents floundering.  Formerly, TPS removed a connection from a path,
and then went on to add a connection to another path without
immediately trying to span the path from which it had removed the only
connection. Files:
mating-dir		for ms88
option-tree-search	for ms89

SI	1991 Oct. 18
rigid.lisp is Sunil's experimental implementation of the
rigid-path check for un90.

SI	1991 Oct. 22 Bug in primsubs where variables get identified fixed
 "prim"

MS	1991 Nov. 9 (installed by PBA)
GO2 tactic (or alias for tactic) which is like MONSTRO but
doesn't use UI-HERBRAND.

SI	1991 Nov. 20 w-vars and h-vars are no longer interned; this
allows them to get garbage-collected. This seems to reduce the space
a lot, and thereby reduces the paging a lot.

SI	1991 Dec. 6 Write a function which will output matings in a
simple form (showing only the pairs of leaves) for ms90-3 output. Use
mating-verbose MIN to get this output.

SI      1991 Dec 12 Show the vpforms in ms90-3 even when mating-verbose is min.

SI	 unintern h and w variables for UN88 too.

MS	1991 Dec. 18	Make a library file containing the interesting
exercises from Pelletier, "Seventy-Five Problems ...", JAR 2 (1986),
191-216.  Leave out those involving =.  

      1991 Dec. 18 Success on THM135a using MS90-3. Important factors: 
      Matings of ffpairs of literals are in effect considered in both
orientations because of the way they are handled in the unification process.
This was later modified to avoid introducing great redundancy in the
search process
       Implementation of the rigid-path check for UN90 (the unification used
by MS90-3).
       w-vars and h-vars are no longer interned; this allows them to get
garbage-collected and greatly reduces paging in long searches.
       Unification UN90 returns failure when it gets to max-search-depth
and finds dpairs which are not flex-flex. This more rigid  cutoff
causes incompatibilities to be noticed earlier. We set max-search-depth
as low as possible.
       Disjunction heuristic implemented for ms90-3.     

SI     1991 Dec. 20 Implemented flag MAX-MATES which allows us to limit
the number of mates any occurrence of a literal can have in the mating.

-----------------------------------------------------------------------
Common patch file for 1991 July - December [This material should be
properly integrated with other material in this file.]

;;;;file mating-paths.lisp
(in-package 'auto)
(defun order-jform-components (jforms) ...

;;auto.exp
(export '(neg-prim-sub))

;;prim-edops
(defflag neg-prim-sub

;;data-structures
(defflag prim-quantifier

;;prim
(defun prim-const (resulttype logconsts w-vars length type-var)

;;data-structures
(defflag occurs-check	new message
(defflag initial-bktrack-limit	new message

;;;vpforms-tex
(defwffop vp-tex	new message

;;;prim-edops
(defun name-primsubsts (gwff)
(defun primsubsts (gwff)

;;The next fix causes ffpairs to be mated in both directions by putting
;;the required pairs on different branches of the unification tree
;;This was later modified to avoid introducing great redundancy in the
;;search process
;;Some of these are loaded later in this file
(qload "unif-match")
;(qload "ms90-3-unif-tree")
;(qload "ms90-3-unif-simpl")
;(qload "ms90-3-top")
;(qload "ms90-3-unif-match")

;;Installation of eneg-tac:
(qload "ml-tactics-prop")
;;next line is repeated later in the patch file
;;(qload "ml.exp")

;;diy has been altered to call runcount and sound bell on completion
;;and do a startcount
(qload "diy")

;; qload the new mating-dir.lisp and option-tree-search
;;so that after backtracking in non path-focused duplication procedures,
;;TPS continues working on the same path, which prevents floundering.


(qload "mating-dir")
(qload "option-tree-search")


;;Next file is Sunil's experimental implementation of the rigid-path
;;check for UN90. It will not be included in files built into tps
;;eventually change its name or incorporate it into an exisiting file
(qload "rigid")

Defined stringdtl which adds linefeeds to stringdt
(qload "core.exp")

;;Inserted more messages and timings for processing between finding
;;mating with pfd and producing nd proof
(qload "diy")
(qload "ms90-3-node")
(qload "ms90-3-expand-etree")
(qload "ms90-3-top")

;;Defined stringdtl which adds linefeeds to stringdt
(qload "macsys")
(qload "ms90-3-unif-tree")

;;next is probably a bug fix concerning superscripts on variables
(qload "prim")

;;it was using the wrong substitution function, so variables weren't
;;getting renamed properly when a term was substituted for a variable
;;in a term for which it wasn't free.
(qload "mating-merge-eq")
(qload "ml-etr-tactics-sline")

;;next we load go2
(qload "master-tactic")
(qload "ml.exp")
(qload "auto.exp")

;;w-vars and h-vars are no longer interned; this allows them to get
;;garbage-collected and greatly reduces paging in long searches
;;unification returns failure when it gets to max-search-depth
;;and finds dpairs which are not flex-flex
(qload "ms90-3-node")
(qload "ms90-3-unif-tree")
(qload "ms90-3-unif-match")

;;print out the mating
(qload "ms90-3-top")

;;improved help message for vpd-brief
(qload "vpforms-macros")

;;bug in translation of x2119
(qload "nat-etr")
(qload "ml-nat-etr2")

;;Fix message on max-utree-depth and max-search-depth
(qload "node")

;;Eliminate counter resetting which wrongly identifies 
;;variables in unification
(qload "unif-mat")

;;uninterning h and w variables for UN88
;;Eliminate redundancy in unification UN88 involving negation
;;Eliminate counter resetting which wrongly identifies 
;;variables in unification UN88
(sys-load-module 'unification)
(sys-load-module 'auto-basic)

;;print-mating-counter
(qload "auto.exp")

;;next two files contain Sunil's disjunction heuristic
(qload "ms90-3-path-enum")
(qload "ms90-3-top")

;;flag MAX-MATES which allows us to limit the number of mates any
;;occurrence of a literal can have in the mating. Two files above plus
(qload "ms90-3-path-bkup")

		End of common patch file for 1991 July - Dec
------------------------------------------------------------------------

DN	1992 Jan 7	They have changed the representation of
pathnames in cmu-cl, in particular USER-HOMEDIR-PATHNAME doesn't
return a normal path at all, just the *logical* pathname "home:".  But
actually, getting the user's name by looking at their home directory
is a hack and a pretty bad one.  I have changed tops20.lisp to improve
this for cmu-cl, allegro, lucid and kcl.  I also changed boot1.lisp
and also found a relic of tops20 code in save-work.lisp at the same
time.

---------------------------------------------------------------------
DN	1992 Jan 10
	Problem involving TRUENAME prevented building tps for the rt.
Problem resulted from a bug (or at least a faulty interpretation of
the language definition) in the old CMU lisp.  I have patched boot1.lisp
specially for this lisp.  It should work now.

---------------------------------------------------------------------
DN		1992 March 13
REMARK on Andrew will now use /usr/local/bin/mail instead of /usr/ucb/mail 
(qload "otlnl")

---------------------------------------------------------------------
DN & SI		1992 April
proofwindows (basic work)
---------------------------------------------------------------------
	Copy-etree for CMU CL
Date: Wed, 10 Jun 92 05:42:08 +0200
From: "Dan Nesmith" <nesmith@cs.uni-sb.de>

I made a couple of changes to files to fix a problem I ran across
with CMU CL. The files are etrees-labels, etrees-wffops2
and ml-etr-tactics-symsimp (actually this file was just cleaned up
a bit).

The problem was that if you define a structure type FOO1 by including another
structure FOO, then COPY-FOO doesn't copy all the slot values of a FOO1.
In our case, we define first a common ETREE structure, then define all the
types of nodes by including that structure.  But then COPY-ETREE doesn't
work properly, so you have to instead use COPY-EXPANSION (that is, use the
lowest level copy function rather than the common one).  Maybe
CMU CL is correct with this; otherwise you could just say COPY-STRUCTURE
or something and always have it work, so there wouldn't be much point in
having separate copy functions at all.  This may be how other Lisps actually
do it.  So far, however, the new CMU CL is the only version that has
caused this problem.

;;31 Jul 92 Dan Nesmith
;;same problem but with jforms instead of etrees
(qload "jforms-labels")
---------------------------------------------------------------------
;;replace pc, which was not exported from the core package, by core::pc
(qload "vpforms")
---------------------------------------------------------------------
;;1992 Aug 11 SI. Fixes bug whereby interactive unification
;;;assumes a unification tree will be in the mating; this will not be
;;;the case if one has used rem-last-conn
(qload "unif-user")
---------------------------------------------------------------------
;;;1992 Aug 18 SI. replace ren-var-uni by ren-var-uni-ho
(qload "ms90-3-unif-tree")
---------------------------------------------------------------------
MB	Proofwindows file added 1992 Sept 8
(qload "core.exp")	
(qload "tops20")
(qload "prfw")

Also PBA adjusted defpck.lisp
---------------------------------------------------------------------

MB	 We have windows for the editor which show the current
wff and the entire wff and the vpform for the entire wff ; these
windows are be updated whenever a command is issued.  Flags
govern whether these windows are automatically opened
when one enters the editor, They are all closed when one leaves it.


MB	Improved Proofwindows and edwindows added 1992 Oct 7
;;15 Oct 92 MB corrected two bugs in edtop.lisp 
;;The first is that the vpform window shouldn't be opened if
;;the AUTO package is absent; the program now tests for this
;;and ignores the EDWIN-VPFORM flag if AUTO isn't there.
;;The second is the strange `This variable is undefined :
;;CORE::TEMP' that occasionally appeared. I've finally
;;discovered why, and fixed it.
;;(qload "core.exp")		;;;added above
(qload "tops20")
(qload "wffout")
(qload "edtop")
(qload "prfw")
---------------------------------------------------------------------
HX	Texproof and tex-char	1992 Nov. 5-27
maint.exp
core.exp
deftex.lisp             prtotl.lisp             
otl-macros.lisp         scrdoc.lisp             
otl-scribeout.lisp      texchr.lisp             
tps3.ini and etps.ini

---------------------------------------------------------------------
MB	NAT-ETR		1992 Nov. 11
the command NAT-ETR
has been changed to NAT-ETREE in the source code
The files which have been altered are :
auto.exp
nat-etr.lisp
---------------------------------------------------------------------

hx	 STARTCOUNT     23 Nov 92 
I have fixed the bug in startcount. The reason is variable
'start-time' being used in two different ways: (i)Global special
variable (ii)non-special variable.
I have put the changed file ms90-3-top.lisp into $tpslisp directory.

---------------------------------------------------------------------
HX	BUG		1992 NOV 27
;;the bug  preventing you from using the default value for 'sub'
;;command in mate toplevel has been fixed. It was a very minor
;;error in the source code which made function 'dissolve-weak*'
;;not work. 
(qload "etrees-skolem")
---------------------------------------------------------------------
MB	 REDO-TOP	 29 Nov 92 
The function redo-top is called by the library, grader and report
command interpreters, despite being obsolete (the original definition is in
/afs/cs/project/tps/tps/old-source/obsolete/top.save).
This caused a crash whenever a number was input to these top levels.
to stop this I've changed :
library.lisp
grades1.lisp
report.lisp 
---------------------------------------------------------------------
MB		scribe-preamble		1992 Dec 16
Alter setq scribe-preamble to access LibraryFile(symb10)
to allow TPS access to more scribe characters
--- in particular, the "degree" symbol, which it's using in
place of a proper "compose" symbol.
.../common/tps3.ini

-------------------------------------------------------------
MB	STEP-THRU		1992 Dec. 17
;;EXECUTE-FILE can be used in step-thru mode, particularly when proofwindows
;;are open, to show how the proof grows
(qload "save-work")

--------------------------------------------------------------
MB	LIBRARY			1992 Dec. 28

core.exp           
contexts-core.lisp 
lib-ops.lisp       
lib-macros.lisp    
lib-objects.lisp   
theorem-mac.lisp   
library.lisp       

o  New commands SHOW-WFF, SHOW-HELP, SHOW-WFF&HELP which
   display only the relevant parts of a saved object.
o  New commands SHOW-WFFS-IN-FILE and SHOW-ALL-WFFS which
   show all wffs in a file / the entire default directory.
o  A new command INITIALISE-NEW-INDEX which prompts for a
   new default directory and then calls RESTORE-MASTERINDEX.
o  RETRIEVE is now called FETCH (so that command completion
   will work on RETRIEVE-FILE).
o  A new flag BACKUP-LIB-DIR has been introduced, which is
   consulted by most of the library functions; if an object
   or file cannot be found in DEFAULT-LIB-DIR, then the
   program will look at BACKUP-LIB-DIR. No attempt is ever
   made to write to BACKUP-LIB-DIR. If this flag is set to "",
   it will be ignored and the system will behave as before.
o  New commands COPY-LIBOBJECT and COPY-LIBFILE do exactly
   what you'd expect - by default, they copy from BACKUP-LIB-DIR
   to DEFAULT-LIB-DIR, copying the needed-objects too.
o  New commands SCRIBELIBFILE and TEXLIBFILE output the files
   of objects to Scribe and TeX. There are three "verbosity"
   settings : MIN is equivalent to LIBOBJECTS-IN-FILE, MED
   prints the wffs and their help messages as well (and so is
   equivalent to MIN if the file contains no gwffs or abbrs),
   and MAX prints everything.
   The Scribe output is prettier, in my opinion...
o  INSERT now retrieves the needed-objects so that it can
   type-check the given gwff. (This fixes a reported bug.)
o  INSERT MODE now uses <RETURN> for the default value, and <!>
   to mean "do not save this flag".
o  All objects, when loaded, are defined either as TPS theorems
   AND abbreviations, or as TPS modes. There is a new sort of
   TPS theorem (along with BOOK, EXERCISE, etc) : LIBRARY.
   Only LIBRARY theorems may be redefined. This all only works
   for EXPERTFLAG T.
o  The above means that theorems may now be ASSERTed, and gwffs
   can be instantiated, and abbrs can be used as gwffs. (If you
   have EXPERTFLAG T.)
o  The library contexts have been redefined (because almost
   everything was under "Miscellaneous").
o  You now get your choice of output file with scribelibfile
   and texlibfile.
o  "Medium" verbosity in these two commands now suppresses
   the type information, and also the :description and :mhelp
   messages.
o  There is a new command LIBFILES which lists all the library
   files in DEFAULT-LIB-DIR. (Note that because this works by
   checking which files are referred to in the index, there
   is no guarantee that the files actually exist... for example,
   in .../andrews/, LIBFILES will show a non-existant file "thm".)
--------------------------------------------------------------------
MB	ETREE-NAT		1992 Dec 30

ETREE-NAT output now goes to the
proofwindows, and many more tactics now prompt for a
Yes/No response when in interactive mode. The commands which 
do this are:
UI, ABSURD, RULEC, INDIRECT2, EQUIV-IMPLICS, EQUIV-DISJ,
LCONTR*, AB-SLINE, EQUIV-WFFS-SLINE, RULEQ-SLINE,
LEIBNIZ=-SLINE, EXT=-SLINE, INESS-PLINE, CLASS-DISJ,
NEG-ATOM-ELIM, DISJ-EQUIV, INEG, INDIRECT.
(See *2.2 in tps3.hlp for a description of how to make
good use of this.)

etr-nat-macros.lisp
ml-etr-tactics-neg.lisp
ml-etr-tactics-pline.lisp
ml-etr-tactics-sline.lisp
tactics-macros.lisp

--------------------------------------------------------------------
MB		MS92-9			1992 Dec31
		SIMULATE MS88 IN MS90-3
	Uses the representation which is in MS90-3, but duplicates
quantifiers as in MS88. Thus we avoid maintaining two basic 
representations of the same way of searching paths and building
up matings.

core.exp
contexts-auto.lisp
diy.lisp
mating-top.lisp
ms90-3-top.lisp
ms92-9-top.lisp (new file)
defpck.lisp

-------------------------------------------------------------------
HX		NEW EDITOR COMMANDS		1993 Jan 4
core.exp
contexts-core
wffchange.lisp		;;;new file
;;defpck.lisp	adjusted to put the new file in the module wff-ops1
-------------------------------------------------------------------
HX		TIMING RECORDS			1993 Jan. 4

	Clean up the way TPS reports how long it takes to do search
and the complete time for a proof.  make as uniform as possible the
type of timing statistics we have when using different versions of
lisp and when using different search strategies.  Make daterec save
and record the information in all cases.  Have more complete
information printed out at the end of the DIY process.

auto.exp
diy.lisp             
etr-nat-macros.lisp  
lib-ops.lisp         
library.lisp         
mating-dir.lisp      
mating-mateops.lisp  
mating-merge.lisp    
mating-top.lisp      
ms90-3-top.lisp      
ms91-search.lisp     
------------------------------------------------------------------
HX	 BUG in facilities guide	 13 Jan 93 
Every tps-object should have a CONTEXT property, but
the property is not defined for lisp packages
core, auto, maint, ml,...

/afs/cs/project/tps/tps/doc/facilities/facilities.lisp
defpck.lisp 		(add two contexts)
------------------------------------------------------------------
MB	DEFFILES		15 Jan 93 

New deffile commands added to files so that they will show up in
the facilities guide.

Files (all in /afs/cs/project/tps/tps/lisp/) that have been changed:
boot0.lisp
boot1.lisp
compl.lisp
etrees-print.lisp
linereadp.lisp
lsppck.lisp
mating-paths.lisp
ml1-logic0.lisp
ml1-logic1.lisp
ml1-logic2.lisp
ml1-logic3a.lisp
ml1-logic3b.lisp
ml1-logic4.lisp
ml1-prior.lisp
ml1-theorems.lisp
ml2-abbrev2.lisp
ml2-axioms.lisp
ml2-logic1a.lisp
ml2-logic1b.lisp
ml2-logic1c.lisp
ml2-logic2a.lisp
ml2-logic2b.lisp
ml2-logic4a.lisp
ml2-logic4b.lisp
ml2-logic4c.lisp
ml2-logic5a.lisp
ml2-logic5b.lisp
ml2-logic7a.lisp
ml2-logic7b.lisp
ml2-replace.lisp
ml2-theorems.lisp
ms90-3-exp-jform.lisp
ms90-3-jform-to-etree.lisp
ms90-3-prop.lisp
replace.lisp
report-init.lisp
report-stats.lisp
tops20.lisp
tps3-error.lisp
tps3-save.lisp
unif-aux.lisp
unif-lambda.lisp
unif-match.lisp
unif-simpl.lisp
unif-subs.lisp
unif-subsump.lisp
unif-tree.lisp
-----------------------------------------------------
MB		Library		 15 Jan 93
 core.exp,
library.lisp
lib-ops.lisp
lib-objects.lisp

The new files do the following:

1) fix the annoying bug with daterec.
2) warn that a file is being rewritten and re-parsed.
   (since this may take some time, and loading the needed
   objects for the parser may produce messages on-screen)
   (this rewriting happens when objects in a file are deleted
   or modified)
3) fix a couple of fairly obscure bugs in copy-libobject,
   delete and fetch.
4) introduce a move-libobject command for moving objects
   within one directory.
5) fix the "Overwriting..." bug so that TPS only says this
   if it's true.

-----------------------------------------------------
HX	countsubs-first flag		1993 Jan 16
;;Sunil's code for counting substitutions before applying them
;;with flag 'countsubs-first' to choose whether or not to do this
(qload "auto.exp")
(qload "ms90-3-unif-match")
(qload "ms90-3-unif-tree")

Introduce a flag called COUNTSUBS-FIRST in the subject
UNIFICATION with the help message:
"if NIL, the substitutions which MATCH generates for each dpair in the
unification process are generated and counted, and then MATCH is
actually applied to the variable for which this number is smallest; if
T, the substitutions are counted before they are generated, and only
those which will be applied are actually generated."

-----------------------------------------------------
HX		RIGID-PATH-CK		18 Jan 93 

I have added in the flag 'rigid-path-ck'.
The changed files are
(i) defpck.lisp: Now the file ms90-3-unif-simpl.lisp
appears before the file ms90-3-node.lisp because I
define 'ho-simpl' as a macro-function, which is a
usual function before, and is used in ms90-3-node.lisp.
(ii) ms90-3-unif-simpl.lisp: Now ms90-3-unif-simpl.lisp is
the union of the old file ms90-3-unif-simpl.lisp and
rigid.lisp, with the flag 'rigid-path-ck' and macro-function
'ho-simpl'.
(iii) auto.exp: 'rigid-path-ck' has been exported in it.

;;put the flags RIGID-PATH-CK and COUNTSUBS-FIRST
;;into the correct contexts
;;(qload "ms90-3-unif-simpl")
;;(qload "ms90-3-unif-tree")

-----------------------------------------------------
MB		MOVE-LIBOBJECT	19 Jan 93

version of MOVE-LIBOBJECT that allows a list of objects to
be moved at once
-----------------------------------------------------
HX		 New TEXPROOF	 24 Jan 93 

I've finished a new TEXPROOF.
I introduced a new flag 'tex-mimic-scribe'.
If the flag is T, TEXPROOF will give usHX		RIGID-PATH-CK		18 Jan 93 

I have added in the flag 'rigid-path-ck'.
The changed files are
(i) defpck.lisp: Now the file ms90-3-unif-simpl.lisp
appears before the file ms90-3-node.lisp because I
define 'ho-simpl' as a macro-function, which is a
usual function before, and is used in ms90-3-node.lisp.
(ii) ms90-3-unif-simpl.lisp: Now ms90-3-unif-simpl.lisp is
the union of the old file ms90-3-unif-simpl.lisp and
rigid.lisp, with the flag 'rigid-path-ck' and macro-function
'ho-simpl'.
(iii) auto.exp: 'rigid-path-ck' has been exported in it.

;;put the flags RIGID-PATH-CK and COUNTSUBS-FIRST
;;into the correct contexts
;;(qload "ms90-3-unif-simpl")
;;(qload "ms90-3-unif-tree")

a good-looking tex output(like the corresponding
scribe output); Otherwise, the original tex output
will be produced. The default value of the flag is
T.
(qload "otl-macros")
(qload "deftex")
(qload "otl-scribeout")
(qload "pprint")
(qload "prtotl")

-----------------------------------------------------
HX	SUB command in MATE toplevel	 25 Jan 93

Now you can use SUB command in MATE toplevel
even when 'default-ms' is set to MS88 or MS89.
etrees-wffops.lisp
-----------------------------------------------------
HX		TIMING		25 Jan 93
Timing facilities now work with MS89
option-tree-search.lisp
-----------------------------------------------------

MB	LIBRARY PROBLEM		 03 Feb 93

I think I've resolved the problem with there being "too
many files open" if you do SHOW-ALL-WFFS.

A possible problem was that with retrieve-libobject being called
recursively, the names of old streams were being overwritten before
they could be closed.
I also found a subtle problem with
fetch which caused an error if the needed-objects were in the
library under more than one type; needed-objects are now assumed to
be abbreviations, unless no abbreviation of the right name can be
found, in which case they're assumed to be gwffs.
	The library will now allow you to nest items as deeply as your
heart desires.

(qload "lib-ops") 
-------------------------------------------------------------
MB & DN		Exporting filenames	 05 Feb 93

	Change the definitions of defmodule and deffile
to always export the file names from the current package.
You would have to still be sure to export the module names in order to
get help on them.
boot0.lisp
boot1.lisp 

-------------------------------------------------------------
MB		Part-of and DEFPCK agree 	05 Feb 93

I've checked through all the defpck and part-of commands, and
changed the following. Where there was a conflict, I usually
believed what it said in defpck.lisp... (more comments below)

---------------
edchange was part-of both wff-ops1 and wff-editor; it's
        now only part-of wff-editor.

etrees-jforms was part-of both jforms and expansion-tree; it's
        now only part-of expansion-tree.

etrees-skolem was part-of expansion-tree, and in defpck it was
        part-of mating; it's now part-of mating.

etrees-labels was part-of expansion-tree, etrees *and* mating; it's
        now part-of mating.

mating-top and data-structures and mating-macros were all part-of
        ms88, mating-search *and* mating, and are now part-of mating.

mating-move and mating-mateops were part-of ms88 and mating, and are
        now part-of mating.

wff-skolem-mac was part-of development-seqs and skolemizing, and is
        now part-of skolemizing.

jforms-edops was part-of jforms and vpforms, and is now part-of
        jforms. (Defpck said it should be vpforms, but this seems
        silly...?)

saveproof was part-of save-tps-work and otlnl,and is now part-of
        otlnl.

otl-rulep was part-of otlrulep and tps2-rulep, and is now part-of
        otlrulep.

ml1-theorems was part-of math-logic-2-exercises and
        math-logic-2-rules, and is now part-of the former.

ml2-logic7c was part-of otlsuggest and math-logic-2-rules, and is
        now part-of the latter.

ms90-9 was part-of ms89 and ms90-9, and is now part-of ms90-9.

ml-logic0 / ml1-logic3a / ml1-logic3b are in two places in defpck
        (math-logic-1-rules and math-logic-2-rules); I've left this
        as it stands.....

-------------------------------------------------------------



MB		 MS93-1			09 Feb 93

ms93-1.lisp		entirely new file
ms90-3-top.lisp
ms92-9-top.lisp
contexts-auto.lisp : the only change is to add a new context, ms93-1.
diy.lisp           : the only change is to add ms93-1 to the list of
                     acceptable names for matingsearches.
option-tree-search.lisp : the only change is to add ms92-9 and ms93-1
                          to the list of matingsearches.
mating-top.lisp    : ditto, for two mhelp messages and the
                     matingsearch-controller function.
core.exp           : only new function which is exported is ms93-1.
defpck.lisp        : ms93-1 added in module ms90-3 (where ms92-9 is).


-------------------------------------------------------------
PBA	added exercises			1993 Feb 9
;;added x5308, x6105, X6106, and some book theorems (axioms)
(qload "ml.exp")
(qload "ml2-theorems")
(qload "ml2-axioms")
--------------------------------------------------------
MB		MS93-1			1993 Feb 9
;;installed ms93-1
(qload "core.exp")
(qload "diy")
(qload "contexts-auto")
(qload "ms92-9-top")
(qload "ms93-1")
(qload "mating-top")
;(qload "option-tree-search") ;; already loaded once, below...
(qload "ms90-3-top")

------------------------------------------------
HX		Time Units		 09 Feb 93
Now other time units are available.
mating-mateops.lisp.
------------------------------------------------
DN	;;avoid CMULisp constant compilation	1993 March 5
Replace '(lambda (x) x) by (list 'lambda (list 'x) 'x)
;;this was the bug where cmulisp didn't work but allegro did
(qload "tacticals-macros")
(qload "tacticals")
-----------------------------------------------------------------
HX		PRETTIFY BUG		 06 Mar 93

mating-merge-eq.lisp
-----------------------------------------------------------------
MB		HELP MESSAGES FOR EXERCISES		07 Mar 93 

The help command for exercises has been fixed to
print allowed lemmas in help message for theorems
help x5207 now says:
You may use the following theorems, without proof, as lemmas : (X5201 X5205)
(qload "theorem-mac")
added to core.exp:
        only-required-lemmas-help
        theorem-no-help
        allow-lower-nos-help
        allow-no-lemmas-help
-------------------------------------------------
HX		TPS-WARNING		08 Mar 93 

The function "warning" has been renamed as "tps-warning".
The changed files are
boot0.lisp boot1.lisp 
otl-fileout.lisp 
replace.lisp
-------------------------------------------------
HX	TPS no longer confused by the type symbol S	11 Mar 93 
tpinf.lisp
-------------------------------------------------
MB	Problem making TPS	16 Mar 93
Attempt to  make TPS gave message
Error: Exporting these symbolsfrom the `CORE' package:
    CONTEXTS-AUTO
results in name conflicts with these packages:
    AUTO ML
This was caused by Dan's changes to boot0.lisp, 
adding lines to export all the filenames. The problem was that some of them
(for example, contexts-auto) were already exported, from other
modules. These conflicts prevented TPS from compiling properly.
Anyway, I've fixed it (I think; it certainly seems to compile now)
by checking that the symbol about to be exported is not already a
known symbol.

texchr.lisp generated more warnings
Error in "Top-Level Form":  the variable ->I is unbound.
Hongwei found the problem
----------------------------------------------------------------
MB 		UPDATE ETPS MANUAL		16 Mar 93 
ETPS manual: the commands LET, SUBST=, ABSURD, ENEG, INEG and
LAMBDA* have all been added
----------------------------------------------------------------

MB 		PROOFWINDOWS AND GO2	17 Mar 93 

Any call to ^p or pall will update the proofwindows if they're open
and their flags are T. This includes calls embedded in the code.
There are two new functions (prfw-pall and prfw-^p) which perform
pall and ^p in the appropriate window, if it's there, and do nothing
otherwise. (These are not TPS functions, but are exported in case you
need them anywhere else.)

GO2 is now a full TPS function with its own help message;
GO2-TAC already contained a call to ^p, and I've added a call to
prfw-pall, so both the windows are updated.

;;;tidying up the proof windows and making go2 a real command.
(unintern 'go2 'ml)   ; this won't be needed after we rebuild
(unalias go2)         ; ditto
(unintern 'go2 'user) ; ditto
(qload "auto.exp")
;(qload "core.exp")
;(qload "save-work")
(qload "otl-prt")
;(qload "tacticals-macros")
(qload "master-tactic")
(qload "prfw")

----------------------------------------------------------------
HX	Texproof bug 		 20 Mar 93 18:28:20 EST

I found texproof had a minor bug when it tried to
break a line in my proof of X6201. I added two
tex macros, which are in tps.tex now, and I also
changed the following three files
(qload "deftex")
(qload "otl-scribeout")
(qload "pprint")
-----------------------------------------------------------------
MB		ETREE-NAT and proofwindows	Mar 26, 1993

Last December it was announced that when one is using ETREE-NAT in
interactive mode, output goes to the proofwindows. This stopped
working, but is now fixed.
(qload "etr-nat-macros")
(qload "tactics-macros")
-----------------------------------------------------------------
HX	BUG in restoreproof		28 Mar 93

restoreproof was confused by the following formula:
~r(OI) SUBSET LAMBDA x(I) TRUTH (for X6106)

The deeply hidden bug is caused by that
the binding priority of SUBSET is the same as the binding
priority of NOT. But the printing stuff and the parser have
different rules to treat such a case.
This rule is the same as the one used in the
parser of tps3. So the bug has been fixed
while the parser is left intact.

PRT.LISP
------------------------------------------------------------
HX	added in some tex symbols	28 Mar 93
to represent '<=', zero, finite, ...
core.exp 
texchr.lisp
------------------------------------------------------------
HX		Bug fix			01 Apr 93

Fixed the following bug:
For any propositional statement, even "p implies p" MS88 finds a
mating and then halts claiming that no proofs have been finished. This
bug goes away once a non-propositional statement has been proven, and
results from new timing facilities.

mating-dir.lisp         mating-sub.lisp
mating-mateops.lisp     mating-top.lisp
------------------------------------------------------------
MB		Scribe characters		06 Apr 93 
Scribe can now print SETUNION and COMPOSE (an enlarged degree 
symbol being printed as a subscript)
/afs/cs/project/tps/common/doc/lib/tps.mss
------------------------------------------------------------
MB		 Book theorems			 07 Apr 93
After we next rebuild TPS, book theorems should appear under the
correct heading. 
(qload "contexts-core")
(qload "contexts-ml")
(qload "ml2-axioms")
------------------------------------------------------------

MB		Scribe preamble			08 Apr 93 

The Scribe preamble in /afs/cs/project/tps/common/tps3.ini 
and /afs/cs/project/tps/common/etps.ini
have been changed to add
@LibraryFile(KSets)
@LibraryFile(Mathematics10)
and we now have access to (I hope) all the mathematics characters
in Scribe.
------------------------------------------------------------

MB		PROOFLIST			 08 Apr 93

PROOFLIST provides a list of all the proofs that have been started.
The help message for RECONSIDER has been changed to mention PROOFLIST.
core.exp
(qload "otlnl")
(qload "saveproof")
etr-nat-macros.lisp
-------------------------------------------------------------------
MB	HELP MESSAGES FOR LIBRARY ITEMS		15 Apr 93
lib-ops.lisp
-------------------------------------------------------------------
HX	new timing facilities			18 Apr 93
mating-mateops.lisp mating-top.lisp
-------------------------------------------------------------------
HX	New command interpreters		20 Apr 93 
I just commented out the original ones.
mating-top.lisp edtop.lisp top.lisp
-------------------------------------------------------------------
HX						 22 Apr 93
TEXPROOF asks if you would like to print out a timing table with
the proof. 
mating-mateops.lisp otl-scribeout.lisp
-------------------------------------------------------------------
MB						22 Apr 93
Needed-modules are now listed in the facilities guide.
scrdoc.lisp
-------------------------------------------------------------------
HX			CHARDOC			24 Apr 93
Chardoc is ready to produce a complete documentation
in both TEX and SCRIBE styles.
scrdoc.lisp
-------------------------------------------------------------------

DN, MB		Allegro4.1		 26 Apr 93 

From: "Dan Nesmith" <nesmith@cs.uni-sb.de>
Here are the changes I think are necessary to get TPS to work in
Allegro 4.1:

1.  in boot0.lisp

1.a slightly different from before, use cltl1 compatibility as a crutch

#+(or :allegro-v4.1 :allegro-v4.0)
(defun int-char (int) (cltl1:int-char int))

(deftype tps-string-char ()
  #+(or :allegro-v4.1 :allegro-v4.0)
  'cltl1:string-char
  #-(or :allegro-v4.1 :allegro-v4.0)
  'string-char)

1.b.
 Change definition of macro WARNING to:

(defmacro tps-warning (&rest l) `(complain t "WARNING:  " ,@l))

Then you shouldn't need to set *enable-package-locked-errors* to nil.

2a. in boot1.lisp and replace.lisp

Change occurrences of WARNING to TPS-WARNING.

2b. in special.exp
 remove WARNING where it occurs

2c. core.exp
  export TPS-WARNING

3.  in tops20.lisp

#+(and (or :excl :allegro) (not (or :allegro-v4.1 :allegro-v4.0)))
(defun linelength (&optional (n nil))
  (if (null n)
      excl::pp-line-length
    (setq excl::pp-line-length n)))

#+(or :allegro-v4.1 :allegro-v4.0)
(defun linelength (&optional (n nil))
  (if (null n)
      common-lisp:*print-right-margin*
    (setq common-lisp:*print-right-margin* n)))

4. in wffin.lisp

(defun empty-fill-string ()
  (make-array '(1) :element-type 'tps-string-char :fill-pointer 0
              :adjustable t))

5. To avoid annoying warning messages, change all forms like

(in-package 'core)
   to
(in-package :core)

From: Sebastian P Weetabix <Matt_Bishop@K.GP.CS.CMU.EDU>
Thanks to Dan's helpful message, I've finally compiled TPS in
ACL4.1
Dan's changes were all used except:

>1.b. Change definition of macro WARNING to:
>(defmacro tps-warning (&rest l) `(complain t "WARNING:  " ,@l))
>Then you shouldn't need to set *enable-package-locked-errors* to nil.

HongWei had already done this, and it turns out that we still need
to have *enable-package-locked-errors* set to nil (otherwise it fails
when it reaches TOP-LEVEL-READ-EVAL-PRINT-LOOP in tops20.lisp)

>2a. in boot1.lisp and replace.lisp
>Change occurrences of WARNING to TPS-WARNING.

HongWei did this, too.

>5. To avoid annoying warning messages, change all forms like
>(in-package 'core)
>   to
>(in-package :core)

I've done some of these, and will do the rest sometime soon.

I've found one bug (in the definition of the MODE function; I've
changed the patch file to add FLAGGING.LISP to fix this)

-------------------------------------------------------------------

DN		Drastic improvement of merging		 27 Apr 93 
I've modified mating-merge.lisp in the following ways:
1.  Don't do pruning of unnecessary nodes at the beginning of the merge,
    when the tree is its greatest size. 
2.  Instead, *do* prune all branches that couldn't possibly have been used 
    They are those that have a zero status. This is probably not necessary,
    but certainly makes debugging easier and doesn't cost much.
3.  After merging of identical expansions has been done, call the original
    pruning function.
See THM131
-------------------------------------------------------------------
MB			Vpform window		 27 Apr 93 
OPEN-MATEVPW and CLOSE-MATEVPW. In addition,
the DIY and MATE commands have been changed slightly so that they
will open the windows on request (but *won't* close them again;
that's up to you...). 
(qload "auto.exp")
(qload "vpforms")
;(qload "diy")
;(qload "mating-top")
(qload "ms91-search")
(qload "option-tree-aux")
(qload "unif-aux")
-------------------------------------------------------------------
SI, HX, PBA							1993 May 4
		UNIFICATION and SKOLEMIZATION
	The implementation (all versions) of higher-order unification
contains a bug.  The "necessary arguments" of Skolem functions are not
handled quite right.  This probably makes the algorithm incomplete,
but not unsound.
	See unif-match.lisp construct-imitation-term lines 144,156,169.
This is for UN88.
p. 188 refers to sk-const-p; UN90 probably doesn't have this.
See lines 230-260?
	Thus seems to be fixed now. We are now using the second oldest
version of the function imitation-eta so that Skolem functions will
not be used as choice functions. The old version has been moved to
/afs/cs/project/tps/tps/old-source/unif-match.lisp-to-1993-May-4
(qload "unif-match")

Still have a problem with ms90-3
----------------------------------------------------------------------------
MB		Looking at vpwindow output		13 May 93
vpshow

 minor change to handling of VPW
(qload "vpforms")
-------------------------------------------------------------------------
MB		GR-EXIT					14 May 93 

There already was a function, QUIT, that did the job of leaving
grader without leaving TPS --- but it was never exported. I renamed
it GR-LEAVE and exported it; we now have GR-EXIT and GR-LEAVE which
do as you'd expect...
Changes to the *GRADER* patch file: ($tpslisp/grader.patch)
(qload "teacher.exp")
(qload "grades2")
(qload "grades1")
---------------------------------------------------------------------
MB		Document the string-char problem        14 May 93 
---------------------------------------------------------------------
MB		LIBRARY OUTPUT FILES ORDERED		14 May 93 
The output from LIST-OF-LIBOBJECTS, LIBFILES, SCRIBELIBFILE, TEXLIBFILE and
SHOW-ALL-WFFS, which was previously presented in hashtable order,
is now sorted into alphabetical order.
(qload "library")

----------------------------------------------------------------------------
MB 	INITIAL-BKTRACK-LIMIT, ADD-CONN* and REM-CONN*		20 May 93 

INITIAL-BKTRACK-LIMIT is now of type integer+-or-infinity, and the
value "infinity" has the obvious effect.

New commands ADD-CONN* and REM-CONN* recursively add and remove
connections in the mating.

(qload "auto.exp")
(qload "mating")
(qload "mating-dir")
(qload "mating-aux")
(qload "mating-mateops")
(qload "data-structures")
----------------------------------------------------------------------------
MB	 Useless substitutions not printed		21 May 93

"substitutions" that don't change anything aren't printed out into
either the main window or the vpform window.
;(qload "vpforms")
(qload "ms91-search")
(qload "option-tree-aux")
----------------------------------------------------------------------------
MB							24 May 93 
fix bug in move-libobject so that it removes the item from the old file.
;(qload "library")
----------------------------------------------------------------------------
MB	GO2 and MONSTRO now do lambda-conversion	24 May 93 

	I've written tactics lexpd*-tac and lcontr*-tac for nat-ded,
and fixed monstro and go2 so that they will apply these tactics.  I
also changed MONSTRO from an alias to a mexpr, so that it now appears
as a command with a help message, like GO2.
	The tactics are only applicable to lines which are different
from their lambda normal forms, to prevent recursive tacticals from
going into an endless loop.
(qload "ml-tactics-quant")
(qload "master-tactic")
----------------------------------------------------------------------------
MB							25 May 93 
Both scribelibfile and texlibfile can now take a list of input
and output file names.
----------------------------------------------------------------------------
MB							25 May 93
Put COND and THAT (and any other missing abbreviations) into section
5.1.2 of the ETPS manual. 
----------------------------------------------------------------------------
MB							26 May 93 
ADD-CONN* and REM-CONN* now work properly with workfiles.
----------------------------------------------------------------------------
MB							 27 May 93
Changed all the
(in-package 'whatever)
forms to
(in-package :whatever)
because Allegro 4.1 complains about the former.
----------------------------------------------------------------------------
HX	 Speeding up the proof search in MS88, etc.	30 May 93 
I modified the file mating-dir.lisp to speed up
the proof search in MS88. The changes are local.
I put my comments around all the changes. If the
new code contains serious bugs, we can simply restore
the original code by reading the comments. 
-----------------------------------------------------------------------------
MB		New primitive substitutions		30 May 93

	The mechanism for generating more primitive substitutions has
been finished and installed. All the new substitutions are generated
at the same time as the old ones (you can see them by using the editor
command PRT-PRIM). The depth to which they are generated is governed
by the new flags MIN-PRIM-DEPTH and MAX-PRIM-DEPTH (see the help
messages for more information).
Now we get "gensubs" which are wffs in prenex normal form with
matrices in cnf or dnf
	Backward compatibility: by setting MIN-PRIM-DEPTH 1 and
MAX-PRIM-DEPTH 1, you get exactly the same substitutions as before.
(qload "prim")
-----------------------------------------------------------------------------
MB	Documentation job			30 May 93

>Add to system.mss the entry
>@seealso[Primary="Quitting",Other="@t(LEAVE)"]
>near other items dealing with quitting in that file.
>Put OK (and perhaps other editor commands) into the index.
I also added an entry for LEAVE.

I've also indexed all of the editor commands, fixed the indexing of the
abbreviations so that they show up in the body of the index instead of
on their own at the beginning, corrected some minor Scribe errors in
the ETPS manual, and tidied up some of the indexing.

I added a description of the editor windows and the
flags EDWIN-TOP and EDWIN-CURRENT

There is now a little information about REVIEW in the ETPS manual.
-----------------------------------------------------------------------------
MB	KEY and SEARCH commands				01 Jun 93
The review command KEY has now been implemented,
and the bug in the editor SAVE command has been fixed.
I've extended the KEY command to make the new review command
SEARCH, which looks for a given phrase in the help messages of all
TPS objects (not just flags).
;; Add KEY function
(qload "review")
;; Correct editor SAVE function
(qload "wffsav")

-----------------------------------------------------------------------------
MB	Bug fix : CNTOP				01 Jun 93
I fixed the minor bug in CNTOP that we noticed earlier; notice that
CNTOP does not now need to have its argument quoted (ie you can type
CNTOP EXISTS rather than CNTOP 'EXISTS).
(qload "wffchange")
(qload "edchange")
-----------------------------------------------------------------------------
MB		fix mhelp for tactics			02 Jun 93 
I just fixed a minor bug with the handling of mhelp
for tactics (some mhelp messages weren't getting printed out).
(qload "tactics-macros")
-----------------------------------------------------------------------------
MB		More documentation			03 Jun 93
I've added the library documentation to the user guide,
I've also added the editor flags (or, at least, the more relevant of
them) and HongWei's new editor commands to the ETPS manual.
-----------------------------------------------------------------------------
MB					04 Jun 93
Fixed: In GR-Review, SUBJECTS lists two subjects but LIST doesn't work
on either.
teacher.exp
-----------------------------------------------------------------------------
MB					04 Jun 93
Changed maint.exp, core.exp, pck.lisp, boot1.lisp, maint.lisp
to comment out the last remnants of references to packages. This
also takes out UNLOADED-PACKS and CLOAD-PACKAGE, plus some other
functions.

-----------------------------------------------------------------------------
HX	MORE GENERAL ORDER-COMPONENTS		6 Jun 93

	ORDER-COMPONENTS takes values of type SYMBOL instead
of BOOLEAN so that we can add other options from time to time. 
	PREFER-RIGID1: Assign to each subformula of a jform a number as
follows: a flexible literal gets a 1, a rigid literal gets a -1.
Conjunctions and disjunctions get numbers which are the sums of the 
numbers of their components. Order the components in each subformula in
non-decreasing order. Thus the components with many rigid literals have
the smallest numbers and come first.
(qload "auto.exp")
(qload "mating-dir")
(qload "ms90-3-top")
(qload "ms90-3-exp-jform")
(qload "newrulep-tsts")
;;new file:
(qload "order-components")
defpck.lisp has been modified.
Right now the value PREFER-RIGID1 is meaningless in
ms90-3, but I am going to change this.
-----------------------------------------------------------------------------
MB		Linking tps files on Andrew	07 Jun 93

I've linked the build and compile files for tps and etps on Andrew to
those in the cs cell.  Although I seriously doubt that we'll ever need
them, the old files are in the directory
/afs/andrew/mcs/math/etps/old-common, renamed with names that end in
-1993jun7.
There are some necessary differences in the Makefiles, so these have
not been linked.
-----------------------------------------------------------------------------
HX		 Warnings on ORDER-COMPONENTS	08 Jun 93 
Warnings came from redefining ORDER-COMPONENTS.
Now I have removed the original definition of ORDER-COMPONENTS
in jforms.lisp.
-----------------------------------------------------------------------------
MB	Mate commands NAME-PRIM, PRIM-SINGLE		08 Jun 93 

I've added two commands to the mate top level: the first is
NAME-PRIM (which is the same as that in the editor top level,
and applies to the shallow formula of the current etree),
and the second is PRIM-SINGLE, which applies one of these
substitutions to the etree. (PRIM-SINGLE is effectively
the same as SUB-ETREE followed by DP* followed by CJFORM.)

It appears to be much more complicated to write an equivalent
command for the editor, so I haven't yet done this. But at least we
can now generate and apply a substitution without having to move
back and forth between the editor and the mate top levels.
(qload "auto.exp")
(qload "etrees-wffops2")
-----------------------------------------------------------------------------
HX		SHOWING MODES				12 Jun 93

Now you can get a more readable output when you try SHOW command to
show modes. Actually SHOW command already has the ability to put
indentations in outputs when it writes to a file.  I simply modified
SHOW so that it does the same thing to a screen as to a file.
(qload "lib-objects")
-----------------------------------------------------------------------------
HX		SILENCING PROOF SEARCH			12 Jun 93 

Now you can set mating-verbose to silent, then you only see some
dots(if you prefer to get rid of them, it can be easily done),
possibly with GC information, during proof search in ms88.  When
mating-verbose is SILENT,  UNIFY-VERBOSE will be set to NIL
by the search process .

 silence ms88:
mating-dir.lisp         option-tree-search.lisp
mating-events.lisp      unif-tree.lisp

 silence ms90-3:
ms90-3-top.lisp ms90-3-node.lisp
ms90-3-expand-etree.lisp
-----------------------------------------------------------------------------
HX	MORE GENERAL ORDER-COMPONENTS FOR MS90-3	14 Jun 93

Implementing the more general ORDER-COMPONENTS code for ms90-3
required understanding how to transform the results of the search into
the etree.  The method used is to change the datastructure JFORM by
adding in a new slot, POSITION, which records the initial position of
a jform in a conjunction or disjunction.  When a proof search is done,
we can recover the original order of universal quantifiers in a jform
by using POSITION slot.
jforms-labels.lisp 
order-components.lisp
ms90-3-exp-jform.lisp 
ms90-3-node.lisp
-----------------------------------------------------------------------------
HX	mating-verbose, first-order-mode		14 Jun 93 
The help message for mating-verbose has been
changed apropriately, and the values for mating-verbose
is restricted to the type VERBOSE, which only includes
SILENT, MIN, MED and MAX.
Besides, the name of flag FIRST-ORDER-MODE has changed to
FIRST-ORDER-MODE-PARSE now.
wffinm.lisp 
etrees-flags.lisp
-----------------------------------------------------------------------------
MB		Change to vpw				15 Jun 93
Vpwindows now print the final mating and show substitutions
for MS88.
option-tree-search.lisp
ms90-3-top.lisp
mating-dir.lisp
mating-sub.lisp
vpforms.lisp
-----------------------------------------------------------------------------
HX		DATEREC					17 Jun 93
Now DATEREC works while recording a totally interactive proof.
timing.lisp library.lisp library.lisp
-----------------------------------------------------------------------
MB		ms91				18 Jun 93 
Some changes to ms91 have been installed.
The most noticeable changes are:
New flags RECONSIDER-FN and OPTIONS-VERBOSE
Improved output in general (enormous amounts of it, if you set
OPTIONS-VERBOSE to T), and improved help messages for the WEIGHT flags
in particular.
WEIGHT-C-FN can have value OPTION-SET-NUM-LEAVES, which will make
all of the primsubs at level N have the same weight.
(qload "auto.exp")
(qload "ms91-search")
(qload "ms91-weights")
(qload "ms91-basic")
(qload "ms91-enumerate")
----------------------------------------------------------------------
MB						19 Jun 93
minor changes to ms91-weights and ms91-basic
----------------------------------------------------------------------
HX	Fixed translation bug for thm112a	20 Jun 93
The very-deeply-hidden bug came from the function update-symmetry,
which didn't deal with option-sets smoothly or correctly.
etrees-wffops.lisp
----------------------------------------------------------------------
HX        						mid-June 1993
In the successful run on THM112C, the initial link appeared
several tmes in the mating. We'll have to figure out why. 
It occurs on only one path.
----------------------------------------------
MB		ARGUMENT COMPLETION			done 21 Jun 93
	<escape> should complete the name of the relevant argument.
-----------------------------------------------------------------------
MB		FIX ALIAS				done 21 Jun 93
The ALIAS command now works on flagnames.
---------------------------------------------------------------------
MB	Link distribution files				22 Jun 93

I've linked all the build and compile files in
/afs/cs/project/tps/dist to those in tps/common, so the distribution
version should now compile properly and include MS91.  I also linked
the Makefile, as it was identical to that in the common directory, but
I left the .ini and .patch files as they were.
---------------------------------------------------------------------
MB		SETS OF EXPANSION OPTIONS		done 22 Jun 93
Enhance the help available for setting weights for ms91-6 and ms91-7.
Attach more extensive help messages to these procedures. 
--------------------------------------------------------------------
MB	Fixed bug					23 Jun 93 
>Error: Attempt to call AUTO::CONNECTIONS-ARRAY which is defined as a macro.
(qload "vpforms")
---------------------------------------------------------------------
MB		PRIM-BDTYPES				 23 Jun 93 
PRIM-BDTYPES used to be set by automatic searches
MS89, MS91-6 and MS91-7 to the list of all primitive types in the
deep formula of the etree. This means that, for example, the type
"OB" can never be produced in a primitive substitution.
To solve this, I've introduced a new flag, PRIM-BDTYPES-AUTO,
which allows the user to insist that the types listed in
PRIM-BDTYPES be used either in place of, or as well as these
primitive types (or be ignored, as before).
;(qload "auto.exp")
;(qload "ms91-search")
;(qload "option-tree-search")
(qload "prim-edops")
---------------------------------------------------------------------
MB							25 Jun 93
tps3-save : commented out the definition of expert-list
auto.exp  : removed integer+-or-infinity, infinity
core.exp  : added these two and infinite-p
argtyp    : added type integer+-or-infinity
ms91-weights : removed ditto.
--------------------------------------------------------------------
MB & PBA	New Makefile and .depend		1993 Jun 25
New versions of Makefile and .depend so that when tps is
transported, in general only the .depend file need be modified.
Versions fomerly in /afs/cs/project/tps/common are now in
/afs/cs/project/tps/tps/old-source
---------------------------------------------------------------------

---------------------------------------------------------------------
MB & HX 	 fix connections-array bug		1993 July 1
CONNECTIONS-ARRAY, which is defined as a macro, was called before 
the compiler new it was a macro
(qload "vpforms")
-------------------------------------------------------------------
MB		IN-PACKAGE COMMANDS			early Jul 93
	One sees from page 261 of Steele's Common Lisp manual that it
was originally planned that in-package commands should appear only at
the beginnings of files, and while this is no longer required, it
seems very likely that the AKCL compiler expects this to be the case.
Maybe it's not much trouble to make the tps code conform to this.
...replace each offending file.lisp by two or more files called file1.lisp,
file2.lisp, etc. 
The mhelp "Functions to do with lisp packages." for lsppck would be
replaced in lsppck1 by
 "Functions in the CORE package to do with lisp packages." 
and in lsppck2 by
 "Functions in the TEACHER package to do with lisp packages.".
	Of course, defpck.lisp and the export files would have to be
adjusted (though we no longer need to export file names explicitly),
but I can't think of anything else that would be needed.
Files were: commands-interpreters.lisp lsppck.lisp
		mat-pro.lisp
...became...
commands-interpreters-core.lisp /...-auto.lisp
lsppck-core.lisp / lsppck-maint.lisp
mat-pro-auto.lisp / mat-pro-user.lisp
---------------------------------------------------------------- 
HX		EXPUNGE                        done July 15, 93
If one uses EXPUNGE in MATE and then ETD, one still sees something 
which appears to be the old expansion tree (when one runs allegro4.1)
Make EXPUNGE remove old and current etrees.
EXPUNGE-OLD just expunge old trees.
---------------------------------------------------------------------
DISPLAYFILE command in TPS. Use more      		July 19, 1993
Probably this should behave just like vpshow, but be a tps command.
-------------------------------------------------------------------
HX	Put bell for akcl into tops20, go back to old diy	19 Jul 93
----------------------------------------------------------------
HX	Fix vpshow so it works when tps is transported		19 Jul 93
----------------------------------------------------------------
HX	Fix windows so they work in AKCL			19 Jul 93
----------------------------------------------------------------
MB 	Fix new-user documentation				19 Jul 93
(1) reinstall the Makefile now in old-source with the expert-list added to it;
(2) add the expert-list to the Makefile on Andrew;
(3) adjust the comment in tps3-save.lisp to refer to the Makefile instead of
    the .depend file;
(4) reinstall all the old .depend files I changed;
(5) Adjust README and the directions for building tps in the User's Guide.
    Actually, these directions were never properly updated after Dan
    created the Makefile, so that's a separate job which should be done
    properly. Of course, the old directions still apply to people who
    don't use Unix, so maybe there should be three subsections:
    (a) adjusting to a new lisp
    (b) building tps with the Makefile if you are using Unix
    (c) building tps if you don't use unix
-------------------------------------------------------------------------
MB								7/20/93
Need to print out a label for each option set,
keep count of how many times each one is used,
and indicate this in the matevpw file.
------------------------------------------------------------
MB								7/20/93
MS91 search procedures: 
Check that second use of same option set is working properly.
--------------------------------------------------------------------
MB	New weighting function for MS91				7/20/93
There is a new possible value for WEIGHT-B-FN: SIMPLEST-WEIGHT-B-FN.
If you set the flags as follows:
WEIGHT-B-FN SIMPLEST-WEIGHT-B-FN / WEIGHT-A-COEFFICIENT 0
WEIGHT-B-COEFFICIENT 1 / WEIGHT-C-COEFFICIENT 0

then the option sets will get weights:
1 for the original problem.
2 for versions with one primitive substitution/duplication.
3 for versions with two primsubs / two duplications / one of each.
...etc... (i.e. add 1 for each extra primsub or duplication).
---------------------------------------------------------------------
MB	LISP-IMPLEMENTATION-VERSION		done 21 Jun 93
Amended LISP-IMPLEMENTATION-TYPE to show the version as well as the type
of Lisp.
----------------------------------------------------------------
MB						done 7/23/93
		CHECK-SEARCH (QUERY-USER)

	Allow more possible values for QUERY-USER (thus changing its
values from BOOLEAN to SYMBOL) so that tps behaves as follows:
	When the value of QUERY-USER is QUERY-JFORMS, each time tps
is about to start the mating-search process on a jform, it prints out
the substitution and vpform as usual, and then queries the user
"Search on this jform?" If the answer is yes, the search proceeds as
usual, but if no, it generates the next option set (or duplicates
quantifiers in ms88).
	We might wish a value QUERY-JFORMS2, which is like the above, 
but omits printing out the vpforms.
	When the value of QUERY-USER is SHOW-JFORMS, tps doesn't
query the user and proceeds as if the user always answered no to the
query above. (Thus it never searches for any matings.)
	This allows us to check much more quickly whether a given
mode will suffice to prove a given theorem (assuming we know the
correct option set), and lets us see the sequence of option sets
which that mode will produce.
	debug-ms.lisp becomes obsolete.
changed files: auto.exp etrees-flags ms90-3-top etr-nat-macros
	mating-dir mating-sub ms91-search option-tree-search otl-cleanup
------------------------------------------------------------
HX	Create a SILENT value for UNIFY-VERBOSE.               July 26, 93
Perhaps have UNIFY-VERBOSE set to SILENT automatically when MATING-VERBOSE is.
-------------------------------------------------------------------
MB		EQUIV-EQ			27 Jul 93 17:58:17
There is now a new rule which is exactly like EQUIV-WFFS but
checks for instantiations of =; it's called EQUIV-EQ.
ml.exp
core.exp
wffequ2.lisp
ml2-logic7a.rules (and hence ml2-logic7a.lisp)
prfw
-------------------------------------------------------
HX		Fixed DIY bug				28 Jul 93 
Merging expansion proof
Error from DIY_MEXPR_MAINFNS1.  0 is not an infix formula.
The bug comes from the function FREE-VARS, which couldn't handle
abbreviations correctly.

wffprim.lisp
-------------------------------------------------------------
MB			GO3				done 7/28/93
	Make a command GO3 which is like GO2 but doesn't
print into the command window. (One is presumably watching the proofwindow.)
(qload "auto.exp")
(qload "master-tactic")
---------------------------------------------------------------
HX	Fix /afs/andrew/mcs/math/etps/etps.Xclients  	29 Jul 93
	so that xwindows work on Andrew; test it.
/afs/andrew.cmu.edu/mcs/math/etps/decfonts
	In your andrew accounts, you should have the lines
source /afs/andrew/mcs/math/etps/etps.cshrc
source /afs/andrew/mcs/math/etps/tps/tps.cshrc
in your ~/.cshrc file, and
/afs/andrew/mcs/math/etps/etps.Xclients
in your .Xclients file.
	Hongwei, please make sure that the above files are adjusted
correctly so that windows with special characters will work on andrew.
As usual, save backup files (or keep old code as comments).
----------------------------------------------------------------
MB	Add flags to control sizes of windows.			29 Jul 93
----------------------------------------------------------------
HX		MINOR BUGS				01 Aug 93
All these bugs are related to Interactive Commands
in mate toplevel.
mating.lisp, etrees-wffops.lisp, mating-top.lisp.
----------------------------------------------------------------
HX		Bugs fixed				1993 Aug 4
Error: The variable INCLUDING-GC-TIME is unbound.
Error signalled by DESCRIBE-MODE.
        While using xtps-akcl-big at athens, I entered the editor
and descended to a subformula, but the contents of the edwindows
remained identical.
review.lisp (for describe-mode)
edtop.lisp (for editor windows)
-----------------------------------------------------------------------------
HX	Eliminate Annoying "NIL"'s and "T"'s		04 Aug 93
proof window toplevel:
prfw.lisp
tps toplevel:
top.lisp
-----------------------------------------------------------------------
HX	Fixed bug related to interactively proving THM130	08 Aug 93

The bug is very serious if you try calling DIY interactively. The
reason is, if you call DIY interactively, the line-node of each line
ia attached after merging process is done, but the line node of each
support line is attached during preprocessing.  Eventually the bug is
triggered in merging process when the expansion tree of current-eproof
gets cleaned up.

diy.lisp
-----------------------------------------------------------------------
HX		FIXING UNIFICATION BUG			16 Aug 93

	Unification bug related to skolemization.
Discuss with Sunil

The bug resulted from incorrectly handling Skolem
functions. Now it is fixed.
node.lisp unif-match.lisp ms90-3-unif-match.lisp
-----------------------------------------------------------------------
HX	Fixing bugs related to interactively calling DIY	16 Aug 93
(1) mating-merge-eq (fixing a bug in RULEQ)
(2) ml1-logic0 (fixing a bug in restriction checking functions for LEMMA)
(3) diy (fixing a bug in merging process)
-----------------------------------------------------------------------
HX		PROOFNAME			16 Aug 93 
I modified PROVE command so that it will supply users
with a default value for proof name if possible.
wfftyp.lisp   otlnl.lisp
----------------------------------------------------------
MB		HELP fixed			19 Aug 93
Previously,if you asked for help on a rule with SHORT-HELP NIL, you
got the irule definition *only* if you've previously asked for help
with SHORT-HELP T.  Otherwise it doesn't appear.

mhelp.lisp
----------------------------------------------------------
HX                                          done Aug. 23rd, 93
GO2 (and GO3) should apply EQUIV-EQ and EXT= and EXT=0 when appropriate
Try using GO2 to prove thm47c

master-tactic  ml-tactics-quant  wfftst weak-mac

-----------------------------------------------------------------------
MB		SHORT-HELP				Aug 23rd 1993
	Check whether students running ETPS can change the
flag SHORT-HELP (they can...MB), and if so, put some mention of it in
the description of HELP in section 2.1 of the ETPS manual.
	Modify the help message for the command HELP so
that it mentions this flag.
changed : mhelp.lisp 
------------------------------------------------------------
MB							Aug 23rd 1993
Should the variable *prfw-iftrue-update-commands* be the same
as whatever generates the output for the command
LIST-RULES? Then the former would not have to be updated when 
commands are added to tps.
(This job can be done by adding one extra property to the
category MEXPR. But it certainly will affect a bunch of files.
So I think we better do it just before we are trying to rebuild
the whole system. HX)
Done less elegantly than this suggestion, but with less effort...
changed prfw.lisp
--------------------------------------------------------------------
MB		OPTION SET SEARCH PROCEDURES		Aug 23rd 1993

Also put something in the User Manual. Some or all of EXPANSION.DOC 
can be incorporated into the User Manual.
Actually, not much of EXPANSION.DOC was incorporated, as this was rather
too detailed to be worth using.
--------------------------------------------------------------------
HX	                                  AUG 30, 1993       
                  
  Bug related to skolem constants in eproofs for option trees.
Describe the problem and the proposed solution, test the solution,
and check with Nesmith

After calling deepen-to-literals*, we know
the slot "SKOLEM-CONSTANTS" attached to
CURRENT-EPROOF gets updated. So calling
make-higher-order-expansions will update
CURRENT-EPROOF. But when we call the function
add-ho-exps-to-option-tree, we don't update
the slot "SKOLEM-CONSTANTS" in the EPROOF
attached to a OPTION-TREE. This means, calling
SK-CONST-P may give you a false result while
ms90-9 (or ms89) mating search is used.

This results in some trouble when I try to prove
x5310. My fix is to update the slot "SKOLEM-CONSTANTS"
of the EPROOF attached to a option-tree whenever the tree
is created (by using make-new-option-tree-node).

The changed file is 

option-tree.lisp
-----------------------------------------------------------------------
HX	See what is needed to prove X5310.    AUG 30, 1993

suggestion: part of code related to option-tree is not well organized.
I think that it results in some strange behaviors in option-tree. For
example, skolem-constants property attached to current-eproof is mishandled.
This is a main obstacle, in lights of my understanding, which prevents us 
from proving x5310 automatically.

To accomplish the above, I did

(1) fix a bug in option-tree.lisp
(2) create a new value PREFER-RIGID2 for order-components,
    which is optimized version of PREFER-RIGID1. I think
    that the value PREFER-RIGID1 should be replaced with
    PREFER-RIGID2 in most of our modes if applicable.
(3) fix a bug in the function add-exp-node-jform. The changed
    file is ms90-3-exp-jform.

Besides, I modified mating-dir.lisp to eliminate an irregular
behavior in backtracking. Comment is around the fix.
-----------------------------------------------------------------
HX		BUG in restoreproof         AUG 31, 1993

Subject: RESTOREPROOF & x5310-sub2-a.prf
Date: Tue, 31 Aug 93 12:09:15 -0400
Message-ID: <21765.746813355@ATPS.TPS.CS.CMU.EDU>
From: HongWei_Xi@ATPS.TPS.CS.CMU.EDU

It turns out to be that the proof contains an ill-formed
formula. RESTOREPROOF has no problems here. Actually, it
is smart enough to check out the error.

The bug came from MAKE-TERMS-OF-TYPE, which is used in UI-HERBRAND
tactic. The changed file is 

master-tactic.lisp.
-----------------------------------------------------------------------
MB		Help for UNSPONSOR			sept 6, 1993
The prompt and help message for UNSPONSOR should make it clear
that the LINELIST argument should be the list of numbers of lines
to be removed from the list of sponsors of the planned line.
changed files : otl-prt.lisp
-----------------------------------------------------------------------
MB		SUBJECTS in REVIEW			sept 6, 1993
	Put the flag default-ms into each of the subjects
 MS88 MS90-3 MS90-9 MS91-6 MS91-7 MS92-9 MS93-1, so that when saving
modes using mode1 we can have that recorded without using all the
general stuff in mating-search.
changed files : mating-top.lisp
-----------------------------------------------------------------------
MB		more SUBJECTS in REVIEW			sept 6, 1993
	Flags which don't affect the search, such as mating-verbose
and filenames, should be taken out of these subjects. Perhaps they
should be left in MATING-SEARCH, which may be used to update the flags
before starting a search.
Moved : MATING-VERBOSE, REC-MS-FILE, REC-MS-FILENAME
changed files : mating-sub.lisp, option-tree-mateops.lisp,
	ms90-3-node.lisp, ms90-9.lisp, ms91-basic.lisp, 
	ms92-9-top.lisp, ms93-1.lisp
--------------------------------------------------------------------
MB		moved LIST-RULES			sept 6, 1993
LIST-RULES moved from otl-go to otl-help so that it will become 
accessible in ETPS as well as TPS
changed files : otl-go.lisp, otl-help.lisp
--------------------------------------------------------------------
MB		ETPS windows on Andrew			sept 6, 1993
When running ETPS on an Andrew workstation, I found that all the
windows came up fine. However, when I exited from the editor,
this happened:
<Ed32>ok
4785: Not owner
4786: Not owner
and the editor windows did not disappear. Similarly for the proofwindows. 
This is a bug to do with the Andrew system; it has now been fixed for
Allegro lisp.  Method of fixing this was to repeatedly send the output
of ps to a file and then use grep to select out the appropriate PID.
Changed files : tops20.lisp
--------------------------------------------------------------------
MB		ETPS windows on Andrew			sept 7, 1993
Extended the above to cmucl on Andrew. Changed files : tops20.lisp
--------------------------------------------------------------------
HX     Fixing a bug in translation process              sept 8, 1993
The bug, which incorrectly handled duplications under a disjunction
node, has got fixed. The reason is that the parent slot didn't get 
updated promptly while duplicating the expansion tree form jform.

The changed files are

ms90-3-exp-jform.lisp ms90-3-expand-etree.lisp

The patch file has changed according to the fix.
--------------------------------------------------------------------
MB		Various documentation jobs		sept 9, 1993
Added LIST-RULES to the ETPS manual.
Moved many of the items in user/newdoc into the user manual.
--------------------------------------------------------------------
HX Dealing with truth values and Proving thm120b        sept 13, 1993
In order to accomplish the job, I did the followings

(i) Adding a flag TRUTHVALUES, which has a default value
falsehood. My idea is to bother the old code as less as
possible because truth values are not frequently used in
formulas.

(ii) Introducing a new rule TRUTHP, which deals with the
conversion between truth values. The rule is quite similar
to IDFN, so we don't need to worry about it.

The followings are added in the patch file

(qload "diy")
(qload "etrees-flags")
(qload "etrees-wffops")
(qload "mating-merge-eq")
(qload "ml-etr-tactics-main")

By the way, thm120b can be proved easily while you set
TRUTHVALUES to T
num-of-dups to 0, and
max-mates to 2
--------------------------------------------------------------------
MB	Fixed help message for LEDIT			sept 21, 1993
...so that it reflects what the command actually does...
--------------------------------------------------------------------
MB		User's manual				22 Sep 93
The file ...user/newdoc is now empty, and all the contents
have been put into the user's manual
--------------------------------------------------------------------
HX		UNABLE TO OPEN DISPLAY " "		22 Sep 93
/afs/andrew.cmu.edu/mcs/math/etps/etps.cshrc now contains a line which
tells where to find the fonts for etps for Andrew workstations.
Annoying message 'xset: unable to open display " "'has been
suppressed.  Also, the TPS fonts are added into the font path only
once regardless of the times that XTERM gets called.
--------------------------------------------------------------------
MB 		Programmer's manual			23 Sep 93
Incorporated the files  bugs.hlp, recordfiles.hlp, tpsdoc.hlp, fonts.hlp, 
tps3.doc, jforms.hlp, hwxi/lib/mate.doc and the newdoc file into
the programmer's manual. Cleaned out the docjobs file.
--------------------------------------------------------------------
MB		REPORT module				23 Sept 93
Removed this module from etps-build.lisp and etps-compile.lisp.
--------------------------------------------------------------------
MB		Fix TEXPROOF in ETPS			30 Sept 93
Fixed etps.ini so that it loads the new version of the
Scribe preamble. Also fixed texproof for ETPS, but this command
still doesn't work from ETPS because the entire tex-wff module
isn't part of ETPS. Changed etps-build.lisp and etps-compile.lisp 
(on andrew and cs) so that this module will be present as of the 
next time we rebuild etps.
--------------------------------------------------------------------
MB		More unification output			15 Oct 93
TPS now tells you when the unification depth has been exceeded, 
so you can tell whether that was why unification failed.
Changed files: unif-tree.lisp, unif-depth.lisp, ms90-3-unif-tree.lisp
--------------------------------------------------------------------
MB		MAX-MATES				15 Oct 93
Make MAX-MATES apply to npfd procedures too.
Changed files : mating-dir.lisp, ms90-3-node.lisp
--------------------------------------------------------------------
MB              MAX-MATES                               19 Oct 93
Make MAX-MATES apply to npfd procedures too.
Change type to INTEGER+-OR-INFINITY. Allow pfd procedures to
have MAX-MATES INFINITY (actually equivalent to MAX-MATES 1000000,
so if we ever have a vpform with >1000000 literals we'll have to
change this...)
Changed files : ms90-3-node.lisp, ms90-3-top.lisp, connections.lisp
----------------------------------------------------------------------
MB		GRADER					26 Oct 93
Modify the CHG-VARS command so that one can also see and modify the 
(new) flag GRADE-DIR containing the name of the directory where the
grade files are to be found. (Normally this is the directory from
which one starts up GRADER.)
Changed files: gr-macros.lisp, grades1.lisp, grades2.lisp, teacher.exp
----------------------------------------------------------------------
MB		MAX-MATES message			29 Oct 93
Message about MAX-MATES now only appears for MATING-VERBOSE MAX
----------------------------------------------------------------------
HX		SIMPLER-BUG             done Oct 30, 1993
See /afs/cs/user/andrews/bugs/simpler-bug.script
changed files are
jforms-labels.lisp  ms90-3-top.lisp  ms90-3-path-enum.lisp
---------------------------------------------------------------------
HX                                      done Oct 30, 1993
Look at /afs/cs/user/andrews/bugs/pell26-bug.
In his answer to my original query, Nesmith raises a question about the
mating, which appears to be incomplete. See what's going on here.
Firstly, please check the formula SIMPLER-BUG in andrews' library.

This job and the job above actually are merged into a single job.
------------------------------------------------------------
HX                                        Done Nov. 2nd, 1993
     Find out whether gc-time is included or excluded in the
time limited by MAX-SEARCH-LIMIT and SEARCH-TIME-LIMIT. Perhaps
the help message should make this clear.

Changed files are 
timing.lisp   option-tree-mateops.lisp  ms90-3-top.lisp
------------------------------------------------------------
HX	                                  Done Nov. 3rd, 1993

Type symbols are now shown for the terms which indicate how UI and
EGEN were applied when proofs are printed on the screen or by
SCRIBEPROOF or TEXPROOF. These terms are often the most significant
aspects of the proofs, so the types of variables should be displayed,
at least if the flag PRINTTYPES governed by SHOWTYPES is T.

Changed file is prtotl.lisp.
------------------------------------------------------------
HX		FLAGNAMES              done but not installed Aug 2nd, 93
                                       installed Nov, 4th, 93
	Find a good way to introduce duplicate names for flags, so that we
can have more informative names for certain flags. We don't want to just
change the names, because then the old modes won't work, and the library
records won't make sense. Of course, the help messages should tell one
about the alternative name.
	Introduce an appropriate name for MIN-QUICK-DEPTH.
The changed files are
flagging.lisp review.lisp lib-objects.lisp

The usage of "defsynonym" is around the code in flagging.lisp.
-----------------------------------------------------------------------
Subject: Fixing simple-bug and PELL26		 30 Oct 93
The job has been fulfiled. It turns out to be that
the fix is very straightforward.

The changed files are
jforms-labels.lisp
ms90-3-top.lisp
ms90-3-path-enum.lisp
-----------------------------------------------------------------------
MB		SYSTEM subject			done Nov 4th 1993
Added a subject SYSTEM for the flags that shouldn't be changed; 
rearranged the flags and subjects currently unclassified into new contexts
LIBRARY, RULES-OBJECT, OTL-OBJECT, GRADER-OBJECT. Changed files:
contexts-{core|maint|teacher}.lisp, {core|maint|teacher}.exp,
gr-macros.lisp, lib-macros.lisp, lib-ops.lisp, match-macros.lisp,
meta-label.lisp, otl-macros.lisp, read-rdef-mac.lisp, rule-wffop.lisp,
tops20.lisp, unif-tree.lisp
-----------------------------------------------------------------------
MB		MS91 weights			done Nov 4 1993
Changed defaults for weight-{a,c}-coefficient, weight-b-fn,
ms91-weight-limit-range and new-option-set-limit.
-----------------------------------------------------------------------
HX		EXCLUDING-GC-TIME help message	done Nov 4 1993
Fixed the EXCLUDING-GC-TIME help message to make it clear that this
flag is set by the system to provide the relevant information.
-------------------------------------------------------------------------
MB		MONITOR (was called COND-INFO)	done Nov 8 1993
Introduce a flag which will control how we can get more information
about what is going on at a certain point in the search. If this flag
is T, TPS calls a function which checks certain conditions (such as
whether the mating is a specified one) and (if these conditions are met)
does things like printing the entire utree. One should be able to
specify quite a variety of conditions to be checked and actions to
be taken, though we'll actually implement these only as they are needed.
Calls to the function which checks this flag and takes appropriate action
can just be sprinkled at appropriate places in the code.
New flag: MONITORFLAG
New mexprs: MONITOR, NOMONITOR, MONITORLIST
New monitorfns: MONITOR-CHECK, FOCUS-MATING, FOCUS-MATING*
Changed : auto.exp, commands-interpreters-auto.lisp, defpck.lisp, top.lisp,
mating-top.lisp, mating-dir.lisp, ms90-3-path-enum.
Added : monitor.lisp, monitor-macros.lisp
--------------------------------------------------------------------------
MB		Fixing contexts, subjects etc		9th Nov 93
After rebuilding, a few of the changes to contexts and subjects made on
November 4th turned out to be ineffective; fixed them again.
Changed files: tops20.lisp, lib-macros.lisp, otl-cmddef.lisp
--------------------------------------------------------------------------
MB		UNIFY SUCCESS				9th Nov 93
The unify top-level now says SUCCESS when it succeeds. Changed : unif-user.lisp
--------------------------------------------------------------------------
MB		REC-MS-FILE, REC-MS-FILENAME		9th Nov 93
These flags (and the entire EVENTS module) do not work with pfd procedures. 
Changed help messages for flags & EVENTS module to say this, and moved flags 
from subject MATING-SEARCH into subject EVENTS.
Changed : etrees-flags.lisp, events.lisp
--------------------------------------------------------------------------
MB		CLARIFY MATE-FFPAIR			9th Nov 93
With MATE-FFPAIR NIL and using MS88, TPS quickly proves
EXISTS p(O) EXISTS q(O).p OR q by mating the two flexible literals.
Find out more precisely how it is determined whether such literals
will be mated, and put a description of this into the help message
Changed: data-structures.lisp, ms91-basic.lisp
--------------------------------------------------------------------------
MB		MONITOR FUNCTIONS			11th Nov 93
New functions FOCUS-OSET, FOCUS-OSET*, FOCUS-OTREE, FOCUS-OTREE*.
Changed : monitor.lisp, ms91-search.lisp, option-tree-aux.lisp
--------------------------------------------------------------------------
HX              Adding keywords in *features*           12th Nov 93
I modified the file Makefile to add :TPS in variable *features*
each time while TPS building process starts; :ETPS will be added
into variable *features* every time while ETPS building process
starts. 

The keywords are going to be used to make distinction between the
code for TPS and the code for ETPS when it is necessary to do it.
--------------------------------------------------------------------------
MB		Documented #+:TPS, #+:ETPS		14th Nov 93
--------------------------------------------------------------------------
MB		MONITOR DOCUMENTATION			14th Nov 93
Put an example into the User's Manual. Put references
to information on defining more functions into the Programmer's Manual.
Fixed the errors discovered in proofreading the manual since the last 
time it was run through Scribe.
======================================================================
HX		RIGID-PATH CHECK		 Done 1993, Nov. 15
	Check the effect of using the rigid-path check which is now
implemented for UN90. Run some theorem like THM15B with an
inadequate unification depth like 10, and see how fast various matings
are rejected with and without the check. Alternatively, just try some
higher-order theorems tps can prove 
(see /afs/cs/project/tps/tps/tpslib/andrews/success-summary)
with and without the check, and see how long the matingsearch process
takes. Keep systematic records of what you find.

	The rigid-path check has been implemented for UN90
unification (which is called by MS90-3), but not for UN88
unification (called by MS88). It should be implemented for UN88 too.
	Consider implementing the rigid-path check in a
more sophisticated way where we keep track of dpairs already checked
in each node in the unification tree 
	Note that Huet's paper actually discusses (on page 55) two
conditions related to the rigid-path check. It would be good to have
them both implemented for both unification procedures. It may be
necessary to put wffs into eta-reduced form within the rigid-path check, so
that the condition that the variable has no arguments can sometimes be
satisfied. (At present, the wffs will be in partially eta-expanded
form.) One can leave them in eta-reduced form; MATCH will pad them up
into expanded form when it needs to.
	 Does this cost more than it is worth? Do we need another
flag so we can experiment with this?
	Test the code and check the benefit. Then consider changing
the default value of this flag.
	Make sure what OCCURS-CHECK flag does. Is it only relevant to
fol?  Modify mhelp for OCCURS-CHECK if appropriate, or change this
flag completely. Do we really need both OCCURS-CHECK and RIGID-PATH-CK?

--------------------------------------------------------------------------

1) The flag OCCURS-CHECK in ms88 is doing what we think RIGID-PATH-CK does 
in ms90-3.

I changed all occurences of OCCURS-CHECK in higher order case into RIGID-PATH-CK, 
which is a more apposite name for the flag as far as Huet's paper is concerned. 
Besides, I added a line in the code so that we can see a message printed out 
whenever rigid path check succeeds.

2) RIGID-PATH-CK in both kinds of unification realizations is doing
the same thing.  There are two cases in Huet's paper in which rigid
path check can be applied.  The second case is only partially realized
in the code. The reason is that eta-reduction is not involved during
the SIMPLIFICATION. Instead of checking the last element in a rigid
path sequence doesn't have arguments, we simply check whether it is of
base type.

My opinion is that this is enough. Otherwise the code would be more
complex, and probably more time would be spent than be saved.

The default value of RIGID-PATH-CK is T now.
======================================================================

HX                               Done Nov. 15th, 93
I noticed that users cannot use PROVE command in
ETPS because of new timing stuff. 
Have it check to see whether the timing function is there.

This problem can be done in an elegant way, which can deal
with a bunch of similar problems.
We add ETPS and TPS to the variable *features*, which is used while
the system is loading code. So if the code is only written for TPS,
we can add #+TPS in front of it, then it is invisible to ETPS, and
vice versa.

The changed file is otlnl.lisp.
---------------------------------------------------------------------------
HX		ETA-REDUCING SUBSTITUTIONS          Done Nov. 16th, 93
Make sure that substitutions are eta-reduced before they are
applied in MS90-3 when ETA-RULE is T.
Example: Hongwei's thm116-1f
a new function SUBST-ETA-REDUCTION is added.
The changed file is ms90-3-expand-etree.lisp.
--------------------------------------------------------------------------
HX                       Bug                       Done Nov. 16th, 93
[FORALL x [M x EQUIV N x] EQUIV FORALL x M x] IMPLIES FORALL x N x
see /afs/cs/project/tps/admin/bugs

The above bug has been fixed. Actually it is a sophisticated version
of "simple-bug". Besides, a quantifier-bug and a disj-bug are fixed.

Changed file is ms90-3-path-enum.lisp.
--------------------------------------------------------------------------
HX                                                  Nov. 17th, 93
        	THM48                       Already done (21 AUG, 93)
	Look at THM48 search.  Do with max verbosity after we get good
settings and see how the search could be improved.  Number of paths is
not really very large.
	Try interactive mating first.  Use mode-thm48-test-a in
testmodes.lib. Also try in ms90-3 with max-mates 1 and num-of-dps 0.
	Compare with thm48-may1.script, a record of a run which hung
after 7 hours 47 min.

Now we have a mode mode-thm48-a-new, which speeds up the search 
dramatically. Number of paths in the problem is comparatively large
because combination of connections is quite flexible here, and no
heuristics, so far, can suppress the flexibility. (HX 21 AUG, 93)
--------------------------------------------------------------------------
       
HX                                                  Nov. 25th, 93
Attempt to build tps3cmu for pmaxes failed
end of /afs/cs/project/tps/pmax_cmucl/maketps.log:

;; Loading #p"/afs/cs.cmu.edu/project/tps/pmax_cmucl/bin/ml2-abbrev.fasl".
Invoking debugger...
Invoking debugger...

A Toolkit error has occurred. Unable to connect to Motif server.

-- FIX :

The compiling problem is caused by the following fact.
a one-dimension char array is no longer coerced into
a string automatically. I define a function safe-string-upcase
which will coerce its argument into a string before calling
string-upcase. This function is only used in lexcan-sp so that
we could figure out troubles quickly if there would be some.

While doing the job above, I also noticed some other potential
problems as LISP gets advanced.

(1) int-char has been eliminated for a long time. I replace
every occurence of int-char by code-char, which is a standard
function in common lisp and can do the same thing as int-char
did.

(2) Type string-char has been eliminated for a long time. I think
base-character is going to be enough for our purpose. If it is not,
it is not very hard to figure out what we should add in. Therefore,
type tps-string-char is now defined as type base-character.

These are all changes I made to fix the problem above and some other
possible potential problems. I should emphasize that it is always very 
easy to switch back if necessary.

The changed files are
wffin.lisp (for safe-string-upcase) 
boot0.lisp (for base-character)
boot0.lisp  (for code-char)
srcdoc.lisp (for code-char) 
vpforms.lisp (for code-char) 
tops20.lisp (for code-char) 
wffprim.lisp (for code-char)
windowfix-tops20.lisp (for code-char)
===============================================================
HX						Nov 23, 1993
Review commands in META-TOP used only to work provided you did't 
supply the parameters until you were asked for them
(i.e. LIST <cr> UNIFICATION <cr> worked, but LIST UNIFICATION <cr>
didn't). This is fixed.
=============================================================
MB	Installed META-TOP properly		Dec 2, 1993
Finally installed the META top level completely. We now have a 
top level that will automatically vary the flag settings for a 
search.
Changed files: defpck.lisp, core.exp, auto.exp, contexts-auto.lisp,
ms91-search.lisp, option-tree-search.lisp, ms90-3-top.lisp
New files: meta-top-top.lisp, meta-top-slists.lisp, 
meta-top-search.lisp, meta-top-lib.lisp
=============================================================
MB	Small META-TOP changes			Dec 10, 1993
Added meta-top to the facilities guide. Improved the output 
to the meta-top window. 
=============================================================
HX	Fixed meta-fail				Dec 1993
meta-top used to stop working if the proof failed in ms90-3.
Rewrote the backtracking in ms90-3-top.lisp to fix this
=============================================================
MB 	Renamed META-TOP to TEST-TOP		Jan 11, 1994
Renamed everything to do with meta-top to become test-top,
thus leaving the name "meta" for possible future use with 
real metatheorems. Also moved the chapter relating to 
test-top commands to a better place in the facilities guides, 
and edited the user guide to reflect the change of name.
Changed files: contexts-auto.lisp, defpck.lisp, 
meta-top-{top,slists,search,lib}.lisp (now renamed to test-top-*),
ms90-3-top.lisp, ms91-search.lisp, option-tree-search.lisp,
facilities.lisp, facilities-short.lisp
=============================================================
MB	RESTOREPROOF				Jan 17, 1994
The user now has the option of renaming a proof being restored
if the name conflicts with an existing proof (needs EXPERTFLAG 
to be T, to prevent ETPS users from doing this).
Changed files: saveproof.lisp
=============================================================
MB 		UNIFY-VERBOSE			Jan 17, 1994
Broaden UNIFY-VERBOSE to {SILENT, MIN, MED, MAX}, like
MATING-VERBOSE, and have "MAX-SEARCH-DEPTH exceeded..."
messages output only when UNIFY-VERBOSE is MAX.
Changed files: node.lisp, ms90-3-unif-tree.lisp,
unif-tree.lisp, unif-depth.lisp, flagging.lisp
=============================================================
MB		QLOAD/TLOAD			Jan 17, 1994
QLOAD and TLOAD now work properly with the new CMU lisp.
Changed file: boot1.lisp
=============================================================
HX Fix OCCURS-CHECK help message. Fixed         Jan 17, 1994
Changed file: data-structures.lisp
===============================================================
HX	RULEC                                   Jan 26th, 1994
	When RULEC inserts the line justified by "choose",
it would be nice to have it mention the existentially quantified
line in the justification too.

Changed files: ml1-logic2.lisp  ml2-logic2b.lisp
=====================================================
HX	SCRIBEPROOF SPACING                     Jan 26th, 1994
It appears that in SCRIBEPROOF files, every occurrence of @assert@;
is followed by at least two spaces. Sometimes we need all the space on
a line we can get, so if it is straighforward to do so, please
change the mandatory number of spaces after @assert@; to one.

Changed function is print-line-scribe in otl-scribeout.lisp
===========================================================
MB	RULES PACKAGE				Jan 28th, 1994
Confusion in the user manual has meant that some of the 
rules files for ml2 have been incorrectly assembled. 
Corrected the manual and reassembled all the ml2*rules 
files into new ml2*lisp files.
===========================================================
MB	RULE-BUILD				Feb 1st, 1994
ACL was assembling backquoted forms in the rules package
into lisp files that couldn't be read correctly by cmu lisp.
In particular, the "short" definition of each rule was 
causing bugs. Rewrote the relevant function (build-rule-short)
in rule-build-tac.lisp, and reassembled the ml2 rules files
yet again.
===========================================================
HX   	BUG FIX                                 Feb 1st, 1994
Fixed the following: 
Tried proving BLEDSOE-FENG-SV-I2 again using mode-BLEDSOE-FENG-SV-I2-b
with PRIM-BDTYPES changed to contain I as well as (OI), and still got
the translation bug. See bugs file.

Changed file : etrees-wffops.lisp
Changed function: create-skolem-node
=================================================================
MB	WINDOW FIX				Feb 1st, 1994
User was complaining about being prompted by rm every time the 
proofwindows started (andrew core image, from cs cell). Since 
there's no real reason to use rm when we have a perfectly good 
function delete-file, I replaced all relevant references to rm.
Changed: tops20.lisp, etps.patch
=================================================================
MB	SEARCH-ORDER				Feb 2nd, 1994
Implemented SEARCH-ORDER, in the hope of eventually understanding
MS91-6 and MS91-7.
Changed files: ms91-search.lisp, auto.exp
=================================================================
MB	TLOAD/QLOAD				Feb 4th, 1994
Fixed bug in tload/qload for cmucl.
Changed files: boot1.lisp
=================================================================
HX      BUG FIX                                 Feb 7th, 1994

		TACTICS FOR ~TRUTH.
When USE-RULEP is NIL, the tactics have trouble
dealing with ~TRUTH.

	Tried to prove THM134 using MODE-THM134.
Mating achieved success very quickly, but translation got 
into an apparently infinite cycle:
Applied INESS-PLINE.
Applied NEG-EQUAL-SLINE.
Here is the relevant part of the proof:
(15)  1,5    !  ~.g(II) x(I) = g x                                      MP: 14 6
(16)  1,5    !  ~TRUTH                                                 Refl=: 15
(17)  1,5,17 !  ~FALSEHOOD                                       Assume negation

	How are truth values handled by tactics? Shouldn't ~TRUTH just
get converted to falsehood here? TPS was able to handle this November
2, 1991. What change upset things?
	I tried it again with the flag TRUTHVALUES set to T instead of NIL,
and ran into essentially the same problem.

Changed files are:
wffops-otl.lisp ml-etr-tactics-sline.lisp
ml1-logic3a.rules wffneg1.lisp
=============================================================
HX         BUG FIX                   FEB. 7, 1994
		TH108 bug
mode  MODE-THM108-A
<104>prove thm108

Translating expansion proof
Monday, January  3, 1994 at 16:13:32.

Process Name         | Realtime | Internal-runtime |  GC-time   | I-GC-time
-----------------------------------------------------------------------------
                                (Interrupted)
DIY                  |        9 |             6.50 |       0.00 |       6.50
-----------------------------------------------------------------------------

Error from DIY_MEXPR_MAINFNS1.  Inconsistent arguments.
Illegal Match.  !A(O) matched FORALL x(A).[z(OA) x AND ~y(OA) x] = FALSEHOOD somewhere and now FORALL x(A).[LAMBDA x.w(OA) x AND [LAMBDA x.~z(OA) x] x] x IMPLIES y(OA) x,
but they are not the same!

Changed file is  ml-etr-tactics-sline.lisp
=============================================================
Hx                                      Feb. 8th, 1994

It is not uncommon that we want to change something related to
a flag after resetting its value. For example, after setting
unify-verbose to T, you want to set it to MAX; After setting
a synonym of a flag, you want to set the flag and all its other synonyms;
after setting truthvalues-hack to T, you want to change the definition
of NULLSET to "\lambda x(A). ~ Truth". Therefore, it sounds reasonable
to add another slot in the definition of flag, which could contains
function doing what I mentioned above.

Luckily, the slot I mentioned above has already been there. I did
what I proposed.

Changed files: 
flagging.lisp review.lisp etrees-wffops.lisp 
etrees-flags.lisp node.lisp
=====================================================================

Hx                                      Feb. 9th, 1994

X2115 bug fixed. The problem is in function admissible-p,
which didn't handle a special case correct. The problem
can be described by using example expvar-bug in my library.

Changed file is ml-etr-tactics-sline.lisp

=====================================================================
HX                         Feb. 10th, 1994

Now you can use the editor in tps to deal
with untyped lambda-calculus. First, you
have to turn on flag UNTYPED-LAMBDA-CALCULUS.

Basically, I used the following method to do
the job. First, encode an untyped lambda term
into a typed one, so it can pass type checking.
Whenever you want to print out the term, it
will be decoded into an untyped form before
being used by a printing function. I should
emphasize that it is quite safe to do so.

Moving commands are not working well by now.
Besides, calling lnorm may cause endless
evaluation because this is untyped lambda
calculus.
The more it gets used, the more we know what
should be added in or improved.
Changed files are
core.exp tpinf.lisp wfflbdm.lisp prt.lisp
=======================================================
MB		UNUSED RULES FILES		14th Feb 1994
Put comments into ml2-logic6.rules and ml2-logic8.rules
(defining edef-partic, idef-partic, erp and irp) to 
show that they aren't currently part of the system.
=======================================================
DN & HX		 Allegro-v4.2			 17 Feb 94
I have followed Dan's suggestion and done the changes in tops20.lisp 
so that TPS can be built up in Allegro-v4.2.
changes required to make it run:
1. in tops20.lisp, wherever :allegro-v4.1 shows up, add :allegro-v4.2
2. in node.lisp, add the line '(getfn testfn)' to the
   (deftype% verbose ...) form.
=======================================================
MB		More MS91 FIXES			1st Mar 1994
Added output from MS91 about "ordinary" duplications (i.e.
those not used by primsubs). Added "verbose" option for SEARCH-ORDER.
Added flags PENALTY-FOR-ORDINARY-DUP, 
OPTIONS-GENERATE-{FN, ARG, UPDATE}. Added new value ALL-PENALTIES-FN
for WEIGHT-B-FN, four possible new values for OPTIONS-GENERATE-FN
and four new modes MS91-{SIMPLEST, ORIGINAL, DEEP, NODUPS}.
MS91-WEIGHT-LIMIT-RANGE now takes value INFINITY. 
NEW-OPTION-SET-LIMIT N will generate N rather than N+1 sets.
New options will be generated properly (fixing an old bug) and
all option sets are sure to be generated (fixing another old bug).
Changed files: ms91-*-lisp, auto.exp
=======================================================
MB		Timing				8th Mar 1994
The timing output no longer crashes because of "Dividing by NIL" 
if the first call in a particular session is from the mate top level.
Changed : timing.lisp
=======================================================
MB		Timing again			10th Mar 1994
Fixed the above bug properly and removed the kludge added
on 3/8/94.
Changed: mating-sub, option-tree-mateops, ms90-3-node, ms90-9,
ms92-9-top, ms93-1, timing, ms91-search
=======================================================
HX       Bug in merging process                 25 Mar 1994
It is a typo. An occurence of variable "var" in function
subst-vars-for-param should have been "sk".

changed file: mating-merge.lisp
Now you can print out the weird proof of
thm140.
Remark: This is a bogus fix as far as I am concerned now
because I don't know why I did this. I have switch back to
Dan's code. If there is a problem arising, it should not
difficult to chase it down. (May 9, 1994)
=======================================================
HX       Replacing wffeq's with wffeq-ab's      27 Mar 1994

The following functions are modified.

same-match2
neg-atom-elim-match2 
neg-atom-elim-tac-etree-nat-fn
indirect2-match2 

Now thm135a-1 can be proven automatically in less than
10 minutes(internal time) on DTPS, and no translation
bugs are triggered.
=======================================================
HX	RIGID-PATH-CK                           31 Mar 1994
There should be some indication in the help message that this is
now implemented for both unification procedures. It should be
included in all the subjects for search procedures which use it.

Help message's adjusted. Often old ms88 modes do not work now
unless you put RIGID-PATH-CK and assign T to it. This is because
flag OCCURS-CHECK for higher order logic, which usually is set to T, 
has been renamed RIGID-PATH-CK.
=======================================================
HX	PRETTIFY PROOFS                         31 Mar 1994

relabel variables in the final proof. (Look at TPS proof of
THM15B. Too many w's.) Change the prettify function

Done. To allow more flexibility, new variables are chosen randomly
from sets of "conventional names" for predicates, functions, and
individuals.

Changed files are
mating-merge-eq.lisp mating-merge.lisp
=======================================================
MB	MODES					5th Apr 1994
When a mode or mode1 is saved in the library, the flags are put
in alphabetical order, and duplicates are eliminated.
(Some flags are in several subjects.) The "other remarks" field
shows which subjects were saved for this mode.
Changed files: library.lisp, lib-objects.lisp
=======================================================
MB		NUM-OF-DUPS			7th Apr 94
The list of subjects for NUM-OF-DUPS now lists all the right
matingsearches.
Changed: ms90-9.lisp, ms90-3-node.lisp, ms91-basic.lisp
===============================================================
MB		SAVE-FLAGS-AND-WORK		7th Apr 94
This now saves flags separately, which makes reloading a lot 
quicker.
Changed: save-work.lisp
===============================================================
MB		COLLECT-HELP, HELP-LIST		7th Apr 94
Now working again.
Changed: collect-help.lisp
===============================================================
MB		OUTPUT JOBS			8th Apr 94
New help messages for SAVE, ORDER-COMPONENTS. Help messages for
mateop O, flags PRINTMATEFLAG, PRINTMATEFLAG-SLIDES, 
PRINTMATEFILE and PRINTMATEOPS now all say that this feature isn't 
implemented. Scribe output from edop O, QUICK-REF and SCRIBE-DOC
is now usable. Help messages for the mate/unify/ed command 0 (zero)
now work. All flags in the nonexistent subject "io" moved to "printing".
Changed: order-components.lisp, wffsav.lisp, edtop.lisp, mhelp.lisp
mating-top.lisp, mating-move.lisp, edmove.lisp, scrdoc.lisp
===============================================================
MB		FIX the VPD COMMAND			12th Apr 1994
The VPD command, and the associated flag VPD-STYLE, now work again.
The old setting of SCRIBE-SAIL has been replaced by SCRIBE, and the
settings SLIDES and CONCEPT-S now work again. The help messages have
been updated.
Changed files: vpforms-macros, vpforms
===============================================================
MB		General Maintenance			12th Apr 1994
The nonexistent subjects output and tps2-rulep have been removed from 
the STYLE flag and the RULEP-MAINFN flag respectively. The subject MS89 
has been moved from "Printing" (!) to "MS89".
Changed: gensty.lisp, ml2-prior.lisp, option-tree-mateops.lisp
===============================================================
MB		SCRIPT / VPW OUTPUT			12th Apr 1994
SCRIPT now puts a SCRIBE or TEX header onto the script file, if the
current value of STYLE is appropriate. it also puts a TEX footer on
the file (so don't change STYLE while you're making a SCRIPT file!)
These headers and footers are echoed to the screen, to remind you
they're there. The same also goes for the matevp file.
The output of VP when STYLE is TEX is now the same as the output of
VPT (but it goes to the screen and not to a file).
The upshot of this is that a script file of the mating search in TEX
style is now almost usable for slides.
Changed: save-work, vpforms, vpforms-tex
===============================================================
HX             LEAST-UTREE-DEPTH              15th April 1994
Now command LEAST-UTREE-DEPTH gives you the least needed unification tree 
depth for the last proven higher-order theorem. Also suggest to lower flags
MAX-SEARCH-DEPTH and MAX-UTREE-DEPTH to the least needed value if they are 
greater than it. This is available for all procedures.

changed file ms90-3-unif-tree.lisp unif-tree.lisp
added function least-utree-depth
===============================================================
HX            min-quantifier-scope and equiv  16th April 1994

suppose we have a formula "forall x[P x equiv Q x]".
Currently, we rewrite the formula into one of the
following two formulae.

(1) "forall x[[P x and Q x] or [not P x and not Q x]]"

(2) "forall x[[P x implies Q x] and [Q x implies P x]]"

Clearly, if (1) is used, flag min-quantifier-scope cannot
affect it any more; if (2) is used, it will rewrite to

(3) "[forall x. P x implies Q x] and forall x . Q x implies P x"
when min-quantifier-scope is true.

It is exceedingly costly for ms90-3 to duplicate a large formula.
What we did above is sort of avoiding duplicating large formulae,
i.e., (2) is always prefered when min-quantifier-scope is set to T.

Changed files are

cnf.lisp etrees-wffops.lisp
=====================================================================
MB			PUSH/POP			21st April 1994
We now have a TPS command named PUSH which can be used
in place of a call to SECONDARY-TOP-MAIN, and we leave this level of
interaction with the command POP. This can be called as a mexpr or 
from within another command (i.e. at the same places that ABORT can
be used).
Changed: core.exp, tpstop.lisp, top.lisp
===============================================================
HX      Implement MAX-DUP-PATHS for 
        path-focused procedures.    (23rd April 1994)
        ^^^^^^^^^^^^
Done. The help message for flag MAX-DUP-PATHS is clear enough
to tell you the purpose of the flag.

Changed files are:

ms90-3-node.lisp
order-components.lisp
ms90-3-top.lisp

THM300A can be quickly proved by using mode MODE-THM300A-DTPS
on dtps(running Allegro4.2).
===============================================================
HX      Implement MAX-DUP-PATHS for MS88  (25th April 1994)

Done. The changed file is

etrees-wffops.lisp
===============================================================
MB	MANUALLY-GENERATED-RULES		28th Apr 94
Added Manually-generated-rules.lisp to defpck.lisp.
Should remove it once the automatic generating procedures are fixed.
===============================================================
MB	PRIM-QUANTIFIER				1st May 94
Primsubs with quantifiers were generated and then discarded
when PRIM-QUANTIFIER was NIL. Now they aren't even generated.
Changed: prim.lisp, data-structures.lisp
===============================================================
MB	DEFAULT FLAG VALUES			3rd May 94
Default values for flags are now printed with the help message.
Changed: review.lisp
===============================================================
HX	                                        11th May 94
       Beautify final proof by relabeling variables tps has
introduced. Try to preserve the variables in the original
statement of the theorem.
	This is all related to the bug for THM140.
	Perhaps do this by changing the expansion proof uniformly
before translating to an ND proof. Pewrhaps there should be a flag
controlling whether this is done. Normally it should be done,
but we might want to set the flag to NIL if we want to compare
the final proof with the search process.

DONE.

(1) While calling function subst-vars-for-params, some
skolem-terms get replaced by the corresponding skolem
parameters. This results in the misbehavior of function
FREE-IN.

(2) The glitch is that the function deals wrongly with
a (sort of pathlogical), skolem node "EXISTS x. A",
where x does not occur free in formula A.

The patch file is adjusted, and the changed files are:

etrees-skolem.lisp etr-nat-macros.lisp.

=================================================================
HX  Fix x2126-bug and re-fix dup-bug  (May 12, 1994)

x2126-bug is caused by a previous wrong fix
of dup-bug.

We were unable to prove the following-like formulas

[forall x. P x] or A implies B,

when [forall x. P x] has to be duplicated. The problem
was in function ADD-EXP-NODE-JFORM.

The patch file has been ajusted, and the changed files
are:

ms90-3-exp-jform.lisp  ms90-3-expand-etree.lisp
=================================================================
HX    restore the correspondence       (May 14, 1994)
      between Skolem constants 

After a correct mating is found, ms90-3 tries to
attach substitutions to corresponding parts in an
expansion tree. Sometimes, it has to duplicate an
expansion node and deepen it to literals. Here we
have a serious problem.

Suppose that a skolem constant X occurs in the
substitutions and X comes from a skolem node
below an expansion node. If the expansion node
gets deepened again, the corresponding introduced
skolem constants must be some X', different from
X. After attaching the substitutions to the etree
and tranforming the etree to its jform, ms90-3
checks if the jform is a tautology. Certainly,
it is not now since X does not equal X'.

From time to time, we often see that a mating is
found and the proposition checker claims there is
an open path in the final jform. This may be caused
by the bug above.

The problem occurs only in the higher-order case,
where a formula may have several correspondent etrees
(it depends on where rewrite nodes are put). This causes
a problem in function UPDATE-SYMMETRY. The fix is to
build correspondences modulo rewrite nodes. It is quite
technical, so please see the comment around the code.

This fix and the following one allow us to prove thm303 automatedly.

The changed file: etrees-wffops.lisp 

========================================================

HX   A bug with MIN-QUANTIFIER-SCOPE    (May 13, 1994)

I cannot figure out why we have to deepen an etree before
attaching substitutions to the variables in it. Besides,
this causes a problem when MIN-QUANTIFIER-SCOPE is set
true. See the following explanation.

Flag MIN-QUANTIFIER-SCOPE usually is not compatible
with ms90-9. Suppose that there is an expansion node
forall x P x, where P is a predicate variable. After
deepening, the node looks like

EXP  x
LEAF P x

Again suppose [lambda x. A x and B x] is a primsub for P.
Substitute the primsub for P, we get

EXP  x
LEAF [lambda x. A x and B x] x

After deepening, we get

EXP   x
REW   CONJ
CONJ  LEAF1 LEAF2
LEAF1 A x
LEAF2 B x

But the jform of [forall x [lambda x. A x and B x] x]
would be something like

                   [forall x        ]
                   [       A x      ]
                   [forall x        ]
                   [       B x      ]
since MIN-QUANTIFIER-SCOPE is set. Hence the correspondence
between the etree and the jform is detroyed.

I comment the code accordingly to avoid the deepening mentioned
above. It works fine.

The changed file: ms90-3-expand-etree.lisp
----------------------------------------------------------
HX      prettifying information       May 20, 1994
After merging is done, tps issues a message telling
users the renamed skolem terms and the new terms
substituting for them.

Changed file: mating-merge.lisp
----------------------------------------------------------
MB	vpforms in Scribe		May 20, 1994
Vpform width in Scribe was limited to 79 chars. Now it isn't.
Changed: vpforms.lisp
----------------------------------------------------------
MB	^PN				May 20, 1994
Implemented the ^pn command, and a new proofwindow for it.
Changed: core.exp, prfw.lisp, otl-prt.lisp
----------------------------------------------------------
MB	ETREE-NAT-VERBOSE		May 20, 1994
The flag ETREE-NAT-VERBOSE has now been implemented, and allows 
the output of etree-nat to be controlled and/or directed to the
proofwindows. As a side effect, the annoying way in which etree-nat
would print everything in triplicate has now also been eliminated.
The change is in the tactics PFENNING*-TAC and
COMPLETE-TRANSFORM*-TAC, where calls to PRFW-PALL and the like have
been replaced by a call to PRINT-ROUTINES, which calls all of the
functions listed in ETREE-NAT-VERBOSE.
The obvious next step was to change GO2-TAC, GO3-TAC and MONSTRO-TAC
in the same way; having done this, GO3-TAC became redundant (because
it only differed from GO2-TAC in the places it sent output).

Changed files: auto.exp, core.exp, etr-nat-macros.lisp, otl-prt.lisp,
tactics-macros.lisp, master-tactic.lisp, ml-etr-tactics.lisp.
-----------------------------------------------------------
MB	SCRIPT message			May 20, 1994
SCRIPT now specifies that SCRIBE or TEX are appropriate styles,
and also now only puts headers on new files, not on re-opened ones.
Changed:save-work.lisp
-----------------------------------------------------------
MB	MOVE from ETREE-NAT		May 23, 1994
	When ETREE-NAT uses the MOVE command, the proof is now refreshed 
in the proofwindows (if any lines are actually moved).
Changed: tactics-aux.lisp
=================================================================
MB	Replacing ECONJ, ICONJ in GO2	May 23, 1994
GO2-TAC and MONSTRO-TAC now use ECONJ*-TAC and ICONJ*-TAC
instead of ECONJ-TAC and ICONJ-TAC.
Changed: master-tactic.lisp
=================================================================
MB	Spacing out the results of ICONJ* 	May 23, 1994
ECONJ*-TAC and ICONJ*-TAC now space out the conjuncts, rather 
than putting them on consecutive lines. This ought to mean that
etree-nat will need to move lines less often.
Changed: ml-tactics-prop.lisp, ml-etr-tactics-pline.lisp,
ml-etr-tactics-sline.lisp
=================================================================
MB 	Above continued				May 24, 1994
Realised that the above change to ECONJ*-TAC is stupid (why would
we want to space out support lines?) and changed it back. The change
to ICONJ*-TAC was correct.
Changed: ml-tactics-prop.lisp, ml-etr-tactics-sline.lisp
=================================================================
MB	Library: SORT and KEY			May 24, 1994
Implemented the library functions SORT and KEY; also fixed the bug
with DELETE so that empty files get deleted.
Changed: library.lisp, lib-ops.lisp, core.exp
=================================================================
MB	ETA conversion				May 25, 1994
Changed the LAMBDA*, LCONTR* and LEXPD* commands so that we can
do eta-conversion interactively; also changed the corresponding
etree-nat functions so that we can do it when converting a mating.
WFFEQ-AB-LAMBDA now does eta-conversion too; there is a new wffop
WFFEQ-AB-LAMBDA-NOETA which doesn't.
Changed: core.exp, wfflmbd2.lisp, wffop-otl.lisp, ml-tactics-quant.lisp,
mating-merge.lisp, ml-etr-tactics-sline.lisp, ml-etr-tactics-pline.lisp.
See THM135 and its companions
=================================================================
Hx        Subject: Handling truth values in ms90-3  May 25, 1994

This job is done finally. The patch file has been adjusted.

Changed files:
ms90-3-expand-etree.lisp
ms90-3-path-enum.lisp
ms90-3-path-bkup.lisp
ms90-3-top.lisp
===============================================================
MB		PUSH-MATING				Jun 1, 1994
	We need a monitor function which will halt TPS after
reaching a prescribed mating and then starting to change that
mating.
Changed : monitor.lisp
===================================================================
MB		ETA & BETA				Jun 2, 1994
new: FLAG : lambda-conv
     MEXPR : lexpd*-beta lexpd*-eta lcontr*-beta lcontr*-eta beta* eta*
     WFFOP : wffeq-ab-beta wffeq-ab-eta lnorm-beta lnorm-eta
     EDOP : lnorm-beta lnorm-eta
     TACTIC : beta-eta-together-tac, beta-eta-separate-tac,
              beta-only-tac, lcontr*-vary-tac, lexpd*-vary-tac,
              lexpd*-beta-tac, lexpd*-eta-tac, lcontr*-eta-tac,
              lcontr*-beta-tac.

plus: lambda*, lnorm, lexpd*, lcontr*, wffeq-ab-lambda, lcontr*-tac,
lexpd*-tac all now use both beta and eta conversion.

go2-tac, monstro-tac, rewrite-sline-tac, rewrite-pline-tac,
pline-tac and sline-tac all now use lexpd*-vary-tac and
lcontr*-vary-tac (which check the value of LAMBDA-CONV and apply
the appropriate tactics).

Changed files:
core.exp, ml.exp, edlmbd.lisp, wffop-otl.lisp, wfflmbd2.lisp,
ml-tactics-quant.lisp, ml-etr-tactics-pline.lisp,
ml-etr-tactics-sline.lisp, ml-etr-tactics-main.lisp, prfw.lisp,
master-tactic.lisp, ml2-logic5b.rules/lisp, ml2-logic7c.rules/lisp
===================================================================
MB, HX		BETA, ETA				Jun 2, 1994
The parts of the above job relating to etrees (in particular, the
justification labels attached to rewrite nodes) are now fixed.
We can now prove thm135.
Changed files: etrees-wffops.lisp, mating-merge-eq.lisp, etrees-skolem.lisp,
etrees-exp-vars.lisp
===================================================================
MB		EQUIV-EQ				Jun 3, 1994
Added EQUIV-EQ-CONTR and EQUIV-EQ-EXPD, with associated ND tactics,
and changed GO2, MONSTRO to use these instead of EQUIV-EQ. This fixes
one of the entries in manually-generated-rules.
Changed: manually-generated-rules, master-tactic, ml-tactics-quant,
wffabb2, ml2-logic7a.{rules,lisp}
===================================================================
MB		LEMMA					Jun 4, 1994	
LEMMA insists that the hypothesis set of
a new lemma must be exactly equal to the hypo set  of the conlusion.
Basically, what the code in manually-generated-rules did was to
weaken the requirement to the level that the former hypo set
must be a subset of the latter one. Now we have a new property 
for irules: hyp-restrict. If hyp-restrict is NIL, or not specified,
then the hypotheses have to be the same. Otherwise, the first has to be 
a subset of the second.
This allows us to remove manually-generated-rules.lisp, and fixes 
x2112-bug1 properly.
Changed: defpck.lisp, manually-generated-rules.lisp (removed),
rule-idef.lisp, rule-build-check.lisp, rule-build-defaults.lisp,
ml1-logic0.{rules,lisp}, otl-help.lisp
===================================================================
MB		manuals					Jun 5, 1994
Checked old tps programmers' manual and incorporated a few useful 
things into the current one. Updated all three manuals to include 
new commands; rewrote a couple of chapters of the programmers' manual.
====================================================================
MB		TURNSTILE-*				Jun 7, 1994
I've added a little to the help messages for these two flags,
plus adding synonyms that are spelt correctly. I've also 
implemented TURNSTILE-INDENT-AUTO, which takes values FIX/MIN/VARY;
FIX means use the value of {SLIDES-}TURNSTILE-INDENT,
MIN means work out the minimum possible value for TURNSTILE-INDENT,
VARY means put the turnstile immediately after the hypotheses.
(see the help message for more information; I think that the style
VARY looks better for slides).
While I was at it, I fixed the screen display so that
TURNSTILE-INDENT and TURNSTILE-INDENT-AUTO apply to that, too (for
this, the flags turnstile-* had to be moved from otl-scribeout 
to prtotl).
Changed: otl-scribeout.lisp, texchr.lisp, deftex.lisp, prtotl.lisp
doc/lib/tps.tex, flagging.lisp (mhelp for synonyms needed fixing)
====================================================================
MB		SLIDEPROOF fonts bug			Jun 7, 1994
Slideproof didn't have all the fonts it needed, because it didn't 
load the doc/lib/tps.mss file. Now it does.
Changed: common/tps3.ini
====================================================================
MB 		COMPRESS style				Jun 7, 1994
There is now a style COMPRESS for TURNSTILE-INDENT-AUTO; this removes
surplus spaces between the line number and the hypotheses, plus all
spaces around dots, etc...
Changed: otl-scribeout.lisp, prtotl.lisp, scribe.lisp
====================================================================
MB		PRIM-QUANTIFIER				Jun 7, 1994
Fix the code for generating gensubs in prenex normal form
so that it omits the quantifiers when PRIM-QUANTIFIER is NIL.
===================================================================
MB		REINDEX, SPRING-CLEAN			Jun 7, 1994
Commands to salvage damaged library directories.
Changed: lib-ops.lisp, library.lisp
===================================================================
HX              TPS-MODE                                June 12, 1994
Type TPS-MODE's been modified. If an object is not a TPS-MODE, TPS
will look up for it in libraries after given permission. In other
words, review command MODE can always be used before fetching is done.

Changed file: flagging.lisp
====================================================================
HX              min-quantifier-bug fixed                June 12, 1994

The flag min-quantifier-scope had difficulty dealing with
skolem terms, equivs, etc. Now it is ok.

Changed files: etrees-wffops.lisp etrees-skolem.lisp
====================================================================
HX              minor bug with DEFSYNONYM               June 12, 1994

>>I notice from using the synonym function that although setting the
>>synonym also sets the original flag, setting the original flag
>>doesn't reset the synonym. Is there some reason for this?(MB)

Gone.
Changed functions (DEFMACRO DEFSYNONYM ...) set-flag update-flag
Changed file : flagging.lisp review.lisp
====================================================================
MB		modified TPS-MODE again			Jun 12, 1994
...so that it won't try to use the library in ETPS (where they have 
MODE but not libraries) and it'll find MODEs as well as MODE1s.
Changed: flagging.lisp
====================================================================
MB		INDIRECT-PLINE-TAC			Jun 12, 1994
There was a minor bug in the nat-ded version of this tactic, which I
discovered by doing GO2 on THM120B (it accidentally tried to push in
the negation on the planned line instead of the newly-created
support line...)

Changed: master-tactic.lisp
====================================================================
MB		MOVE*					Jun 12, 1994
I found this in the bugs file, and fixed it:
>The command move* seems to move two lines very well, but with 
>more than two lines it gives the message:
>Error from MOVE*.  The destination line is already present.
>and moves only the first two lines.
Changed : otl-rearrange.lisp
====================================================================
HX              ETANORM                                JUNE 13, 1994
I noticed that ETANORM has a bug in it. For example, if you applied 
it to "lambda x. h", where h is a skolem term, then you would be in 
trouble. You will know what I mean if you set num-of-dups to 1 and 
try to prove thm112. Now this is fixed.

Changed file: wfflmbd2.lisp
====================================================================
MB		FETCH bug				Jun 14, 1994
FETCH used to occasionally return things like:
#<Synonym Stream to SYSTEM:*STDOUT*>, because of a bug in get-lib-abbr.
Changed: lib-objects.lisp
======================================================================
MB		GWFFS retrieved from library		Jun 16, 1994
TPS will always look for gwffs and abbrs in the
library (prompting as at present with modes) insofar as this won't
cause problems. Doesn't work in ETPS, because no libraries there.
Changed: wfftyp.lisp, wfftst.lisp
======================================================================
MB		print-line-generic			Jun 16, 1994
Fixed a minor bug in print-line-generic; PALL now looks prettier.
Changed: prtotl.lisp
====================================================================
HX              UPDATE-LINE-NODE                        Jun 21, 1994

A bug was found in function UPDATE-LINE-NODE. Please see the comments
about it in the code. (I have not figure out exactly what caused the
bug, but the fix seems to work fine.)

Changed file: diy.lisp     
====================================================================
HX              NEG-REW-SLINE and NEG-REW-PlAN          Jun 21, 1994

When a rewrite node is BETA or ETA, the justifications for these rules
were wrong. This has been fixed.

Changed files: ml-etr-tactics-sline.lisp  ml-etr-tactics-pline.lisp

=====================================================================
HX              overhauling the backtracking strategy       JUNE 25th 94

New representation of matings in ms90-3
Keep track of the path one was spanning when one added the connection.
This should permit a solution to the disjunction heuristic bug.
Can also use it to improve the backtracking mechanism.
	Test the time taken to prove some theorems with the new & old
backtracking mechanisms.
	Perhaps also add a flag to disable the disjunction heuristic;
in this case one only needs to keep one copy of each link which goes into
the mating.

Old notes:
		BACKTRACKING

Change the way the backtracking mechanism works to make it cleaner and
eliminate possible bugs.  Just keep track of
the path one was spanning when one added a connection.
This should be done for both ms88 and ms90-3. At present we don't
really backtrack; we start the search again and run up to where we 
were. This takes unnecessary time.

Sunil says this requires a fair amount of reorganization of the
program.

Added file: ms90-3-data.lisp
changed file: mating-top.lisp ms90-3-top.lisp ms90-3-path-enum.lisp
              ms90-3-path-bkup.lisp

Remark: most of the functions in ms90-3-path-bkup have been deleted
since they are no longer needed. In addition, function close-path-p
has been deleted, too. So the job deletes more code that it adds.
=====================================================================
MB		PROGRAMMERS MANUAL			Jul 10, 1994
Finished updating the manual, deleting obsolete information, etc.
Old manual is (gzipped) in $doc/prog/oldman, in case we ever need it.
====================================================================
MB		TACTICS MHELP				Jul 11, 1994
Tactic mhelp now expands non-primitive tactics as much as possible.
Changed: tactics-macros.lisp
====================================================================
PBA		Makefile				1994 July 12
	Certain operating systems seem to execute a Makefile without
reading the .depend file, so comments about incorporating the .depend
information directly into the Makefile have been inserted into
/afs/cs/project/tps/common/Makefile, /afs/cs/project/tps/dist/README,
and the last chapter of the User's manual
=====================================================================
HX             cleanup proofs                           1994 July 14
     I have rewritten the function "cleanup-same" so that we can get rid
of more redundant lines in proofs.

Changed file: otl-cleanup.lisp
=====================================================================
HX             inner quantifier duplication             1994 July 14

Now inner quantifier duplication is enabled and always prefered.

Changed function: find-next-dup
Changed file: hx-ms90-3-fix-top.lisp jforms-labels.lisp

=====================================================================
HX       Bug with the duplication in the first path     1994 July 14

Please refer to DUP-BUG-1, which has the following jform.
|       FORALL z^0        |
|        LEAF11           |
|        ~Q z^0           |
|                         |
|FORALL y^0               |
| |   LEAF8    |          |
| |   P y^0    |    LEAF10|
| |            | OR Q Z^0 |
| |   LEAF9    |          |
| |~P [X^0 y^0]|          |

The second quantfier FORALL y^0 has to be duplicated in order to
get a mating. The old code prevents all quantifiers except the
first one from being duplicated when current mating is empty.
That is why this is a bug. Another more obscure occurrence of
the bug can be found while proving x5310 and setting ORDER-COMPONETS
to T. It's been fixed. 

Changed function: find-next-dup
=====================================================================
HX             Closed primsubs                          1994 July 14

Now the bug with closed primsubs has been fixed. No pathological univ
jforms are allowed.

Changed functions: find-outer-exp-nodes and exp-node-to-jform
Changed files: etrees-jforms.lisp ms90-3-expand-etree.lisp
=====================================================================
HX             Skolem constants                         1994 July 14 

The annoying bug has been fixed. Always skipping over rewrite node
is the essential idea of the fix. I do wish it would not occur again.
Sigh!

Changed function: create-skolem-node
Changed file: etrees-wffops.lisp
=====================================================================
HX            a-bd-wff-p and e-bd-wff-p                 1994 July 14

Two typos were found in the code of these two functions. "ae-bd-wff-p"
was wrongly put in the place for "a-bd-wff-p" and "e-bd-wff-p".

Changed file: wfftst.lisp

=====================================================================
HX            GWFF-P(AB* bug)                           1994 July 19

GETWFF-SUBTYPE was called twice in order to make items in libraries
available. But it caused a trouble if you used '(ed "something")' as
an argument for some commands(It forced you to enter ED toplevel twice)
Now this is fixed. The changed function is "get-only-rwff".

Changed file: wfftyp.lisp

=====================================================================
HX                go-fetch-gwff                         1994 July 20

Variable GLOBAL-TYPE was forgotten to be declared as a special one.
Now this is fixed.

Changed file wfftst.lisp

=====================================================================
HX                acons in LUCID CL                     1994 July 20

In Lucid 4.0, ACONS generates a run-time error when its third argument
is not a list, so we redefine ACONS here to do what is expected. 

I now define acons as a macro after geting rid of the old function
definition attached to ACONS. It should work this time since I have
checked.

Changed file: boot0.lisp

****
Finally, I realized that this doesn't work because acons must have been
called by other lisp functions. I have changed the code back. This is
really a good lesson. (HX July 28, 1994)
=====================================================================
PBA		/afs/cs/project/tps-1			 1994 July 29

I have moved
/afs/cs/project/tps/tps/old-source     and
/afs/cs/project/tps/tps/proofs
to /afs/cs/project/tps-1/tps (using copy, so that dates are preserved,
though owners are not), and then linked the directories back to
/afs/cs/project/tps/tps
=====================================================================
MB		PRFW jobs				1994 Aug 2
TPS now doesn't open a window if PROOFW-ACTIVE, PROOFW-ALL, or 
PROOFW-ACTIVE+NOS is NIL. (These flags used to simply control printing 
into the windows.) Fixed a few minor bugs in print-line-generic and
in the ^pn window.
Changed: prfw.lisp, prtotl.lisp, otl-prt.lisp
=====================================================================
MB		library WARNINGS			1994 Aug 4
Library warnings can now be turned off with the LOAD-WARN-P flag
Changed: maint.lisp, lib-ops.lisp
=====================================================================
MB		TPS-TEST				1994 Aug 4
Implemented TPS-TEST; added REROUTE-OUTPUT-APPEND to list of utils.
Changed: maint.exp, maint.lisp, macsys.lisp
=====================================================================
MB		INIT-DIALOGUE				1994 Aug 5
New INIT-DIALOGUE-FN written that will save a default mode on 
startup. INIT-DIALOGUE reimplemented.  STRINGDT(L) made into a utility.
New quiet option for TPS-TEST.
Changed: maint.lisp, macsys.lisp, tps3-save.lisp
=====================================================================
HX              ms90-3-prop.lisp                        1994 Aug 5

The reason why the compiling process building LUCID version of TPS3
stalled is that ms90-3-prop.lisp contained an in-line optimisation,
which baffled LUCID compiler.

Now I have fixed this, but a convincing answer to the problem should
be checked some day in a manual for LUCID CL.

The following is my pure hallucination.

It seems that LUCID CL has a variable, which basically tells you the
maximum number of warnings it can tolerate. Because there are huge
number of warnings during rebuilding tps3, the compiling process
stalls before finishing compiling all the files.

=====================================================================
HX      Fix for the Lucid version of TPS                1994 Aug 5

A new tps-compile.lisp has been written for the following purpose.

Think about making the hp version of tps-compile.lisp for
lucid the general version for all systems. The pathnames seem more
stable in it.

	When you say (compile-file file :output-file xxx)
while  building TPS for Lucid on the HP,
the default directory for xxx is the directory in
which file stays. Notice that the parent directory of
/users/theorem/tps/hp_LCL4.0/lisp/
is not
/users/theorem/tps/hp_LCL4.0/ but
/afs/cs/project/tps/tps/.
So when you say
/users/theorem/tps/hp_LCL4.0/lisp/../bin/xxx,
you cannot get file
/users/theorem/tps/hp_LCL4.0/bin/xxx.

Changed files:

Makefile: To eliminate some warnings;
tps-compile.lisp: To fix the incorrect path name;
tps-build.lisp: To eliminate a warning.

=====================================================================
HX   Changing the behavior of the loading functions   (AUG. 8, 1994)

The loading functions(tload, cload and qload) will no longer
load a file into the tps core image unless the file has been
changed since the last building of the core image or variable
core::smart-load is nil.

The changed file is

boot1.lisp
=====================================================================
HX         another bug in prettifying process        (AUG. 8, 1994)

The prettifying process mistakenly treats variable "w" as one from
the unifying process, sometimes. Besides, it does not check the
"free-for" condition when renaming variables.

These glitches have been remedied.

Changed file:

mating-merge-eq.lisp
=====================================================================
MB	INIT-DIALOGUE and INIT-DIALOGUE-FN		Aug 9, 1994
	Put some brief mention of these in the User's Manual.
Restricted their use to TPS only. Rewrote INIT-DEFINE-MY-DEFAULT-MODE
so that it works. Changed the getfn for INTEGER+-OR-INFINITY.
Changed:argtyp.lisp, maint.lisp, tps3-save.lisp
====================================================================
MB			ETP				Aug 11, 1994
	We now have a MATE command which is like ETD, but which prints 
the shallow formulas for all nodes, not just the leaf nodes.
Changed: etrees-print.lisp, auto.exp
====================================================================
HX      QLOAD and CLOAD-MUDULE                          Aug 11, 1994

These two functions have been modified to serve their purpose better.

1) CLOAD-MUDULE can make a judgement whether it is necessary to compile
   a file if its compiled version exists. This makes it unnecessary to
   delete the bin directory before rebuilding a TPS3 core unless some
   macros have been changed.

2) QLOAD now is quite the same as TLOAD except that it check the extension
   of a file to see if it should compile it.
=====================================================================
MB		DUPLICATION-STRATEGY			Aug 11, 1994
The flag DUPLICATION-STRATEGY has had its help message clarified.
Is just for ms88.
Changed ms91-basic.lisp, option-tree-mateops.lisp, etrees-flags.lisp.
=====================================================================
MB		HELP for categories			Aug 11, 1994
Help for categories now prints out a list of items in that category,
rather like ENVIRONMENT. The ?? output of ENVIRONMENT has been tidied
up a little.
Changed: mhelp.lisp
=====================================================================
MB		ETP					Aug 12, 1994
Changed format to NODE [sel-exp-terms] : CHILDREN : SHALLOW FMLA
Changed: etrees-print.lisp
=====================================================================
MB		ETP help message			Aug 16, 1994
Help message now explains format; dividers used are now semicolons;
output of ETD is now in the same format. Also fixed help for utilities.
Changed: etrees-print.lisp, mhelp.lisp
=====================================================================
MB		TEST bug fix				Aug 16, 1994
TEST used to have a bug in the MS88 version (to do with the fact that 
MS88 had no timing facilities of its own); now it doesn't.
Changed: test-top-search.lisp, mating-dir.lisp
=====================================================================
HX              Flag DUPLICATION-STRATEGY-PFD           AUG 16th, 94

The flag is only for path-focused procedures.

It may have either of two values: DUP-INNER and DUP-OUTER. DUP-INNER
means inner quantifiers get duplicated before outer ones, while
DUP-OUTER means vice versa.

Changed files: ms90-3-top.lisp etrees-flags.lisp auto.exp

PS: Please read the comments around function find-next-dup if you'd
like to make the code more efficient. At current stage, this is merely
to avoid thm300a-bug. After the bug is fixed, we may delete this flag.
(but we probably won't delete it --- PBA)
=====================================================================
MB		TEST-THEOREMS				Aug 18, 1994
Changed the help message; new default value; example in patch file.
Changed: maint.lisp
=====================================================================
MB		.ini files				Aug 18, 1994
The distributed tps3.ini file has been unlinked from the version in 
tps/common, so that we can set TEST-THEOREMS and other such flags 
in the global ini file. All of the setq's that should have been 
set-flag's now really are set-flag's.
Changed: tps3.ini, etps3.ini
=====================================================================
MB		TEST top level				Aug 19, 1994
Help message for TEST made more informative. New command VARY-MODE.
Changed: test-top-top.lisp, test-top-slists.lisp
=====================================================================
MB		New TEST commands			Aug 19, 1994
Commands REVISE-DEFAULTS, SCALE-UP and SCALE-DOWN. See help messages.
Also changed enumeration so that it works in the same order as the 
range is listed, rather than reverse order.
Changed: test-top-{top,search,slists}.lisp
=====================================================================
HX              New min-quant-etree bug                 AUG 19, 1994

Function one-step-mqe-infix has to skip over rewrite nodes. This was
not done and caused a bug while translating the proof for thm112a.

Changed file: min-quant-etree.lisp
=====================================================================
HX              FIX THM300A-BUG                         AUG 18, 1994

Function RESTORE-UNIF-PROB returned NIL when (ho-unify unode) failed.
Later on this may cause a confusion between an nnunification problem
and ununifiable unification problem. Thm300a-bug in my library is a
simple example. Calling the latter "ununifiable", I can make a 
distinguishment between these two to fix thm300a-bug.

All this is in ms90-3-top-patch.lisp, which should be tested thoroghly
before being installed permanently.

Changed file: ms90-3-top-patch.lisp(newly created)
=====================================================================
MB		PREAMBLES & POSTAMBLES			Aug 20, 1994
All of the following variables have now become flags:
SLIDES-PREAMBLE, SCRIBE-PREAMBLE, SCRIBE-POSTAMBLE, TEX-PREAMBLE, 
TEX-1-PREAMBLE, TEX-POSTAMBLE, TEX-1-POSTAMBLE, TPSTEX.
The flags slides-preamble, scribe-preamble, vpform-tex-preamble 
and tpstex are system specific and so default to "", but are set 
properly in the tps3.ini file.
Changed: edtop.lisp, otl-scribeout.lisp, vpforms-tex.lisp, tps3.ini
=====================================================================
MB		fetching needed-objects			Aug 21, 1994
(e.g.) MATE THM135 ! had stopped fetching the needed objects for THM135.
Traced the problem to (declare (special again)), which should have been
(locally (declare (special again))), in gwff-p
Changed: wfftst.lisp
=====================================================================
MB		TEST-FIX-UNIF-DEPTHS			Aug 21, 1994
Implemented the above flag.
Changed: test-top-{slists,search}.lisp
=====================================================================
HX               BUG with MIN-QUANT-ETREE               Aug. 22, 1994
We usually make distinction between EQUIVWFFS kind of
rewrite node and LAMBDA kind of rewrite node. In other
words, we usually don't put the instantiation of a formula
into its normal form immediately. We do it by using a
LAMBDA rule explicitly. This causes a bug when function
min-quant-etree is called, sometimes. Thm120i is a good
instance.

At present, I cannot see any significance it brings to
make the distinction. Therefore, I let an EQUIVWFFS kind
rewrite node use LAMBDA conversion implicitly. This makes
the fix a lot easier. I have put my comments in the code
since this is pretty technical.

Changed file: mating-merge-eq.lisp
=====================================================================
MB		AGAIN					Aug 22, 1994
Cleaned up all non-local declarations that AGAIN was special,
by replacing (declare (special again)) with (locally (declare (special again))).
There might still be other non-local variables that ought to be made local
in this way...
Changed: mating-mateops.lisp, flagging.lisp, test-top-slists.lisp
=====================================================================
HX             INNER QUANTIFIER DUPLICATION             AUG 23rd, 1994
I have finished writing a short paragragph mentioning this under section
Path-Enumerator.

Does anything about it need to be added to the
Programmer's Manual? With the help of the code of function find-next-dup,
I think this is enough.
==================================================================
HX             comments on empty unification problems   AUG 23rd, 1994

The comments will be around the code in file ms90-3-top.lisp(now it is
in ms90-3-top-patch.lisp).

Please be sure that adequate documentation about
empty unification problems is put into the code as comments and
into the Programmer's manual.
==================================================================
HX		MIN-QUANT-ETREE 		Aug 21?

Move documentation for code related to MIN-QUANT-ETREE and to duplicating
inner quantifiers to the User's Manual.

Motivation:
Currently the messy proof of x5310 is caused by the restriction that
we can only duplicate outermost quantifiers. Once this is fixed, we
can get a pretty clear proof. Then I feel it is possible to work on
the finished expansion tree, instead of searching again, to construct
a more readable proof. We might spare a lot of time in this way: the
metatheorem above is very hard to state clearly, let alone prove it.

See the discussion of X5310 in  /afs/cs/project/tps/tps/papers/tps94/tps94.mss:
M1 which can be transformed to the wff N mentioned above by applying
elementary logical equivalences.  Using the prenex formula M instead
of the miniscope formula N has drawbacks, and the natural deduction
proof for x5310 which @tps constructs is 57 lines long and is rather
clumsy. It might be possible to remedy this by modifying the procedure
so that it would repeat part of the proof process after the correct
instantiation terms have been discovered and put into miniscope form.

I break the problem into two steps:
(1) Allowing duplications of inner quantifiers.(done separately)
(2) Building up a procedure to min-quant-scopeIZE finished expansion trees,
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^
    then use propositional search to get new correspoding matings.
    
The second step needs a lot of programming work. I have failed several times.
Now I would like to split it into a few substeps.

(2.1) Try to min-quant-scopeIZE the finished etrees. Basically, try to use
      a restricted version of RULEQ in a similar way as we treat RULEP. This
      might be a messy way bungling things since we have to do major surgeries
      on the finished etree. A very rich source for bugs.

(2.2) Rewrite the functions which are used in handling min-quant-scope conversion.
      The current ones are a big junk of mess, and can not deal with exp-var
      structure, which becomes exceedingly important when doing etree surgeries.

(2.3) Eventually, fix the incompatibility between the new code and the merging
      process. Because there are not normal forms for ruleq, you have to remember
      the result of a ruleq application, and use it later on in the merging process.

Changed file: min-quant-etree.lisp(newly added), cnf.lisp(rewriting the functions
doing minimum quantifier scope stuff)

New flag: min-quant-etree
======================================================================
HX		TRUTHVALUES flag   (This was done long ago.)
Change the name and description of this flag. Make it clear that
this implements a heuristic which is extremely special.

Yes, I now call it TRUTHVALUES-HACK. It could be used as a good 
example to show people how to deal with translation process, especially,
how to create new tactics, how to handle merging process, etc.
Since pfd procedures has been able to deal with truth values correctly,
the flag is really a vestige except in a few higher order cases.

Changed files: try to find the occurences of TRUTHVALUES in the code
=====================================================================
HX            ms90-3-top-patch.lisp      AUG. 24th, 1994

All the functions and comments in ms90-3-top-patch.lisp have been moved
into or merged into ms90-3-top.lisp.

Changed file: ms90-3-top.lisp
=====================================================================
MB		LAST-MODE-NAME			Aug 24, 1994
Implemented this flag.
Changed: flagging.lisp, review.lisp
=====================================================================
MB		grader.ini			Sep 8, 1994
The grader.ini file wasn't being loaded, but now it is.
Changed: grader.patch
to end up with (setq core::smart-load nil)
=====================================================================
MB		QUICK-START			Sep 8, 1994
Implemented the above command.
Changed: test-top-slists.lisp, auto.exp
=====================================================================
MB		BREADTH-FIRST-SEARCH		Sep 19, 1994
New search strategy for test top level.
Changed: test-top-slists.lisp, test-top-search.lisp
=====================================================================
MB		ETPS for SUNS			Sep 20, 1994
ETPS compiled for the new Sun Sparcstations in WeH 5202.
=====================================================================
MB		PRESS-DOWN			Sep 20, 1994
New search strategy for test top level.
Changed: test-top-slists.lisp, test-top-search.lisp
=====================================================================
MB		PRESS-DOWN command		Sep 21, 1994
New command in the test top level.
Changed: test-top-slists.lisp, test-top-search.lisp
=====================================================================
MB		POSINTEGER-OR-INFINITY		Sep 22, 1994
New type created; MAX-MATES changed to this type, to prevent
PRESS-DOWN from trying to run with MAX-MATES 0
Changed: core.exp, argtyp.lisp, ms90-3-node.lisp, test-top-slists.lisp.
=====================================================================
MB		PUSH-UP				Sep 22, 1994
Created the PUSH-UP search function, and the associated command 
PUSH-UP. Fixed the output so that timings are real rather than 
rational. Also fixed so that automatically generated lists won't 
let min-quick-depth be above the maximum value of max-utree-depth
and max-search-depth. 
Changed: test-top-slists.lisp, test-top-search.lisp
=====================================================================
MB		TESTWIN output			Sep 22, 1994
Output to the test window now includes mode, theorem and name of 
theorem.
Changed: test-top-top.lisp, test-top-search.lisp, mating-top.lisp
=====================================================================
MB		TPS-TEST			Sep 27, 1994
Fixed bug in tps-test (used proof-plans macro before it was defined).
Changed: maint.lisp
=====================================================================
MB		TPS-TEST			Sep 29, 1994
Added new header to the file produced by tps-test.
Changed: maint.lisp
=====================================================================
MB		fetching needed-objects		Sep 29, 1994
(e.g.) MATE THM131 ! had stopped fetching the needed objects for THM131.
Traced the problem to (declare (special global-type)), which should have been
(locally (declare (special global-type))), in gwff-p
Changed: wfftst.lisp
=====================================================================
MB		TEST-TOP			Sep 29, 1994
PUSH-UP now doesn't do press-down as well.
The command that does both push-up and press-down is called FIND-BEST-MODE
(so command completion will still work).
QUICK-START has been renamed QUICK-DEFINE, so as to be less confusing.
Changed: auto.exp, test-top-{search,slists}.lisp
=====================================================================
MB		PROP-MSEARCH			Sep 29, 1994
New mating search command; Sunil's fast propositional prover.
Changed: auto.exp, ms90-3-node.lisp
=====================================================================
MB		SUNIL'S FAST PROPL. PROVER	Sep 29, 1994
New flag, USE-FAST-PROP-SEARCH. Change to spanning-clist-p and
valid-p to use the fast prover where possible.
Changed: mating-top, mating-trans, ms90-3-node, ms90-3-expand-etree,
newrulep-tsts.lisp
=====================================================================
MB		MIN-QUANT-ETREE			Oct 6, 1994
With min-quant-etree set to T, tps made no distinction between 
equiv-wffs and lambda conversion while constructing the etree, 
but expected the distinction to be there while translating it...
Fixed this, and also added the option to restore default flags
in tps-test.
Changed: wffequ2.lisp, maint.lisp
=====================================================================
MB		TEST Manual entry		Oct 10, 1994
Wrote a user manual entry for the test top level.
=====================================================================
MB		RULE help			Oct 12, 1994
Fixed bug with turnstile indentation in rule help.
Changed: otl-help.lisp
=====================================================================
MB		SHOW-TIMING			Oct 12, 1994
Implemented the library command SHOW-TIMING.
Changed: library.lisp, lib-ops.lisp
=====================================================================
MB		SHOW-TIMING			Oct 13, 1994
Changed command to allow output to Scribe, TeX or generic files.
Changed: library.lisp
=====================================================================
MB		COMPARE-MODES			Oct 13, 1994
New command in the review top level. Also fixed the library 
command interpreter to allow review commands from the library top level.
Changed: review.lisp, library.lisp
=====================================================================
MB		HISTORY-SIZE			Oct 19, 1994
Put history-size flag into subjects otl-vars and maintain. Added
to help message for history command.
Changed: linereadp.lisp
=====================================================================
MB		PRESS-DOWN bug			Oct 20, 1994
Ms90-3 wasn't failing properly when it ran out
of time for the test top level. This is now fixed.
Changed: ms90-3-node.lisp, ms90-3-top.lisp
=====================================================================
MB						Oct 24, 1994
RECORDFLAGS is now mentioned in the help message for DATEREC.
Changed: mating-mateops.lisp
=====================================================================
MB		Lucid Windows			Oct 24, 1994
Proofwindows (and all the others) now work in the lucid version of TPS.
Changed: tops20.lisp
=====================================================================
MB		Lucid i-gc-time			Oct 24, 1994
We can now measure GC time in lucid TPS. 

Changed: timing.lisp, tps3.ini
=====================================================================
MB		Loading needed objects, again	Oct 25, 1994
Finally traced the source of the problem with loading needed 
objects to the fact that global-type is used well before it 
is defined. Moved the defvar from tpinf.lisp to wfftst.lisp,
and now all is well. Fixed a minor library bug as well.
Changed: lib-ops.lisp, tpinf.lisp, wfftst.lisp
=====================================================================
MB		Empty option sets		Oct 26, 1994
These turned out to be caused by attempts to duplicate quantifiers
when the penalty for doing so was infinite. Fixed this.
Changed: ms91-basic.lisp
=====================================================================
MB		^C for etps			Nov 16, 1994
Allegro CL was handling *trap-errors* wrongly.
Changed: tps3-error.lisp
=====================================================================
MB		PRESS-DOWN			Nov 30, 1994
Press-down now stops if it makes a couple of cycles without any 
success.
Changed: test-top-search.lisp
=====================================================================
MB		TPS-TEST			Jan 13th, 1995
Tps-test had stopped working because of a typing error in the code.
Changed: maint.lisp.
=====================================================================
MB		FLAGS				Jan 13th, 1995
Added num-of-dups to ms90-3 and some other flags to ms92-9 and ms93-1.
Changed: ms92-9-top, ms93-1, ms90-3-node.
=====================================================================
MB		MATEVPW				Jan 13th, 1995
TPS on dtps was too quick for the vpwindow to catch the first few lines.]
Changed the window startup to tail -n1000 -f, which fixed it.
Changed: tops20.lisp
=====================================================================
MB		ORDER-COMPONENTS		Jan 13th, 1995
New value: T-REVERSED / PATHNUM-REVERSED.
Changed: order-components.lisp
=====================================================================
MB   SUBSUMPTION CHECKING IN MTREE		13 Jan 95 

The mtree top level now has a rudimentary subsumption checker,
which can be turned on and off by the MT-SUBSUMPTION-CHECK
flag.
======================================================================
MB		TEST-TOP			Jan 17th, 1995
Fixed the various test-top searches so that they behave the same way
as MATE.(i.e. you can either call the search by name, or 
set TEST-NEXT-SEARCH-FN to the name of the search and call GO.)
Changed: test-top-search.lisp, test-top-slists.lisp
=====================================================================
MB		CLEANUP				Feb 2nd, 1995
Can now call cleanup on incomplete proofs, to remove instances
of SAME.
Changed: otl-cleanup.lisp
==================================================================
MS		DL, DR				Feb 8th, 1995
Implemented editor commands DL and DR.
Changed: wffchange.lisp, edchange.lisp
==================================================================
MB		ABORT				Feb 13th, 1995
Implemented ABORT as a mexpr (the new X interface needed it).
Changed: linereadp.lisp
==================================================================
MB		WINDOW-STYLE			Feb 14th, 1995
Implemented WINDOW-STYLE and USE-WINDOW-STYLE (again, mostly for the 
benefit of the new X interface).
Changed: edtop.lisp, otl-prt.lisp, test-top-search.lisp, vpforms.lisp
==================================================================
MB		INTERRUPTS			Feb 14th, 1995
Fixed the <RETURN> / ^G+<RETURN> system of interrupts for MS88/89,
and extended it to all matingsearches and mtree searches.
Changed: ms90-3-top.lisp, mating-dir.lisp
==================================================================
MB		TABLEAU				Feb 15th, 1995
Implemented the TABLEAU command.
Changed: otl-prt.lisp.
==================================================================
MB		DEFAULT-EXPAND, DEFAULT-MATE	Feb 21st, 1995
DEFAULT-EXPAND and DEFAULT-MATE control, or are controlled
by, DEFAULT-MS.
Changed: mating-top.lisp
===================================================================
MB		MTREE				Feb 21st, 1995
Installed the MTREE top level, and the renumber-leaves routines.
Changed: many files. auto.exp, contexts-auto.lisp, plus all files
of the form $tpslisp/../old-source/*-to-1995feb21
===================================================================
MB		:element-type :default		Feb 22nd, 1995
CMUCL doesn't like you to specify :element-type :default when you're
loading a file. So I've removed all references to it.
Changed: filsys.lisp, macsys.lisp, vpforms.lisp
===================================================================
MS		mbed commands			Feb 25th, 1995
MBED-{AL,AR,OL,OR,IL,IR,F,E} installed.
Changed: contexts-core.lisp
New files: wffmbed.lisp, edmbed.lisp
===================================================================
MB		Type checking by editor		Feb 25th, 1995
Editor now does some type checking to make sure that the current edwff is
of an appropriate type. Also the testfn for gwff0 has changed.
Changed: tpstop.lisp, mating-top.lisp
===================================================================
MB		ETPS errors			Feb 27th, 1995
ETPS now prints a message when it traps an error.
Changed: tps3-error.lisp
===================================================================
MB		RENUMBER-LEAVES BUG			28 Feb 1995
	The problem turns out to be that the flag renumber-leaves is
defined in the mtree module, but is used in modules which are compiled
before that.
	So I've moved the file mtree-renumber to etrees-renumber,
changed its module, and rebuilt tps3cmu on ftps to check that this
works. This has fixed the bug.
	For the meantime, I've added (qload "mating-sub") to the patch
file, which should fix the problem until we next rebuild. If it does
happen again (it might also affect other matingsearches), just set
RENUMBER-LEAVES to NIL.
=====================================================================
MB		Installing Core Images			2nd Mar 1995
There are now executables in the admin directory that will query the user
about installing the finished tps core images, if they exist.
=====================================================================
MS		mbed commands				3rd Mar, 1995
MBED-{QL,QR,L,=L,=R} installed.
Changed: wffmbed.lisp, edmbed.lisp
===================================================================
MB		ALLEGRO-STABLE				3rd Mar, 1995
Fixed the problem with building allegro-stable by moving mtree-datastructure
from the mst module to exapnsion-trees. (ACL3.1 didn't like the reference
to matingstree-merged in diy.lisp, before matingstrees were defined.)
===================================================================
MB		Daterec bug				19th Mar, 1995
The new filenames defined by daterec were symbols rather than filespecs,
for some reason. This is fixed now.
Changed:library.lisp
===================================================================
MB		WINDOWSTYLE				28th Mar, 1995
Changed WINDOWSTYLE to default to XTERM; moved the xterm module higher
in the build and compile files (it was next to last).
===================================================================
MB		MACHINE-INSTANCE			28th Mar, 1995
Added the flag MACHINE-INSTANCE which shows the name of the computer 
for CMU and Lucid lisps. (Allegro has it as SHORT-SITE-NAME.)
Changed: tops20.lisp, tps3-save.lisp
===================================================================
MB		LIBRARY					28th Mar, 1995
TPS was checking the backup library even when it wasn't necessary 
(e.g. for the needed-objects during INSERT, where the given objects
were in the main library).
Changed: library.lisp
===================================================================
MB		BUG-SAVE, BUG-RESTORE			28th Mar, 1995
Implemented the above commands.
New file: lib-bug.lisp
===================================================================
MB		FACILITIES GUIDE			28th Mar, 1995
Mtreeops now print properly into the facilities guides.
Changed: mtree-top.lisp
===================================================================
MB		BEEPS AFTER DIY				29th Mar, 1995
DIY now beeps three times on the HPs (it used to be so fast that they
all ran together).
Changed: diy.lisp
===================================================================
MB		MBED-E1					30th Mar, 1995
Implemented mbed-e1
Changed: core.exp, edmbed.lisp, wffmbed.lisp
===================================================================
MS		SETFLAGS1				4th Apr, 1995
Implemented setflags1
Changed: core.exp, review.lisp
===================================================================
MB		Indexing				4th Apr, 1995
Theorems are now indexed in the facilities guide.
Changed: scrdoc.lisp
===================================================================
MB		Line length limit			05 Apr 1995

It used to be that there was a limit of 256 characters to the length of 
lines that you could type to TPS (this showed up mostly with ED, when 
entering long gwffs).
It turns out that this was a hard limit concealed somewhere in either xterm 
or csh, and it has been removed (or at least raised to something enormous)
in the HP implementation. The pmaxes still have this problem, and there's 
nothing (according to the manual pages) you can do about it.
======================================================================


MB		JFORMS					6th Apr, 1995
DJFORM now works again, and jform-to-gwff gives more useful output
when jform-represents is NIL.
Changed: jforms-defns.lisp, jforms.lisp
===================================================================
MB		DPAIRS					24th April, 1995
Made it possible to convert an automatically-created dpairset into
one with a name that can be saved in the library (NAME-DPAIR); fixed
the library insert function for dpairs; changed the default functions
for unif-problem so that it makes a reasonable guess at the free variables.
Changed: unif-user.lisp, lib-objects.lisp, auto.exp
===================================================================
MS		SETFLAGS2				24th Apr, 1995
Implemented setflags2
Changed: core.exp, review.lisp
===================================================================
MB		BUG-SAVE				25th Apr, 1995
BUG-SAVE now saves and restore the current proof, as well as everything
else. Added flags USE-DEFAULT-BUG-DIR and DEFAULT-BUG-DIR, and set them 
up so that bugs are saved in /afs/cs/project/tps/admin/bugsdir/.
Added BUG-DELETE, and improved the output of BUG-SAVE.
Changed: lib-bug.lisp
===================================================================
MB		EDITOR					26th Apr, 1995
The editor was prompting about loading from the library for every malformed
wff. Changed it so that it only does that for *symbols* it doesn't 
recognise.
Changed: wfftst.lisp
===================================================================
MB		NAME-PRIM				26th Apr, 1995
NAME-PRIM was only referring to the shallow formula; now it looks at 
the correct variables.
Changed: etrees-wffops2.lisp
===================================================================
MB		GET-SCORES-HP				28th Apr, 1995
get-scores-hp now works properly; dirname is installed in the 
etps-scores directory instead of locally on the DECstations.
Changed: admin/etps-scores/get-scores-hp
===================================================================
MB		PRIM-SUBST				1st May, 1995
New editor command prim-subst simulates prim-single in the editor.
Changed: wffsub2.lisp, edsub.lisp
===================================================================
MB		WINDOW-STYLE				1st May, 1995
The default for window-style is now xterm (moved flag from otl-prt.lisp
into xterm.lisp so that this would initialise properly).
===================================================================
MB		BUG-LIST, BUG-HELP			2nd May, 1995
Implemented BUG-LIST and BUG-HELP.
Changed: lib-bug.lisp
===================================================================
MB		PP*					11th May, 1995
Implemented PP* in the unification top level.
Changed: unif-user.lisp
===================================================================
MB		PRIMSUB-METHOD				17th May, 1995
Renamed the NEW-PRIMSUB flag (introduced about 2 weeks ago) to PRIMSUB-METHOD;
defined the three settings PR89, PR93, PR95; updated help messages and
user manual.
Changed: prim.lisp
===================================================================
MB		Depth messages				18th May, 1995
The "Current utree depth is N, which is bigger than FLAG" messages 
have been replaced by "s" for MAX-SEARCH-DEPTH and "u" for MAX-UTREE-DEPTH
This makes the output much more readable.
Changed: unif-tree.lisp, unif-depth.lisp
===================================================================
MB		UTREE*					19th May, 1995
The UTREE* command prints exactly the same information as UTREE,
but in a tree format.
Changed: unif-user.lisp
===================================================================
MB		Unification top level			25th May, 1995
Added more output to PP*; fixed it so that it regards all individual
type letters as being base types (since we don't do type unification
during matingsearch), improved all the help messages in this top level.
===================================================================
MB		Unification				31st May, 1995
Fixed the print routine for substitutions (in node.lisp) and made
UTREE* show whether a node is obtained by imitation, projection or
some other means.
Changed: node.lisp, unif-user.lisp
===================================================================
HX              saveproof(not expansion proof)		31st May, 1995
Cleaned up some code. Function DEFSAVEDPROOF2 (a duplication of macro
defsavedproof) has been eliminated. Function  RENAME-PROOF is rewritten
and renamed as PROMPT-PRFNAME.

GWFFs are recorded as S-expressions from now on while downward
compatibility is still maintained so that all ancient recorded proofs
can be restored.

Changed: saveproof.lisp
===================================================================
HX              steam bug                               1st June 1995
Fixed a few bugs related to example STEAM. This is another trouble
caused by ruleq.

Changed: mating-merge-eq.lisp cnf.lisp
===================================================================
MB		Unification				1st June 1995
Added APPLY-MATCH-MOST-CONSTS as an option to the flag APPLY-MATCH.
Prevented UN88 from constructing double-negation imitation terms 
unless reduce-double-neg is NIL.
Changed: unif-tree.lisp, unif-match.lisp
===================================================================
MB		Unification				2nd June 1995
Introduced flag DNEG-IMITATION, which replaces the above fix to 
double-negation imitation terms.
This flag only applies in UN88, when REDUCE-DOUBLE-NEG is T,
and is not needed for UN90.
This permitted a drastic improvement in the search time for THM15B.
Changed: unif-match.lisp, unif-tree.lisp, unif-user.lisp
===================================================================
MB		SEARCH					2nd June 1995
Added the SEARCH function to the library.
Changed: library.lisp
===================================================================
HX          Bug with RESTOREPROOF			5th June 1995

SAVEFILE (FILESPEC): File in which proof resides ["\\*\\*\\*\\*\\*.prf"]>
/afs/cs/project/tps/tps/proofs/thm136-interactive.prf
--> LET IN-MODE LET LET WHEN COND IF PROGN UNLESS COND IF PROGN RETURN 
==>
  (RETURN-FROM NIL NIL)
Error: Return for unknown block: NIL.

--> LET IN-MODE LET LET WHEN COND IF PROGN UNLESS COND IF PROGN IF RETURN 
==>
  (RETURN-FROM NIL NIL)
Error: Return for unknown block: NIL.
Proof THM136-INTERACTIVE restored.

Fixed. Lesson learned: because of different lisp implementations, it would be
better to avoid using 'NIL' as a block name.
===================================================================
MB		VP in EDTOP				7th June, 1995
The VP command in the editor now applies cjform to the current edwff
if necessary.
Changed: vpforms.lisp
===================================================================
MB		SUBSUMPTION				7th June, 1995
Added a hash function to UN88 unification nodes; this is the first 
step towards a subsumption checker.
Changed: node.lisp, unif-subs.lisp
===================================================================
MB		OUTPUT					7th June, 1995
Introduced the "R", "F", "?" and "M" output symbols.
Changed: unif-subs.lisp, unif-simpl.lisp, unif-tree.lisp, mating-dir.lisp,
ms-real.lisp, option-tree-search.lisp, connections.lisp, ms90-3-unif-simpl.lisp
===================================================================
HX              RULEQ trouble                          	7th June, 1995
The problem has been fixed. The RULEQ node introduced with universal
quantification is called RULEQ-UNIV. Other changes are spared at this moment.
Changed files: diy.lisp, mating-merge-eq.lisp, ml-etr-tactics-pline.lisp
PS: The aforementioned "steam bug" is truely fixed this time.
===================================================================
MB		SAVEPROOF ABBREVIATIONS			12th June, 1995
SAVEPROOF now stores all of the abbreviations that are used in the proof.
There are also two new editor commands, ABBR and LIB-ABBR.
Changed: edabb.lisp, wffabb.lisp, saveproof.lisp
===================================================================
MB		TPS-TEST				13th June, 1995
TPS-TEST was mistakenly printing "Proved (whatever)..." when it should
have printed "Terminated with planned lines..."
Changed: maint.lisp
===================================================================
MB		LIBRARY					13th June, 1995
Added a small patch to complete-lib-filename which allows it to take a 
symbol as argument. Fixed a bug in the dpair insert function.
Changed: lib-ops.lisp, lib-objects.lisp
===================================================================
MB		TIMING in UNIFICATION			19th June, 1995
Added a time-check in the unification routines, because the new subsumption
check can take a very long time.
Changed: connections.lisp, unif-mat.lisp, unif-tree.lisp, unif-subs.lisp,
option-tree-search.lisp, ms90-3-unif-tree.lisp, ms90-3-top.lisp,
ms90-3-path-enum.lisp, ms90-3-path-bkup.lisp.
===================================================================
MB		SUBSUMPTION-NODES			19th June, 1995
Added the flag SUBSUMPTION-NODES.
Changed: unif-subs.lisp
===================================================================
MB		Subsumption check for UN88		20th June, 1995
Implemented subsumption check for UN88. Removed the file unif-subsump.lisp,
which is incomplete and has never been used in TPS.
Changed: unif-tree.lisp, unif-subs.lisp
===================================================================
MB		Subsumption again			21st June, 1995
Knocked some of the bugs out of the above.
Also implemented SUBSUMPTION-DEPTH.
Changed: unif-subs.lisp, unif-tree.lisp
===================================================================
MB		PRIM-BDTYPES-AUTO			21st June, 1995
Introduced the two new values REPLACE-SUB and APPEND-SUB.
Changed : option-tree-search.lisp, ms91-search.lisp, prim-edops.lisp
===================================================================
MB		SUBSUMPTION				28th June, 1995
Fixed a minor bug in subsumption check, and wrote documentation for 
the programmer's manual.
Changed: unif-subs.lisp
===================================================================
MB		RW					28th June, 1995
RW wasn't working, but now it is.
Changed: weak.lisp
===================================================================
MB		RESTOREPROOF				28th June, 1995
RESTOREPROOF now uses the SOURCE-PATH directory.
Changed: saveproof.lisp
===================================================================
HX              CNVRT-PROP-JFORM                        29th June, 1995
A bugged version has been fixed. Barriers between cretain patterns of
jforms made PROP-MSEARCH totally confused.
Changed file(s): ms90-3-exp-jform.lisp
===================================================================
MS		CLEAN UP BUG RECORDS  Sat Jul  1 22:56:46 1995
===================================================================
HX               ETANORM                                 5th July, 1995
The testing function LSYMBOL-P in ETANORM really should have been
LSYMBOL-Q, and this has been fixed.

Changed file(s): wfflmbd2.lisp
===================================================================
MB		SUBSUMPTION				10th July, 1995
Implemented subsumption for ms90-3 procedures.It's not much use.
Changed: node.lisp, unif-subs.lisp, ms90-3-unif-tree.lisp
===================================================================
MB		ABBREVIATIONS				10th July, 1995
Added better library support for abbreviations; you can now enter
the editor with "THM1 IMPLIES THM2" and then instantiate them as abbreviations.
Changed: lib-ops.lisp, wffabb.lisp
===================================================================
MB		CONSTANTS				18th July, 1995
Implemented constants for the library.
Changed: lib-objects.lisp
===================================================================
MS 		 DESCRIBE*			25th July, 1995
Added this command which is a combination of LIST and DESCRIBE. For all 
flags in the  subjects specified, TPS DESCRIBEs the flags. 
Changed: review.lisp
===================================================================
MS 		 ECONJ*, ICONJ*			27th July, 1995
Added aliases to my tps3.ini in afs directory to implement these commands 
which can handle multiple conjuncts. There doesn't seem to be any obvious 
way of introducing them as rules since defirule cannot handle an unknown 
number of conjuncts. 
Changed: nothing.
===================================================================
MS 		ALTER_GRADE			30th July, 1995
Supplement to MODIFY-GRADE. It takes a list of grade names and prompts 
the user with the name of each student, allowing the grades in the list 
for each of those students to be changed. 
Changed: grades2.lisp
===================================================================
HX              NAT-ETREE                           AUG 1st. 1995

Now this command is available for those who are interested in finding
an expansion proofs of natural deductions. Simply load 

/afs/cs/user/hwxi/lisp/tps/natree/new-natree.work

to get started. Bug reports are welcome.

New Files: hx-natree-auto.exp  hx-natree-aux.lisp  hx-natree-rulep.lisp
           hx-natree-debug.lisp hx-natree-top.lisp hx-natree-duplication.lisp
===================================================================
HX              GET-DEF-BINDER                      AUG 1st. 1995

There is a bug with DAN's fix. Read my comments to understand the problem.

Changed file: wffabb.lisp
===================================================================
MB		WEAK LABELS				Aug 7th, 1995
If an object was defined as both a weak label and an abbreviation, 
TPS used apply-label on it first and then crashed because it wasn't
applicable. So now the library removes the FLAVOR property when an
abbreviation is loaded.
Changed: library.lisp
===================================================================
MB		SHOW-OBJECTS-IN-FILE			Aug 10th, 1995
Implemented SHOW-OBJECTS-IN-FILE
Changed: library.lisp
=======================================================================
MB		UMASK PROBLEM ON DTPS			Aug 10th, 1995
	When trying to rebuild tps on dtps while logged in as theorem,
we used to get queries like:
[dtps]/users/theorem/tps/hp_LCL4.0% do-maketps-hp_LCL4.0
bin/lib-objects.lbin: 644  mode ? (y/n) 
Changed: run-tps3*, in /users/theorem/bin/, to include UMASK 0113
=====================================================================
MB		HELP*					Aug 10th, 1995
Implemented the commands HELP* and HELP-GROUP.
Changed: mhelp.lisp
=========================================================================
MS		FORMALISING GVNB SET THEORY Sun Aug 13 23:03:45 1995

Read Boyer86, Andrews76, Andrews81, Andrews89, Robinson65 & first two
chaptersof Godel's 1940 monograph. Inserted axioms of Boyer relevant
to the formalisation of THM15B & some of his definitions as lib
abbreviations in the file boyer.lib. Symbols were introduced as
logical constants with the appropriate face, e.g. set membership has the 
face epsilon. All constants are in tpslib/milind/boyer.lib. The proof of thm15bin GNVB set theory where I left off is /afs/cs/user/milind/formbishop.prf & canalso be found in the tpsproofs.  
	This proof parallels the rearranged and shorter proof of thm15b which
can printed from /afs/cs/user/milind/renum-imp15b.ps (also in tpsproofs). Proof of the lemma (line 800) used to assert the existence of set p remains to be
proved along the lines of Godel's inductive step (ch 2, 1940
monograph) case for m logical operators.  GB3-THM15B is the abbr in
boyer.lib which expresses thm15b in Boyer's system.  PROVE15B is the
abbr in boyer.lib which expresses the conditional [conjunct of boyer
axioms implies thrm15b] being proved in formbishop.prf.

===================================================================
MS 		HELP MESSAGES		Sun Aug 13 23:06:19 1995

Brief help messages have been inserted for FACE, DW* & NAME in 
/afs/cs/project/tps/tps/doc/user/newdoc.
===================================================================
MB		CASES3, CASES4, ASSOC-LEFT		23 Aug 1995
Implemented CASES3/4 and ASSOC. These are basically hacks until
we rewrite the rules package to allow CASES* to deal with any number of
cases, associated in any way.
Changed: wffchange.lisp, defpck.lisp
New file: ml2-hacks.rules
===================================================================
MB		ECONJ*, ICONJ*, UGEN*			23 Aug 1995
Added aliases for the above the the tps3.ini file.
===================================================================
MB		WORKFILES				24 Aug 1995
Stopped DIY from writing "." into workfiles.
Changed: mating-dir.lisp
===================================================================
MB		DIY					24 Aug 1995
DIY now does CLEANUP on partial proofs.
Changed: diy.lisp
===================================================================
MB		ANDREW					30 Aug 1995
Added build and install scripts for the Andrew versions of TPS and ETPS,
updated tpstrail, and rebuilt the sun4 versions. The core image is
now saved as .etps and then moved to .etps.exe for installation.
===================================================================
MB		DIY-L					1 Sep 1995
Introduced the command DIY-L. Fixed DIY so that it corrctly uses
the "support lines" provided by the user.
Changed: diy.lisp
===================================================================
MB		DEFAULTS				9 Sep 1995
The default line numbering used to have a maximum of 10000, and 
this was causing some odd effects. Fixed that, and also introduced
the (probably useless) flag SUPPORT-NUMBERS.
Changed: linenumber1.lisp
===================================================================
MB		ASSERT					11 Sep 95
ASSERT now loads theorems from the library in the same way that PROVE
does.
Changed: theorem-mac.lisp
===================================================================
MB		RULEC1					11 Sep 95
RULEC1 is a new version of RULEC that takes "EXISTS x B" to "B"
unless x is free in the hypotheses or in the planned line.
Changed: ml2-hacks.rules
===================================================================
MB		USE-INTERNAL-PRINT-MODE			11 Sep 95
This flag allows the user to override the internal settings for Scribe and
TeX output.
Changed: wffout.lisp, library.lisp, otl-scribeout.lisp
===================================================================
MB		MILIND'S BOYER FILES			14 Sep 95
Copied Milind's boyer library file into the tpslib/boyer86 directory.
Also moved his partial proof into the proofs directory, as boyer-ms-part.prf
===================================================================
MB		ETAN, ETAC, LNORM-ETA			17 Sep 95
TPS believed "lambda x lambda y . x" --->(eta) "y". Now it doesn't.
The problem was the function wff-applic-p, which really checks for a cons
and not for an application ("lambda y . x" is a cons, of (y . LAMBDA) and x,
so it was assumed to be a function application.
Changed: wfflmbd2.lisp
===================================================================
MB		SCRIBELIBFILE, TEXLIBFILE		17 Sep 95
These commands now print abbrs using special characters.
Changed: lib-ops.lisp, lib-objects.lisp
===================================================================
MB		PRW					18 Sep 95
PRW command, and flag INFIX-NOTATION, implemented.
Changed: prtop.lisp
===================================================================
MB		TPSTEST					18 Sep 95
TPS stopped providing default names for proofs when the FLAVOR 
property was removed from library objects (see Aug 7th 95, above),
and this stopped tps-test from running without user input. Fixed this.
Changed: maint.lisp
===================================================================
MB		MS90-3 unification			18 Sep 95
MS90-3 was unifying depth-first (the unifiers for THM148 were
very silly indeed, which is how we caught it). Now it has a 
breadth-first search too, and uses UNI-SEARCH-HEURISTIC to choose
between them.
Changed: ms90-3-unif-tree.lisp, unif-tree.lisp
===================================================================
MB		REWRITE-DEFNS				19 Sep 95
REWRITE-DEFNS now takes a list of abbreviations or a boolean
as an argument.
Changed: etrees-wffops.lisp, etrees-flags.lisp, etrees-exp-vars.lisp,
etrees-skolem.lisp
=====================================================================
MB		ETREES-RENUMBER bugs			20 Sep 95
Fixed some bugs with renumbering.
Changed: etrees-renumber.lisp
=====================================================================
MB		IDISJ-LEFT, IDISJ-RIGHT			20 Sep 95
Introduced IDISJ-LEFT and -RIGHT commands, and changed the IDISJ
tactics to refer to these, so that USE-RULEP NIL doesn't have to use
RULEP any more. This fixes a couple of bugs.
Changed: ml2-hacks.{lisp, rules}, ml-etr-tactics-pline.lisp
=====================================================================
MB	SAVE/CREATE-SUBPROOF, MERGE-PROOFS, TRANSFER-LINES	22 Sep 95
Implemented the above. 
Changed: saveproof.lisp
=====================================================================
MB		Comments in proofs			25 Sep 95
Proofs now take a comment as an additional property. This is saved
and restored by saveproof and restoreproof, and is printed by scribeproof,
texproof and printproof. Also added PROOF-COMMENT command.
Also the bug that caused SAVEPROOF to occasionally 
save NIL as an abbreviation has been fixed.
Changed: otl-scribeout.lisp, otl-fileout.lisp, saveproof.lisp
=====================================================================
MB		COUNT-LINES				25 Sep 95
Implemented COUNT-LINES.
Changed: otl-prt.lisp
=====================================================================
MB		TIDY-PROOF				25 Sep 95
Implemented this command.
Changed: etr-nat-macros.lisp
=====================================================================
MB		ETPS-BUG				26 Sep 95
Bug in ETPS was causing RULEP to crash. (The problem was the variable
*fps-succeeded*, which isn't bound in ETPS.)
Changed: newrulep-tsts.lisp
=====================================================================
MB		PROOFLIST				27 Sep 95
PROOFLIST now displays the proof-comments. The help message
for PROOF-COMMENT mentions this.
Changed: otlnl.lisp
=====================================================================
MB		SAVEPROOF, SCRIBEPROOF			27 Sep 95
SAVEPROOF was crashing on ETPS due to a residual S-expression,
now removed. SCRIBEPROOF was crashing because I'd forgotten to change
the etps.ini file when SCRIBE-POSTAMBLE was made into a flag.
Changed: etps.ini, saveproof.lisp
=====================================================================
MB		SAVEPROOF				28 Sep 95
Fixed SAVEPROOF so that ETPS users can save and restore comments.
Changed: saveproof.lisp
=====================================================================
MB		SAVEPROOF				2 Oct 95
Saveproof now saves library constants as well as abbrevs.
Changed: saveproof.lisp
=====================================================================
MB		PRFW					4 Oct 95
Pop-up windows now: (A) update after a RESTOREPROOF, RECONSIDER, SAVE-SUBPROOF,
CREATE-SUBPROOF, or MERGE-PROOFS. (B) delete all their /tmp/foo* temporary files
(C) name their files differently (because the HPs were too quick for 
(get-internal-time) to work properly) (D) get closed when you exit TPS.
Changed: macsys.lisp, edtop.lisp, vpforms.lisp, prfw.lisp
=====================================================================
MB		FIND-LINE				9 Oct 95
Implemented FIND-LINE.
Changed: otl-prt.lisp
=====================================================================
MB		TEXPROOF				6 Nov 95
Texproof in tex-1 style was crashing because of an indentation command; 
replaced it with (pcall indent ...) which does the trick.
Changed: otl-scribeout.lisp
=====================================================================
MB		LINE-COMMENT				13th Nov 95
It is now possible to add comments to lines. The new flag PRINT-COMMENTS
determines whether these will be printed out. Comments can include gwffs,
labels and line numbers, which we be dealt with appropriately. Comments
are saved and restored by saveproof and restoreproof.
Changed:prtotl.lisp, otl-fileout.lisp, otl-scribeout.lisp, otlnl.lisp, 
saveproof.lisp, otl-prt.lisp
=====================================================================
MB		EXITING from EXECUTE-FILE		5th Dec 95
Now you can quit while stepping through a work file by typing ^G RETURN.
Changed: save-work.lisp.
=====================================================================
MB		SAVEPROOF				5th Dec 95
SAVEPROOF was saving the definitions of abbreviations in the wrong order,
leading to loading problems. MERGE-PROOFS was assuming the main proof
was the current dproof.
Changed: saveproof.lisp
=====================================================================
MB		SAVE-SUBPROOF				15th Jan 96
Fixed a bug in save-subproof (by adding a remove-if #'null to 
add-justifications).
Changed: saveproof.lisp
=====================================================================
MB		DIY-L					15th Jan 96
Fixed a subtle bug in DIY-L (it was trying to move the line NIL,
which created chaos).
Changed: diy.lisp
=====================================================================
MB		SMALL JOBS				15th Jan 96
Added to help message for LINE-RANGE-LIST and SAVE-SUBPROOF. Exported
all the new commands in ml2-hacks. Wrote ARE-WE-USING.
Changed: otl-cleanup.lisp, core.exp, ml.exp, otl-typ.lisp, saveproof.lisp
=====================================================================
MB		SEARCH2					19th Jan 96
Implemented this.
Changed: library.lisp
=====================================================================
MB		UNIF. OUTPUT				19th Jan 96
Added flags UNIF-COUNTER and UNIF-COUNTER-OUTPUT; changed the output 
a little to be more informative if you ask for more details.
Changed: unif-{test,mat,match,user}.lisp
=====================================================================
MB		REGULARITY etc				21st Jan 96
Unification output now has the flag UNIF-TRIGGER, and can also test 
for regular types.
Changed: unif-{test,mat,match,user}.lisp
=====================================================================
MB		MERGE COMMENTS				23rd Jan 96
MERGE-PROOFS now merges the comments for each line.
Changed: saveproof.lisp
=====================================================================
MB 		Minor otlnl problem			23rd Jan 96
MOVE* occasionally crashed if a justification was (NIL) instead of 
NIL. (No idea how justifications like that come about; it can't happen
often or this bug would have surfaced sooner.) This is now fixed.
Changed: otlnl.lisp
=====================================================================
MB		Small bugs				26th Jan 96
Fixed CASES3/4 (wrong hypotheses being used) and create-subproof
(wasn't reloading after deleting lines).
Changed: saveproof.lisp, ml2-hacks.rules
=====================================================================
MB		NEEDED_OBJECTS				26th Jan 96
INSERT now makes its best guess about the needed-objects for a 
the object being inserted. (Only works if you're inserting it under
the same name as it already has in TPS.)
Changed: edabb.lisp, wffabb.lisp, library.lisp
=====================================================================
MB		SCRIBEPROOF				26th Jan 96
SCRIBEPROOF couldn't cope with very large lists of hypotheses. Now it can.
Changed: otl-scribeout.lisp
=====================================================================
MB		Small bugs, again			29th Jan 96
The bug above in create-subproof was not due to failing to reload
the proof; it was due to forgetting to update the "GAPS" property
of the proof. Fixed.
Changed: saveproof.lisp
=====================================================================
MB		MOVE*					29th Jan 96
MOVE* has been made smarter, and so produces fewer warnings.
Changed: otl-rearrange.lisp
=====================================================================
MB		UNIFICATION CHANGES			7th Mar 96
A number of new unification routines have been installed. They include:
1) some additional unification output, governed by the flags 
   UNIF-COUNTER, UNIF-COUNTER-OUTPUT and UNIF-TRIGGER
2) some additional (not useful) ways to search the unification tree, including 
   PRUNING (a flag) and BEST-FIRST (a setting for UNI-SEARCH-HEURISTIC).
3) some additional unification commands: PRUNE and FIND-NESTING; the former
   prunes out all failure branches, the latter finds values for MAX-SUBSTS-*.
4) MAX-SUBSTS-VAR, MAX-SUBSTS-PROJ and MAX-SUBSTS-PROJ-TOTAL, three new flags 
   that provide an alternative to setting depth bounds on a unification tree.
5) A fixed version of LEAST-SEARCH-DEPTH that allows you to set the flags
   MAX-SUBSTS-* as well as the unification depths.
6) New values for APPLY-MATCH: APPLY-MATCH-MAX-SUBSTS (works in UN88 and UN90)
   and also APPLY-MATCH-MIN-SUBSTS, APPLY-MATCH-MOST-CONSTS (both only work in
   UN88, and aren't very useful).
7) New inbuilt modes MSV-ON and MSV-OFF that turn (4) and (6) on and off.
8) Unification command EPROOF-UTREE.
The behaviour of all these things is explained in the help messages.
Changed: unif-simpl.lisp, unif-match.lisp, unif-mat.lisp, unif-tree.lisp,
unif-user.lisp, ms90-3-unif-simpl.lisp, ms90-3-unif-tree.lisp
=====================================================================
MB		SUBST-EQUIV				2 Apr 96
Implemented substitutivity of equivalence.
Changed: ml2-hacks.{lisp,rules}
==========================================================================
MB		MTREE					10th July 96
Mtree now works for higher-order problems. (There are still bugs, but 
it's at least possible to use it...)
Changed: mtree-top.lisp mtree-duplication.lisp mtree-unification.lisp
==========================================================================
MB		UNIFICATION				10th July 96
The flags MAX-SEARCH-DEPTH, MAX-UTREE-DEPTH and MIN-QUICK-DEPTH can now
be set to NIL. The flag MAX-SUBSTS-QUICK has been implemented. The commands
UNIF-DEPTHS and UNIF-NODEPTHS have been added.
Changed: mating-dir.lisp, ms90-3-top.lisp, node.lisp,
ms90-3-node.lisp, ms90-3-unif-simpl.lisp, unif-simpl.lisp,
ms90-3-path-enum.lisp, ms90-3-unif-tree.lisp, unif-tree.lisp
==========================================================================
MB		UNIFICATION				12th July 96
Updated the user manual to reflect the changes above.
==========================================================================
MB		GARBAGE COLLECTION				 18 Jul 1996 

I've been trying to improve EXPUNGE and also to make the garbage collection
between option sets in MS91 more effective. It seems that this is very hard;
there are a lot of structures (mostly unification trees, I suspect) that get
discarded midway through the search and are lost by the time the search ends.

I think they probably "protect themselves" against garbage collection
because of the way that each node refers to its children, which in turn
refer to their parent; this may mean that gc can't say "this structure is
not referred to anywhere else; let's delete it". But this is just
speculation, as I don't know much about the workings of garbage collection.

We could go through the entire search procedure with an eye to destroying
everything once it's been used, but this would be difficult to do correctly.

So, anyway, things have improved a little, but giant searches like THM115
still end up wasting lots of space.


Changed: option-tree-aux.lisp, ms91-search.lisp
=======================================================================
MB		SCRIBELIBFILE/TEXLIBFILE		12th August 1996
Changed both these commands to allow output of multiple library files to 
a single .mss/.tex file.
Changed: library.lisp
=======================================================================
MB		MAX-MATES				19th August 1996
ms90-3 was interpreting max-mates wrongly (it was allowing max-mates
connections to each copy of a literal, rather than to all of them together).
Changed: ms90-3-top, ms90-3-path-enum, ms90-3-path-bkup, jforms
=======================================================================
MB		REWRITE-DEFNS				21st August 1996
New implementation of REWRITE-DEFNS to allow LAZY2 evaluation. Removed
flag REWRITE-DEFNS-EAGER. Added library command FIX-MODES.
Changed files: etrees-flags, etrees-wffops, mating-merge-eq,
mating-merge, wffequ2, diy, otl-cleanup, ms90-3-expand-etree,
ms91-search, lib-ops
=======================================================================
MB		REWRITE-EQUALITIES			23rd August 1996
The flags REWRITE-EQUAL-EXT and REWRITE-ONLY-EXT have been done away with, and
REWRITE-EQUALITIES now does all the work. It takes a similar range of options
to REWRITE-DEFNS. The merging and prettifying code has been fixed to work 
with the new rewrite nodes. 
Changed: etrees-flags.lisp, etrees-wffops.lisp, etrees-wffops2.lisp,
lib-ops.lisp, mating-dir.lisp, mating-merge-eq.lisp,
mating-merge.lisp, min-quant-etree.lisp, symsimp.lisp, wffabb2.lisp
=======================================================================
MB		CLEANUP BUG				27th August 1996
Cleanup should refuse to clean up "broken" proofs; there was an old example
in which some of the line numbers in the justifications had been set to NIL,
which was almost completely erased when CLEANUP was tried. There are two 
possible ways to fix this: either write code that will check an alleged 
proof by essentially reproving it, or patch CLEANUP to refuse to allow 
null justifications except at leaves of the proof The former seemed so
time-consuming that the latter was implemented; CLEANUP now insists that 
every line be justified by some other line, unless it is justified by 
HYP, RULEP, ASSUME NEGATION or ASSERT.
Changed: otl-cleanup.lisp
=======================================================================
MB		VP BUG					27th August 1996
display-vpdiag would crash when using its brief output format if any of the
leaves were not literals (i.e. were TRUTH or FALSEHOOD). Now it doesn't.
Changed: vpforms.lisp
=======================================================================
MB		MERGING BUG				28th August 1996
remove-leibniz was messing up nodes that were applications of REFL=
modulo some lambda rewrites, causing a merging bug in (e.g.) x6004.
Changed: mating-merge-eq.lisp
=======================================================================
MB		Minor bugs				2nd-8th Sept 1996
>(HX) Run diy on thm109, then you will see a bug in merge procedure
>(order-components should be set to NIL or T) [Use mode-thm109-c. MB]
This one is odd, but it can be fixed by throwing away all the unnecessary 
connections as soon as rewrite-leibniz finishes.
Changed: mating-merge-eq.lisp

The bug that was producing a false mating for thm143a has been fixed.
When MS89 reconsidered an old option, it found the old connection list,
but not a unification tree for it. This meant that if it could add some 
new connections to get a complete mating, and then unify those new 
connections, then it thought that the entire mating was unifiable and 
reported success.
Changed: option-tree-search.lisp

I've fixed prettifying (it's a hack, but it works, and it's commented in case
of future bugs) so that we can now prove X6101 in MODE-X6004-DTPS.
I've also fixed the bug we noticed earlier; the problem was an assumption 
that the next thing below one of our new rewrite nodes would be a conjunction
or disjunction; in fact, there might be some lambda-rewrites in the way.
Changed: mating-merge-eq.lisp, etrees-wffops.lisp

The bug that looks like:
>"The formula is not provable as there's no connection on the following path:"
has now been at least partially fixed. It turned out that UN90 wasn't doing
eta-expansion properly in SIMPL and the resulting unification trees claimed 
success when in fact they were false.
A good example of this is THM188-PARTIAL, using MODE-THM188.
Changed: ms90-3-unif-simpl.lisp

>prove thm173 in mode-x5200-c -- gives a "no connection on the following path"
I've fixed this by means of a hack in find-all-dups (ms90-3-exp-jform.lisp). 
There's a comment in the code, since I'm not sure of the fix; if new bugs 
start showing up in the translation of pfd proofs, this could well be the cause...
Changed: ms90-3-exp-jform.lisp
=======================================================================
MB			LEIBNIZ UNIFIERS		9th Sep 1996
I've added the code that prevent Leibniz expansions from taking arbitrary 
unifiers. In particular, we now restrict q in Leibniz expansions
"forall q . q x implies q y" to be relevant in its first argument.
This only takes effect when max-substs-quick is in use.
Changed: unif-tree.lisp, ms90-3-unif-tree.lisp, etrees-wffops.lisp
=======================================================================
MB		LEAVE					26th Sep 96
LEAVE now works properly from the grader and review top levels.
Changed: grades2.lisp, review.lisp
=======================================================================
MB		TPS-TEST				27th Sep 96
The mechanism invoked by OPEN-TESTWIN to display the TEST-TOP
output is now also used when running TPS-TEST. Also, a minor bug in etrees-wffops.lisp
has been fixed, and the close-testwin command has been made a mexpr so that 
it can be used from the main top level.
Changed: maint.lisp, test-top-search.lisp, etrees-wffops.lisp
=======================================================================
MB		TPS-TEST/TPS-TEST2			22nd Oct 96
Added an extra option to TPS-TEST, which allows the theorems to be 
proven with either DIY or MATE (until now, they were always proven with MATE).
There is also a new command TPS-TEST2 which , given a searchlist, calls
the TEST top level on each pair of elements in TEST-THEOREMS and runs through
proofs for each element of the searchlist.
Changed: test-top-search.lisp, maint.lisp
=======================================================================
MB		IMPORTANT				22nd Oct 96
Added the subject "important"
Changed: many things, although none substantially (subject lines in
flag definitions, plus a defsubject command in node.lisp).
=======================================================================
MB		PROBLEMS / ABBREVIATIONS		31st Oct 96
Changed the code for PROBLEMS and ABBREVIATIONS so that they 
now optionally show what the definition of each problem or abbreviation is.
Changed: otlnl.lisp
=======================================================================
HW		CHANGE-SEQUENCE				7th Nov 96
Installed the grader command CHANGE-SEQUENCE.
Changed: grades2.lisp
=======================================================================
MB		Grader Contexts				8th Nov 96
Moved all contexts for the grader package into contexts-teacher.lisp,
and gave them all an order.
Changed: contexts-teacher.lisp, gr-macros.lisp
=======================================================================
MB		Library changes				18th Nov 96
* DEFAULT-LIB-DIR and BACKUP-LIB-DIR are now lists of directories; the former
  is a list of directories you can write to and read from, and the latter a
  list of directories you can read from.
* In particular, you can now have multiple library directories. These
  directories can contain different definitions of the same object. Needed-objects 
  are loaded from the same directory as the original object, if possible, and 
  otherwise from wherever they can be found.
* Changing DEFAULT-LIB-DIR or BACKUP-LIB-DIR automatically reloads the 
  master indices for all the directories, as does RESTORE-MASTERINDEX.
* Restore-masterindex does some basic checking (that the files referred to
  actually exist), and reports to you if they don't.
* It no longer crashes when confronted with a directory that has no 
  libindex.rec file.
* The new flag SHOW-ALL-LIBOBJECTS determines the behaviour of any command
  which matches more than one object. If it is set to NIL, it will behave
  like the old library code (where possible; otherwise it will prompt you
  for any more information it needs). If it is set to T, then you will be
  shown a list of all library objects matching your specification.
* The new flag ADD-SUBDIRECTORIES, if T, checks all the given library
  directories for any subdirectories which are also libraries, and adds them 
  to DEFAULT-LIB-DIR or BACKUP-LIB-DIR as appropriate.
* The new flag REMOVE-TRAILING-DIR will, if T, determine the longest redundant 
  part of your library directories and then suppress it in all output.
* The library doesn't reload objects that are already present in TPS, except
  when you specifically ask it to by using FETCH (even then, it'll ask you
  to confirm that you want it reloaded).
* SHOW-TIMING can output timing information on all instances of a particular
  theorem, across many directories.
* The default list of subjects for inserting a MODE1 is now something sensible, rather
  than "no default".
* The command DESTROY will remove any library object from TPS.
* Items in the library now have two more properties, :provability and :proof-date
  When these are non-NIL, they represent the current state of provability,
  which is always one of a fixed list of nine items followed by the date when 
  this property was last changed. These 9 items are:
  1) Automatic expansion proof and translation to natural deduction
  2) Automatic expansion proof
  3) Semi-automatic expansion proof in MATE top level
  4) Interactive expansion proof in MATE top level
  5) Semi-automatic natural deduction proof
  6) Interactive natural deduction proof
  7) Not proven
  8) Not provable
  9) NIL (nothing recorded)
* The command CHANGE-PROVABILITY resets this property to a new value (all
  of these commands will show you the list above; you need only type the number).
* The command FIND-PROVABLE looks for all gwffs having a particular provability.
* The command DATEREC will prompt for an update of this property.
* Provability is now output by the commands SHOW-WFF and SHOW-WFF&HELP,
  as well as by all commands that print the entire stored item (eg SHOW)
  and by SCRIBELIBFILE and TEXLIBFILE for settings of MED or MAX.
* The SPRING-CLEAN command has been made much faster.
* The user manual has been edited to reflect these changes.
Changed: defpck.lisp, flagging.lisp, lib-bug.lisp, lib-macros.lisp, lib-objects.lisp, 
lib-ops.lisp, library1.lisp, library2.lisp (last two were previously library.lisp), 
maint.lisp, test-top-lib.lisp, wfftst.lisp
=======================================================================
MB		LEIBNIZ SUB CHECKER				22nd Nov 1996
The Leibniz substitution checker (see entry for 9/9/96) was rejecting good 
substitutions. The resulting fix weakened the checker to such an extent that
there is a new flag, LEIBNIZ-SUB-CHECK, which switches it off entirely (because
it now tends to take more time than it saves!).
Changed: unif-tree.lisp, ms90-3-unif-tree.lisp
=======================================================================
MB		REWRITE RULES / THEORIES			9th Dec 1996

TPS now supports rewrite rules. They are stored as library objects of type 
rrule, whose description is a dotted pair of gwffs with extra attributes
"typelist" (the list of all polymorphic type symbols in the rule),
"bidirectional" (T if the rule can be applied in both directions),
"appfn" (the name of a function to test applicability of the rule, or NIL)
and "function" (an optional extra function which is applied, after the 
rewriting, to the subformula that was rewritten).

"appfn", if not NIL, should be a function from gwffs to booleans;
"function", if not NIL, should be a function from gwffs to gwffs.

Bidirectional rules are considered to "normally" work left-to-right, but
the user will be prompted if there is any ambiguity. (So, for example, 
APPLY-RRULE and UNAPPLY-RRULE are not distinguishable for a bidirectional 
rule, unless it has an associated function.)
The commands for manipulating these are:
MEXPRs:
 FETCH gets an rrule from the library.
 DELETE-RRULE deletes an rrule from TPS.
 LIST-RRULES lists the rrules currently in memory.
 MAKE-ABBREV-RRULE creates an rrule from an abbreviation (eg EQUIVS, above)
 MAKE-INVERSE-RRULE creates a new rule which is the inverse of an old rule.
 MAKE-THEORY creates a new theory, which can be saved in the library.
 PERMUTE-RRULES reorders the list of rrules in TPS.
 REWRITE-SUPP1 does one step of rewriting in an ND proof (see APPLY-ANY-RRULE)
 REWRITE-SUPP* does many steps in an ND proof (see APPLY-ANY-RRULE*)
 UNREWRITE-PLAN* and UNREWRITE-PLAN1 are the same but in the other direction.
 Because the last four can get confusing, we also have:
 SIMPLIFY-PLAN, SIMPLIFY-PLAN*, SIMPLIFY-SUPP and SIMPLIFY-SUPP* which 
  attempt to simplify a plan or support line assuming that the left-to-right
  direction is "simplification", and that the higher-numbered lines should
  always be rewrite instances of the lower-numbered lines.
  Now that we have bidirectional rules, this makes sense.
  All of the ND commands use active rules only. All rules are active when 
  first loaded/defined, and remain active until deactivated by the user.
 ACTIVATE-RULES and DEACTIVATE-RULES allow you to turn rules on and off.
 USE-THEORY activates all the rewrite rules in the given theory and deactivates
  all other rules. If the theory is unknown, TPS will attempt to load it from the library.
 USE-RRULES, and its associated wffop INSTANCE-OF-REWRITING, allow you to deduce 
 any wff B(O) from a wff A(O) provided that A rewrites to B *without* using any 
 overlapping (nested) rewrite rules. In particular, you can generate one wff from 
 the other in the editor, rewriting only those parts you want to rewrite.

EDOPS:
 ARR is the editor command which applies the first applicable rrule.
 ARR* does ARR until it terminates.
  (both of the above use active rules only)
 ARR1 applies a particular rrule once (in the editor).
 ARR1* applies the same rrule until it terminates (in the editor).
  (both of the above can use either active or inactive rules).
 MAKE-RRULE makes an rrule whose lhs is the current edwff.
 UNARR, UNARR*, UNARR1, UNARR1* are the
  editor commands which apply rrules in the reverse direction.
 (the wffops are still called things like APPLY-RRULE-ANY*, but now the 
 editor commands are easier to type).

Theories are simpler; they are basically just the name of the theory with 
a bunch of needed-objects attached. There is also a TPS object called a theory.
One simple use for theories is to save typing in the library; one can define
(for example) a theory GVB whose needed objects are all the axioms of GVB
set theory, and then FETCH GVB will load all of them at once. 
When theories are loaded into TPS, they also create an abbreviation of the same
name, which is basically the conjunction of the axioms, the universal
closure of the rewrite rules and the abbreviations representing any subtheories
given by the user. This allows the user to have sentences like 
"PA IMPLIES [[ONE PLUS ONE] = TWO]", if PA is a theory.
The only place where they are used is in USE-THEORY, as a way to switch on a
bunch of rrules all at once.

Rewrite rules live in a new module called "rrules", containing new files
edrew.lisp, ml2-rewrite.lisp, lib-objects2.lisp. Because of this, there
have been some minor changes to defpck.lisp, tps-compile.lisp, tps-build.lisp
library2.lisp and library1.lisp. Theories also belong in this module.

=======================================================================
MB		TRIVIALITIES					10th Dec 1996
etags is case-sensitive, so I've been through the files turning all the
upper-case function names into lower-case. rule-cmds.lisp has been changed
so that it puts an in-package command at the head of each file created by
assemble-file (the package is whatever package is associated with the module 
provided by the user).
=======================================================================
MB		ALLEGRO v4.3					13th Jan 1997
The necessary changes to compile TPS for Allegro v4.3 have been made
(they're all prefixed by a #+:allegro-v4.3). In particular, the memq 
function, which was predefined in v4.2 and earlier versions, was not defined 
in v4.3. Unfortunately, we still can't make tps-save work, due to changes in the 
keywords accepted by dumplisp, and so there is no working core image yet.
Changed: tops20.lisp, boot0.lisp.
=======================================================================
MB		MODE and SAVEPROOF				15th Jan 1997
MODE was only fetching objects of type MODE1; now it fetches MODEs too.
There was a minor bug in saveproof that prevented certain dproofs from 
being saved.
Changed: saveproof.lisp, lib-bug.lisp, flagging.lisp
=======================================================================
HW		MEDIAN in GRADER				23rd Jan 1997
Grader was calculating the median incorrectly.
Changed: grades2.lisp
=======================================================================
MB		ALLEGRO v4.3					23rd Jan 1997
We can evade the problem with dumplisp by specifying a form to be evaluated
in the startup line for ETPS. In particular, add:   -e "(secondary-top-main)"
to the appropriate line in the "etps" file.
Changed: $etps/sun4_55/etps
=======================================================================
MB		REWRITE-DEFNS TRANSLATIONS			3rd Feb 1997
Translations of proofs of THM250B and THM250D were failing because of
a bug in rewrite-defns (basically, lambda-rewrites can be inserted between
definitional rewrites and the conjunctions that they become, and TPS was assuming
that this can't happen). REWRITE-DEFNS was reimplemented to avoid this.
Changed: etrees-wffops.lisp, mating-merge.lisp, mating-merge-eq.lisp
=======================================================================
MB		REWRITE-DEFNS AGAIN				6th Feb 1997
A minor bug: REWRITE-DEFNS LAZY2 was assuming that there would be at least one 
rewrite.
Changed: etrees-wffops.lisp, mating-merge.lisp, mating-merge-eq.lisp
=======================================================================
MB		LIBRARY						7th Feb 1997
The check for subdirectories of the library directories has been speeded up.
DATEREC now puts new files in the library directory, rather than the user's
home directory.
Changed: library2.lisp, lib-ops.lisp
=======================================================================
MB		TRIVIALITIES					10th Feb 1997
TeX mode defined union to be \cap, instead of \cup; this is now fixed.
VPform literals are now printed in numerical rather than alphabetical order.
Changed: texchr.lisp, vpforms.lisp
=======================================================================
MB		ORDER-COMPONENTS				10th Feb 1997
Order-components T and T-REVERSED, in path-focused duplication, only sorted
the top-level conjuncts. Now it behaves like the MS88 version.
Changed: order-components.lisp
=======================================================================
MB		BANNED CONNECTIONS				10th Feb 1997
TPS now bans connections between a definition and the literals to which it 
rewrites.
Changed: ms90-3-path-enum.lisp, mating-top.lisp, unif-mat.lisp, ms90-3-top.lisp
=======================================================================
MB		COPY-LIBFILE and SORT				10th Feb 1997
SORT was losing newly-copied library objects, due to a bug in 
delete-item-from-masterindex.
Changed: lib-ops.lisp
=======================================================================
MB		SHALLOW-MERGE					17th Feb 1997
Some changes have been made to shallow-merge in the file mating-merge.lisp;
it was assuming that the rewrite nodes are always near the top of the etree,
which isn't true with REWRITE-DEFNS LAZY2.
=======================================================================
MB		GRADER						18th Feb 1997
GRADER wasn't initializing *default-pathname-defaults* correctly.
Changed: tps3-save.lisp
=======================================================================
MB		ORDER-COMPONENTS				20th Feb 1997
I introduced a new setting for ORDER-COMPONENTS, PREFER-RIGID3. It's just 
like PREFER-RIGID2 but keeps the definitional rewrite leaves above their
expanded definitions. This revealed another bug in mating-merge-eq, which
was easily fixed.
Changed: order-components.lisp, mating-merge-eq.lisp
=======================================================================
MB		UNIFICATION TIMING				22nd Feb 1997
Changed various files (most notably timing.lisp; all the other changes are of 
the form (breakcount 'unification) or similar) to allow for unification to
be timed independently of mating-search.
=======================================================================
MB		TEXPROOF					27th Feb 1997
Style tex assumed that any FACE of the form SUBfoo meant "print foo as a 
subscript". In fact, this is only true of SUB when it is followed by a digit,
a backslash or a space. 
Changed: deftex.lisp
=======================================================================
MB		SCRIBEPROOF					27th Feb 1997
I've altered SCRIBEPROOF so that it can print timings, like TEXPROOF.
Changed: timing.lisp, otl-scribeout.lisp
=======================================================================
MB		UNIFY TOP LEVEL					13th Mar 1997
The bug in MS88 unification hes been fixed. I've also changed the library
functions for storing dpairsets so that they can store the free variables
of the dpairset as well, and changed UNIF-PROBLEM so that it will offer
to search the library if the dpairset you ask for isn't already loaded.

The MS88 problem was due to elimination substitutions of the form <v . t> where
v is a variable. Since TPS only creates these substitutions if RIGID-PATH-CK 
is T, the problem only occurred in this case.
The head-normal-form function was applying these substitutions as necessary,
but assuming that their bound variables had not already been bound in the
term (all other substitutions are created with fresh bound variables, so 
they can't cause problems). The solution is to alpha-convert such substitutions
whenever they are used, so that this assumption will be true. Since we only
ever check equivalence of wffs up to alpha-conversion, this fix can't cause 
any problems.
Changed: lib-objects.lisp, unif-user.lisp, unif-lambda.lisp, unif-simpl.lisp
=======================================================================
MB		UNIFY TOP LEVEL					14th Mar 1997
TPS can now time the unification searches in the UNIFY top level.
Changed: unif-user.lisp, timing.lisp
=======================================================================
MB		UNIFORM-SEARCH					17th Mar 1997
A searchlist can now accept an optional function, which will be called on 
every iteration of the search. This allows the settings of some flags to 
depend on the current settings of the flags in the searchlist (in fact, it 
allows a lot more than that).
Changed: test-top-*.lisp, mating-dir.lisp
=======================================================================
MB		UNIFORM-SEARCH					19th Mar 1997
UNIFORM-SEARCH-2 has been changed in order to keep the number of searches 
to a minimum (while still covering all of the search spaces that were 
previously covered), and to vary the most useful flags first.
Minor bugs in order-components.lisp and test-top-top.lisp have been fixed.
In the interests of making uniform search easier, there is a new
mexpr UNIFORM-SEARCH, which enters the test top level with a given gwff,
mode and searchlist.
Changed: test-top-top.lisp, auto.exp, order-components.lisp,
test-top-search.lisp
=======================================================================
MB		TEST-TOP MERGING				19th Mar 1997
Now TEST behaves like MATE, in that you'll be prompted to merge the etree if 
you leave after completing a proof, and the resulting merged tree can be translated 
into a ND proof. I also found the bugs in etrees-wffops that were causing 
MS91 to go around in circles sometimes (endlessly garbage-collecting instead
of constructing new option sets).
Changed: test-top-top.lisp, test-top-search.lisp, etrees-wffops.lisp
=======================================================================
MB		LIBRARY						2nd Apr 1997
SHOW-WFF and SHOW-WFF&HELP now work on abbrs as well as gwffs.
Changed: library1.lisp
=======================================================================
MB		MODIFY SEARCHLIST				2nd Apr 1997
I've made uniform-search a bit better by adding an option like:
MODIFY (YESNO): Automatically modify searchlist? [Yes]>
which will edit down the searchlist (creating a new searchlist as it does so)
to adapt it for the cases:
1) the given wff is first-order (no point varying unification depths)
2) the given wff contains no definitions (no point varying REWRITE-DEFNS)
3) the given wff has no applicable primsubs (change DEFAULT-MS to vary only
   between MS88 and MS90-3; remove MAX-SEARCH-LIMIT etc.)
There is a possible fourth case -- the given wff has no universal quantifiers,
so forget NUM-OF-DUPS -- but I haven't implemented it because we so rarely see
such a wff.
The new searchlist will have the same name as the old one, with some 
combination of F,D and P (the three cases above, respectively) appended to it.
Changed: test-top-top, test-top-search
=======================================================================
MB		HELP-GROUP					3rd Apr 1997
HELP-GROUP now doesn't print out the same information many times. 
It can also accept a list of arguments, which it interprets as "the 
intersection of all these things", so 
HELP-GROUP REWRITING works as before, but
HELP-GROUP REWRITING MEXPR shows all the mexprs in context REWRITING, and
HELP-GROUP REWRITING SRULE shows all the rewriting ND rules, and so on.
It also now gives the output in alphabetical order.
Changed: mhelp.lisp
=======================================================================
MB		INTERRUPT HANDLING				4th Apr 1997
I've added an extra interrupt to TPS. Now you can type
t<RETURN> or T<RETURN> and mating search will print out the time taken so 
far, without stopping the search.
Changed: mating-dir.lisp
=======================================================================
MB		MODIFY SEARCHLIST				7th Apr 1997
I've changed the modification procedure of UNIFORM-SEARCH so that
it checks for the presence of equalities, and for equalities of types 
such that the LEIBNIZ and ALL instantiations are different. It will,
if necessary, delete REWRITE-EQUALITIES from the searchlist or remove
LEIBNIZ as a possible value for REWRITE-EQUALITIES. (In addition to 
the old labels P,F and D (see 2nd Apr, above), the new searchlist
will be labelled E if the gwff contains no equalities, and L if it 
contains equalities but LEIBNIZ and ALL give the same result.)
Changed: test-top-top.lisp, test-top-search.lisp
=======================================================================
MB		EQUIV-EQ-*					7th Apr 1997
EQUIV-EQ-EXPD used to ignore the setting of REWRITE-EQUALITIES.
On inspection, this was because there were two REWRITE-EQUALITIES flags,
one in core and one in auto.
Changed: etrees-flags.lisp, core.exp, auto.exp
=======================================================================
MB		DUPLICATE VARIABLES				9th Apr 1997
Given the above, I went looking for duplicated definitions of variables and flags;
there were many (almost all of them harmless). I also changed a lot of other 
things while I was doing it.
There is a snapshot of the entire lisp directory, before any of this was done,
at old-files/lispfiles-tar-7apr97 ; you can retrieve individual files foo1.lisp, foo2.lisp,...
from this tar file by going to that directory and typing:
tar xvf lispfiles-tar-7apr97 lispfiles/foo1.lisp lispfiles/foo2.lisp ...
(this will create a subdirectory lispfiles, containing the chosen files)
You can also type tar tf lispfiles-tar-7apr97 to get a list of the files archived.

The other changed things were:
Subjects have been given their own files (subjects-core, subjects-auto, etc)
which are loaded early on. Types are now also defined in their own files:
argtyp, argtyp-auto and argtyp-maint (so few types are defined by ML
and TEACHER that it didn't seem worth creating files for them). 

A few leftover export commands have been moved to *.exp, where they belong.
Many (eval-when) commands have been removed, which should make compilation
a little faster. The macro commands add-flags-to-ms* have been removed in 
favour of actually adding the required subjects to the definition of the flags;
again, this should speed up compilation a little.

LOAD-WARN-P has been switch off by default; this will remove warnings from
TPS that would otherwise be written into the .log file during building
(these are things like "FOO is being defined as a MATEOP and EDOP"). 
Warnings that come from lisp, which are generally important, will still be 
issued.
Changed: many files!
=======================================================================
MB		FACE						15th Apr 1997
Typing ? and ?? into the prompt for FACE (when saving a library abbrev)
now gives useful information.
Changed: lib-objects.lisp
=======================================================================
MB		DEEPENING ETREES				16th Apr 1997
When etrees were deepened, equalities were never instantiated unless
they rose to the top of a formula (for example, TTTP5311A had one leaf that
contained ~ q . IOTA [= y] ).
Changed: etrees-exp-vars.lisp, etrees-skolem.lisp, etrees-wffops.lisp,
etrees-wffops2.lisp
[This change was removed on 4/29/97, because it confuses REMOVE-LEIBNIZ.]
=======================================================================
MB		TEST DEFAULT MODE				17th Apr 1997
The mode created by TEST now includes all relevant flags (not just those in 
the searchlist), and has a useful default name (not TEST-BESTMODE).
Changed: test-top-search.lisp, test-top-top.lisp
=======================================================================
MB		UNIFORM-SEARCH-L				21st Apr 1997
I've defined UNIFORM-SEARCH-L, which is analogous to DIY-L; it takes a planned
line, a list of support lines, a line range for the new lines and most of the
arguments needed for UNIFORM-SEARCH, and attempts to prove the lemma using 
UNIFORM-SEARCH.
Changed: maint.lisp, test-top-top.lisp, test-top-search.lisp
=======================================================================
MB		QUERY-SLISTS					24th Apr 1997
The various bugs in UNIFORM-SEARCH relating to the "modify searchlist" option
have been fixed, and QUERY-USER now accepts a new setting QUERY-SLISTS
which will stop before each searchlist.
Changed: argtyp-auto.lisp, etrees-flags.lisp, test-top-search.lisp, 
test-top-top.lisp, test-top-slists.lisp
=======================================================================
MB		PRIMSUBS PR97					29th Apr 1997
Setting PRIMSUB-METHOD PR97 now gets you substitutions corresponding to 
all of the useful subformulas in the current etree.
I've also added a flag PRIMSUB-VAR-SELECT that allows one to make primsubs
for variables that do not occur both positively and negatively at the head
of a formula.
Changed: cnf.lisp, prim.lisp, etrees-wffops.lisp, mating-aux.lisp
=======================================================================
MB		UNIFORM-SEARCH-L				30th Apr 1997
Fixed a minor bug about loading gwffs in UNIFORM-SEARCH-L.
Changed: maint.lisp, test-top-top.lisp
=======================================================================
MB		PRIMSUBS					1st May 1997
NAME-PRIM now pays attention to PRIM-BDTYPES-AUTO.
Changed: prim-edops.lisp, prim.lisp
=======================================================================
MB		PRIMSUBS PR97					2nd May 1997
I've made a small generalisation to PR97; it will now produce all the extra
primsubs that can be formed by collapsing the primsubs it used to form.
For example, if it produces a primsub 
A AND B IMPLIES . [C = D] OR E
then you will also get 
A' IMPLIES . [C = D] OR E
A AND B IMPLIES . C' OR E
A AND B IMPLIES C''
A' IMPLIES C''
Changed: prim.lisp
=======================================================================
MB		FINDPROOF					5th May 1997
New command: FINDPROOF looks through all the directories in SOURCE-PATH, and
your home directory, looking for a proof whose name contains the given string. 
Changed: saveproof.lisp
=======================================================================
MB		LIBRARY						6th May 1997
The commands SCRIBELIBDIR and TEXLIBDIR have been implemented.
The command FIND-PROVABLE has been made more flexible; it now accepts a 
list of provability statuses, and returns all the gwffs having any of those
provabilities. (The old version could only take a single status at a time.)
Also, a minor bug in DATEREC has been fixed: in the case where no record
existed in the library, it wasn't asking for a new provability status before
saving the record.
Changed: lib-ops.lisp, library1.lisp, library2.lisp, lib-objects2.lisp,
test-top-lib.lisp, argtyp.lisp
=======================================================================
MB		SIEG, TAIT, CPK-PRIMITIVE-SUBST			13th May 1997
Commented out all of the above modules from defpck, and put the contexts-{sieg,tait}.lisp
and {sieg,tait}.exp files into the old-source/old-rules-packages/ directory.
(No idea where the actual lisp files have gone; they seem to have been lost
some time prior to 1991. If we find them, just uncomment the packages in defpck
and move the contexts-* and *exp files back into the lisp directory.)
Changed: defpck.lisp
=======================================================================
MB		HELP output					13th May 1997
SHORT-HELP T now suppresses the "command format is..." information
when you type HELP. (Previously it only affected help for rules.)
ALPHA-LOWER-FLAG T alphabetises the output of ?, and puts it
into lower case. It also affects the output of HELP when multiple objects
are returned (try HELP GO for an example). Setting it to NIL reverts to the
old output style. This change also affects LIST-RULES.
Also, ? now pays attention to LEFTMARGIN and RIGHTMARGIN.
Changed: gensty.lisp, mhelp.lisp, test-top-top.lisp, otl-help.lisp
unif-macros.lisp, library1.lisp
=======================================================================
MB		CHANGED-FLAGS					14th May 1997
This new command lists all the flags whose values are not the default value.
Changed: review.lisp
=======================================================================
MB		??						14th May 1997
This command gives help on history substitution and command completion.
Changed: mhelp.lisp
=======================================================================
MB		COMMAND COMPLETION				14th May 1997
Command completion can now be done with @ as well as <Esc>, since <Esc>
removes the two next characters from the line. Now you can complete a command
and provide its arguments all on one line. Also, if no completions can
be found on the current top level, it will try the main top level instead.

Implemented the flag COMPLETION-OPTIONS; see the help message for details.
The ETPS manual has been updated to mention this.
Also, command completion now works in lines with multiple commands.
Changed: linereadp.lisp
=======================================================================
MB		OOPS						15th May 1997
Implemented the OOPS command.
Changed: mhelp.lisp
=======================================================================
MB		PR97 / MS91-* changes				16th May 1997
PR97 now sorts primsubs by the number of quantifiers, and then by the number 
of literals (previously it only sorted by number of literals).
To speed up the construction of option sets in MS91-*, there are two changes:
 - It applies the primsubs from the bottom of the etree upwards rather than 
   from the top downwards (a change to the function make-higher-order-options only)
 - It deepens only one step while generating the options, and only deepens fully
   when it actually considers an option set.
Changed: ms91-search.lisp, ms91-basic.lisp
=======================================================================
MB		TPSLISP directory				16th May 1997
A general cleanup of the tpslisp directory; removed ~ files, and then:
Created tpslib/old-lib/ and moved all the thmsn.lisp and newsthmsn.lisp files into it.
Moved mcrtest.lisp and ctxt.lisp to old-source/obsolete/ (they're replaced by boot1.lisp).
Moved psgraph.* to tps/tps/elisp/ (it's not part of TPS).
Moved mat-pro-*, the link to profile.lisp and the directory ms2d/ to tps/tps/unfinished/
Removed heading.lisp (both obsolete and unnecessary)
Moved installfiles to old-source/installfiles-1993.
=======================================================================
MB		LIBRARY						22nd May 1997
FIX-MODES will now change all of the settings of RECORDFLAGS in your library
so that LAST-MODE-NAME occurs first in all of them.
SHOW-TIMING now also shows the setting of LAST-MODE-NAME, if there is one.
Changed: lib-ops.lisp, library2.lisp
=======================================================================
MB		PR97A/B						22nd May 1997
Implemented PR97A/B.
Changed: prim.lisp
=======================================================================
MB		MS91-INTERLEAVE					23rd May 1997
Introduced new flag to speed up primsub search by not applying all 
primsubs at once.
Changed: ms91-basic.lisp, ms91-search.lisp
=======================================================================
MB		TPS-TEST					27th May 1997
Fixed minor bug that was crashing tps-test when an exercise appeared in
TEST-THEOREMS.
Changed: maint.lisp
=======================================================================
MB		SHOW-ALL-WFFS					28th May 1997
Added the "filter" option to SHOW-ALL-WFFS, and made the function robust
enough to ignore badly-defined libobjects.
Changed: lib-ops.lisp, library1.lisp, library2.lisp
=======================================================================
MB		SCRIBELIBDIR/TEXLIBDIR				28th May 1997
These commands can now be restricted to just objects of a given type (or
types). The first file is now labelled in the same way as the subsequent files;
also, one can now start a new page with each new file.
Changed: library1.lisp
=======================================================================
MB		SCRIBE-ALL-WFFS/TEX-ALL-WFFS			28th May 1997
Fixed up variants of SHOW-ALL-WFFS that create Scribe or Tex files instead
of screen output.
Changed: library1.lisp
=======================================================================
MB		AUTO-SUGGEST					29th May 1997
The new command AUTO-SUGGEST, given a completed ND proof, makes 
intelligent suggestions about how to set the flags for an automatic proof
of the same theorem. I've made UNIFORM-SEARCH use its suggestions:
if you have a ND proof of the relevant theorem in memory, and you opt to
automatically modify the searchlist, it will ask whether you also want
to use the suggestions generated by AUTO-SUGGEST.
Changed: nat-etr.lisp, test-top-top.lisp
=======================================================================
MB		SCRIBE-ALL-WFFS/ ELIM-DEFNS			29th May 1997
In SCRIBE-ALL-WFFS, we now distinguish FIRST-ORDER and SK-FIRST-ORDER (and
similarly for HIGHER-ORDER); the help message explains the difference, and 
also explains about the effect of REWRITE-EQUALITIES.
A new flag, ELIM-DEFNS, allows all definitions to be eliminated from 
all printed formulas (everywhere, including SCRIBE-ALL-WFFS in particular).
Changed: library1.lisp, prt.lisp
=======================================================================
MB		AUTO-SUGGEST					2nd Jun 1997
1) If any lines are justified by ASSERT of anything but REFL= or SYM=,
AUTO-SUGGEST stops and reports that TPS cannot generate this proof of the
theorem. This also happens if any line is justified by a rewrite rule.

2) Substitution of equality confuses the results (since we can only do that
in ND proofs), so now if it finds any lines justified by "Sub=" or "Sym="
it will offer to re-prove them without using substitution. In most cases,
this will be easy, although the proof can in theory require very deep 
primsubs. (This part of the code uses AUTO-SUGGEST on the relevant 
fragment of the proof in order to set the flags.)

3) It now discovers the correct setting of REWRITE-DEFNS, and will use
this setting on entering UNIFORM-SEARCH.
Changed: nat-etr.lisp, test-top-top.lisp
=======================================================================
MB		INSERT						2nd Jun 1997
INSERT now behaves properly with modes that already exist in TPS (which
you can save as either MODEs or MODE1s -- it makes no difference).
Changed: test-top-lib.lisp, lib-objects.lisp
=======================================================================
MB		HELP MESSAGES					3rd Jun 1997
I've added a new category, called INFO, which consists of objects
that only have help messages. Also, all aliases are now defined as INFO objects, 
so they now have help messages.
Changed: boot0.lisp (for DEFINFO), linereadp.lisp (for the ALIAS help messages),
many other files, most of them trivially. 
=======================================================================
MB		ORDER-COMPONENTS				4th Jun 1997
Fixed a minor bug that was preventing translation of THM25 with ORDER-COMPONENTS T.
Changed: order-components.lisp
=======================================================================
MB		TPS-TEST					4th Jun 1997
You now have the option to stop and change provability status or not
during tps-test.
Changed: maint.lisp, library1.lisp
=======================================================================
MB		MORE HELP 					4th Jun 1997
Typing a TPS symbol which is not a command will now produce the help 
message for that symbol (if there is one), instead of the message 
";FOO - Unbound variable." 
Changed: most of the command-interpreters.
=======================================================================
MB		ADD-FLAG-TO-MODE				6th Jun 1997
There are three new commands in the review top level:
COPY-MODE copies a mode (renaming it as it does so); the old mode can be 
removed by using DESTROY.
ADD-FLAG-TO-MODE is self-explanatory, as is REMOVE-FLAG-FROM-MODE.
Changed: review.lisp
=======================================================================
MB		RENAME LIBOBJECT				6th Jun 1997
There is now a command to rename a library object.
Changed: library2.lisp
=======================================================================
MB		AUTO-SUGGEST					6th Jun 1997
AUTO-SUGGEST now works out whether PR97 can produce the required primsubs, 
and offers to make a mode for you. It can also now recognise that PR97B 
might be a better choice if PR97 can generate some but not all of the primsubs
required. Also, it now makes a better guess about MAX-SUBSTS-VAR, by taking
the size of the skolem terms into account.
Changed: nat-etr.lisp
=======================================================================
MB		DIY-L bug / TPS-TEST output			6th Jun 1997
The bug with DIY-L on THM120B has been fixed (lines were in the wrong order).
Also, tps-test now renames its old files to tps-test-output.doc.bak and
info.test.bak.
Changed: maint.lisp, test-top-search.lisp, diy.lisp
=======================================================================
MB		ADD-TRUTH					8th Jun 1997
A new flag, ADD-TRUTH, can conjoin a TRUTH and a NOT FALSEHOOD to every 
etree. If set to T, it will always do this, if NIL then it never will,
and if IF-NEEDED it will do this only when there is a path of length 1
through the vpform. By default, it is set to IF-NEEDED.
(Also, if TRUTHVALUES-HACK is T, then it omits the NOT FALSEHOOD since 
this will just become another TRUTH.)
Changed: diy.lisp, etrees-wffops.lisp, mating-merge.lisp, ms91-search.lisp
         test-top-top.lisp
=======================================================================
MB		TEX output					10th Jun 1997
I've changed deftex.lisp and otl-scribeout.lisp so that when TEX
prints abbreviation names like TRANSITIVE, they come out in roman font
instead of italic, and followed by a space.
=======================================================================
MB		SHOW-TIMING					18th Jun 1997
There's been a minor fix of SHOW-TIMING (it was crashing on some examples).
Changed lib-ops.lisp.
=======================================================================
MB 		ALLEGRO 4.3					1st Jul 1997
Fixed tps3-save so allegro-v4.3 version of tps3 will start up properly.
Changed tops20.lisp
=======================================================================
MB		ALLEGRO 4.3 AGAIN				7th July 1997
Attempts to make the allegro 4.3 version on norfolk.cis.upenn.edu work properly
(these changes failed to do the job, but have been left in TPS anyway):

Updated all of the printing routines for etrees and other structures, so that
none of them uses the TPS macro msg. I still don't understand why this is 
necessary, but it works.

Declared special almost all of the undeclared variables that TPS complains
about. Removed all of the variables which it complains are never used (except
for those which should be declared special).

Switched off the WARNING: FOO is defined as an EDOP and a MATEOP
messages that TPS prints during compilation.

The functions MATED-P*, NAME-SKOLEM-CAP, LISTIFY-TYPE, PREFIX-LAMBDA,
CREATE-NEW-W-VARS, ETREE-TO-JFORM-REC, PW and PWSCOPE were defined twice, and 
are now defined only once.
The variables ETA-VAR-PREFIX, INITIAL-VALUE-H-VAR-COUNTER, 
INITIAL-VALUE-ETA-VAR-COUNTER and GLOBAL-IRULELIST were defined twice, for no 
particular reason. (GLOBAL-IRULELIST was the global list for two different 
categories, which is silly.)
NAT-ETREE was defined twice (old version and new version); the old version
has now been renamed to NAT-ETREE-OLD and is available in TPS if you want it.
=======================================================================
MB		ALLEGRO 4.3 AGAIN				7th Jul 1997
One more change -- some of the macro definitions in otl-macros.lisp are
being used before they're defined, which makes cmulisp complain:
Warning: Defining {LINE-HYPOTHESES, LINE-ASSERTION, PROOF-PLANS} to be a 
macro when it was assumed to be a function.

I've copied all of these to boot0.lisp (which isn't where they belong, but
it solves the problem for now; when I get back, I'll find out *where* the 
macros are being used before they're defined and fix this properly). 

I also exported *ignore-statuses* from the auto package, and PLANS and
LINEALIASES from the core package.

These changes don't fix any of the bugs with Allegro 4.3...
=======================================================================
MB		PAUSE						11th Aug 1997
There is a new mexpr, PAUSE, whose sole function is to ask the user to press
RETURN or ^G-RETURN. This mexpr can also be given in response to a prompt,
in which case the same message is displayed, and after the user presses 
return, the expected response to the prompt can be given.

When running a workfile in single-step mode, there will be prompts between
every command on the original top level, and at every instance of PAUSE.
When running in non-single-step mode, there will still be prompts at
every instance of PAUSE.

If an old workfile needs to be made to stop at a particular point, insert a
new line containing the single word PAUSE at the appropriate place in the 
file.

(13th Aug: Added a facility to PAUSE quietly while single-stepping through
a file.)

Changed: tpstop.lisp, save-work.lisp
=======================================================================
MB		DIY-L						13th Aug 1997
DIY-L now calls cleanup-same, and updates the proofwindows.
Changed: diy.lisp
=======================================================================
MB		IMP-DISJ, etc					25th Aug 1997
There are 4 new ND commands: IMP-DISJ-L, IMP-DISJ-R, DISJ-IMP-L and DISJ-IMP-R.
In all cases, the disjunction required is of the form L OR R, and the L or R
in the command refers to which of the disjuncts becomes the antecedent of the
implication (so, for example, DISJ-IMP-R changes "L OR R" to "~R IMPLIES L").
Changed: ml2-hacks.lisp, ml2-hacks.rules
=======================================================================
MB		USE-DIY						25th Aug 1997
Implemented USE-DIY.
Changed: diy.lisp, test-top-top.lisp.
=======================================================================
MB		LATEX-EMULATION					28th Aug 1997
Added the flags LATEX-EMULATION, LATEX-PREAMBLE, LATEX-POSTAMBLE, VPDTEX.
New LaTeX style file tps.sty; change to .tpsrc so that TEXINPUTS is set 
correctly to find it. Fixed bug in timing so that we can have more than
one timing output in a file (eg for SCRIPT). Changed the print-line function
for style TEX into that for TEX-1 (the original printed TAB characters,
which were never useful since they were never defined). Moved the settings
of all the TEX-related flags into the .ini file, since they refer to local files.
Removed subscripting of leaf numbers in TeX vpforms, and fixed bug that 
was making SCRIPT crash in style TEX.
Changed:.tpsrc, library1.lisp, otl-scribeout.lisp, vpforms.lisp, vpforms-tex.lisp,
deftex.lisp, save-work.lisp, timing.lisp, tps3.ini
New: tps/doc/lib/tps.sty
=======================================================================
MB		-problem switch					3rd Sep 1997
Added the switches -problem, -mode, -slist, -record (See programmer's manual re
"batch mode".)
Changed: tps3-save.lisp, test-top-top.lisp
=======================================================================
MB		Grader bug					17th Sep 1997
RESUME-INSERT-GRADES used to cause the column of grades to be duplicated.
Changed: grades1.lisp
=======================================================================
MB		logictex.bib					7th Oct 1997
Created bibliography file for TeX/LaTeX; rearranged the proofs directory 
to put actual proofs into some subdirectories and other stuff elsewhere.
=======================================================================
MB		PR97C						7th Oct 1997
Introduced PRIMSUB-METHOD PR97C. There are two new flags, PR97C-PRENEX 
(default T) and PR97C-MAX-ABBREVS (default 1).
There have also been changes to LAZY2 instantiation when primsubs are 
introduced. (We were implicitly assuming that introducing a primsub will
only affect the etree by deepening some leaves, but will not change the
inner structure. This isn't true, and it may be why we were having trouble
proving theorems with LAZY2 instantiation and LAZY2 primsubs...)
Changed: prim.lisp, etrees-wffops.lisp, etrees-wffops2.lisp,
ms91-basic.lisp, ms90-3-expand-etree.lisp, mating-merge.lisp
=======================================================================
MB		LUCID SUBDIRECTORIES				13th Oct 1997				
I've added a comment to the flag ADD-SUBDIRECTORIES to the effect that it
doesn't work for Lucid CL, and changed lib-ops.lisp so that it won't try 
to check for subdirectories in LCL.
=======================================================================
MB		DISCOVERING ABBREVIATIONS			14th Oct 1997
A small change to mating-merge.lisp allows TPS to search for potential 
abbreviations (after merging).
Changed: mating-merge.lisp
=======================================================================
MB		VPD-BRIEF					15th Oct 1997
vpplab and vppcent get labelled and centered VPDs, and vpplc gets a centered and
labelled VPD (in the style of the IDS paper). The code works for TeX and LaTeX.
I've added vpdlc and hpdlc to correspond to the TEXFORMAT settings 
of VPD and HPP (which we almost never use in TPS).
When a VPD is printed out in TeX (or LaTeX) format, it will begin and 
end with \beginvpp and \endvpp. The new commands are \beginvppcent, \beginvpplab
and \beginvpplc (and their corresponding \end... commands).
Labels are generates automatically by the \p and \n commands that signal 
a positive or negative literal. To override the automatic labelling and
change the label to N, use \p[N] or \n[N].
To print a label outside of a vpform, use \fb[N] (it's derived from 
"\framebox"; hence the name). To print a connection, use \conn{1}{2}.

I've defined VPD-BRIEF B (for "boxes"); it makes the output from VPT 
use \beginvpplc, and it also prints the current mating on the same page.
VPD-BRIEF BT prints the boxed labels (like VPD-BRIEF B) and prints a 
list of wffs underneath the vpform. It also prints the current mating. 
This results in as narrow a vpform as you can reasonably hope for.

Also, VPFORM-TEX-MAGNIFICATION has been changed: it used to take values 
like 0=10pt, 1=12pt, and so on. It still accepts those values, but now
it regards all values larger than 10 as being TeX magnifications (which
are based at 1000=10pt, 800=80%, 1200=120% and so on). This gives us the 
chance to shrink below 10pt text and so squeeze more on a page.

I've changed the default VPFORM-TEX-PREAMBLE, and the default 
VPFORM-TEX-MAGNIFICATION is now 1000.
Also, I fixed the TeX output to use \hbox{foo } instead of {\rm\ foo\ };
this results in better-looking roman text.

Changed: vpd.tex, vpforms-tex.lisp, argtyp.lisp, deftex.lisp
=======================================================================
MB		DUAL						17th Oct 1997
Added DUAL as a synonym for LAZY2.
Changed: 
argtyp-auto.lisp       etrees-wffops.lisp     order-components.lisp
argtyp.lisp            etrees-wffops2.lisp    test-top-search.lisp
core.exp               mating-merge-eq.lisp   test-top-top.lisp
etrees-flags.lisp      mating-merge.lisp      wffabb2.lisp
=======================================================================
MB		SKOLEM-DEFAULT 					5th Nov 1997
Fixed the flag settings SKOLEM-DEFAULT SK3 and NIL so that they work.
The major changes are in ms90-3, where expand-etree has been essentially replaced
by a different procedure for the case SKOLEM-DEFAULT NIL. Also unification has been
changed to test for the acyclic condition in Miller's thesis. There are probably still
some bugs, but not nearly as many as before...
Changed:
etrees-exp-vars.lisp, ms90-3-expand-etree.lisp, etrees-jforms.lisp, ms90-3-top.lisp,
etrees-renumber.lisp, ms90-3-unif-fo.lisp, etrees-wffops.lisp, ms90-3-unif-simpl.lisp,
jforms-labels.lisp, ms90-3-unif-tree.lisp, mating-merge-eq.lisp, unif-fo.lisp,
mating-merge.lisp, unif-simpl.lisp
=======================================================================
MB		DUAL INSTANTIATION				5th Nov 1997
We need to redo dual instantiation after applying a primsub, because the 
uninstantiated leaves will be wrong. My previous fix for this was buggy, 
and I've replaced it with a corrected version.
Changed: etrees-wffops.lisp
=======================================================================
MB		SKOLEM-DEFAULT NIL				7th Nov 1997
The various bugs in the new skolemization procedures have been fixed.
(This includes a bug with ms90-3 and NUM-OF-DUPS >1 ; we now keep a chain 
of duplications using the universal-dup slot of a universal jform)
Changed: ms90-3-expand-etree.lisp, ms90-3-top.lisp
=======================================================================
MB		TEST-MODIFY					10th Nov 1997
There is a new flag, TEST-MODIFY, which behaves exactly like an alias;
it accepts a string, which can be evaluated as a sequence of LISP commands
immediately before each proof in tps-test. A new prompt in tps-test allows 
you to decide whether or not to use this feature. It defaults to "no".
Changed: maint.lisp
=======================================================================
MB		MS91-INTERLEAVE					10th Nov 1997
MS91 searches now automatically reduce NEW-OPTION-SET-LIMIT to 
(* MS91-INTERLEAVE (#of primsubbable vars)) if it is greater than this value.
See the help message for MS91-INTERLEAVE for details.
Changed: ms91-search.lisp
=======================================================================
MB		VARIABLE REINIT					11th Nov 1997
Variable superscripts can now be reinitialised between calls to MATE.
Changed: mating-top.lisp, option-tree-aux.lisp, mtree-top.lisp
=======================================================================
MB		ETD fix						28th Jan 1998
ETP wasn't displaying the rewrite at rewrite nodes (as ETD does).
auto::merge-debug can now be NIL, T or 'ETD
Changed: etrees-print.lisp, mating-merge.lisp
=======================================================================
MB		DUAL REWRITES again				29th Jan 1998
A mysterious bug in proving THM250 was traced to the reconstruct-dual-rewrites-after-primsubs 
routine, which was running amok while ms90-3 was reconstructing the etree, producing 
new and unwanted expansion nodes. It's now controlled by a new internal 
variable *after-primsub*, which is set immediately after a primsub is done
and cleared as soon as the resulting etree is deepened; dual rewrites
are only reconstructed when it's set.
Changed: etrees-wffops.lisp, etrees-wffops2.lisp, ms91-basic.lisp,
ms90-3-unif-tree.lisp
=======================================================================
MB		PRINTTYPES-ALL					3rd Feb 1998
Implemented the new flag above.
Changed: prt.lisp, wffout.lisp
=======================================================================
CEB		PBRIEF etc						19th Feb 1998
New commands PBRIEF, EXPLAIN, PRINT-PROOF-HIERARCHY, BUILD-PROOF-HIERARCHY
Installed pbrief.lisp.
=======================================================================
MB		REWRITE-EQUIVS					26th Feb 1998
Added new flag REWRITE-EQUIVS.
Changed: cnf.lisp, mating-top.lisp, test-top-top.lisp, nat-etr.lisp, mating-merge-eq.lisp
=======================================================================
MB		FO-SINGLE-SYMBOL				5th Mar 1998
Changed default for FO-SINGLE-SYMBOL (in library INSERT command)
to T.
Changed: lib-objects.lisp
=======================================================================
MB		SKOLEM-DEFAULT NIL				10th Mar 1998
The code for SKOLEM-DEFAULT NIL was wrong for expansion variables 
introduced by primitive substitions (specifically, it wasn't banning 
any substitutions for those variables).
Changed: etrees-renumber.lisp
=======================================================================
MB		Allegro 4.3 BUGS				20th Mar 1998
All of the following searches failed in ACL 4.3
Prove X2112 in the default startup mode with ms90-3.
THM131 in mode MODE-THM131-MSV-A crashes during PRUNE-UNMATED-REWRITES -- 4.3 only (Linux & Sun both) 4.2 OK
Also THM104 in MODE-THM104-MSV (4.3 only, Linux & Sun) 4.2 OK (all right if REMOVE-LEIBNIZ NIL)
Also X5200 in MODE-X5200-MSQ (4.3, Linux & Sun) 4.2 OK (Illegal extra hypotheses in conclusion: (3).)
Also X5304 in MODE-X5304-MSQ (4.3, Linux & Sun) 4.2 OK (and sometimes so is 4.3...?) 

There were two distinct bugs: 

1) In ml-etr-tactics-sline.lisp, in the function cases-tac-etree-nat-fn,
there was a call to (mapcan ...), which can be destructive, and which has 
been replaced by the non-desctructive equivalent (reduce 'append (mapcar ...))
This was making the CASES tactic lose track of some of its supporting lines,
and hence fail to find a proof. All but one of the bugs above were caused
by this.

2) In ms90-3-unif-fo.lisp, in the function pfd-fo-unify-rec-real,
I've replaced 
(if (lsymbol-q term2)
    (pfd-fo-unify-rec-real term2 env2 term1 env1 dpairs conns subst-stack)

with 
(if (lsymbol-q term2)
    (progn (psetq term2 term1 term1 term2 env2 env1 env1 env2)
      (pfd-fo-unify-rec-real term1 env1 term2 env2 dpairs conns subst-stack))

I'm not sure what exactly is the difference between these two, but this
file contains about six functions that all call each other recursively.
I can't produce a simple example of the problem (which is new to ACL 4.3),
and I'm inclined to believe it's a bug in TPS rather than one in Allegro 
(the code probably assumes something about the implementation of Lisp that 
isn't necessarily true). Anyway, this fixes it, and explains why we
had a problem with first-order path-focused searches.
=======================================================================
MB		REWRITE-EQUIVS					15th Apr 1998
Up until now, REW-EQUIV has always rewritten A EQUIV B to 
A IMPLIES B AND B IMPLIES A (regardless of whether it was a positive or negative occurrence).
I've changed this to take account of the flag REWRITE-EQUIVS, and
added some extra settings to REWRITE-EQUIVS so that the old behaviour
is recoverable (the new settings are 4 and 5).
Changed: wfflmbd2.lisp, cnf.lisp
=======================================================================
MB		CCS --> MS98-1					24th Apr 1998
I've added MS98-1 to the list of matingsearches that DEFAULT-MS knows about,
and checked that it works properly with DIY (and GO in the mate top level). 
The subject MS98-1 contains all of the flags for this search.
=======================================================================
MB		MERGE-MINIMIZE-MATING				29th Apr 1998
Implemented the new flag MERGE-MINIMIZE-MATING.
Changed: mating-aux.lisp, mating-merge.lisp
=======================================================================
MB		MS98 MODULE					4th May 1998
Added the new module MS98 to defpck.lisp and tps-{build,compile}.lisp
=======================================================================
MB		HOSTNAME for LINUX				7th May 1998
Fixed MACHINE-INSTANCE on gtps.
Changed: tps3-save.lisp
=======================================================================
MB		PRIMSUB-VAR-SELECT				7th May 1998
Fixed a bug in primsub-var-select that was resulting in no primsubs being
applied to THM3.
Changed: mating-aux.lisp
=======================================================================
MB		test-macros.lisp				12th May 1998
Moved all of the structures, defvars, defflags, etc for the TEST module
into a new file, test-macros.lisp, and changed defpck.lisp accordingly.
This fixes a bug with UNIFORM-SEARCH in the Allegro versions of TPS.
Changed: test-top-{search,slists,top}.lisp, defpck.lisp
=======================================================================
MB		SEARCHTYPE					14th May 1998
Introduced the type SEARCHTYPE, and changed the definition of DEFAULT-MS
appropriately.
Changed: mating-top.lisp, diy.lisp, argtyp-auto.lisp
=======================================================================
MB		SUPPRESS-FLAGS{-LIST}				14th May 1998
Added the flags SUPPRESS-FLAGS and SUPPRESS-FLAGS-LIST.
Changed: review.lisp
=======================================================================
MB		MERGING BUG					21st May 1998
Proving THM39 in MS98-FO-MODE turned up a new merging bug, caused by 
stripping expansion variables during instantiation of a definition, and by 
having *ignore-statuses* nil during merge-all.
Changed: mating-merge.lisp, etrees-exp-vars.lisp
=======================================================================
MB		ANOTHER MERGING BUG				21st May 1998
X6004 in MODE-X6004-DTPS (or any other mode) ran into a bug while merging,
because it prettified two distinct variables into the same new variable.
Changed: mating-merge-eq.lisp
=======================================================================
MB		PTREE, PTREE*					28th May 1998
Implemented the two commands PTREE and PTREE*.
Changed: etrees-print.lisp
=======================================================================
MB		SUBST= BUG					1st Jun 1998
There was a bug in translating the proof of E13A2 (a fragment of EQUIV-01-03).
This bug seemed to be caused by SUBST={L,R}-TAC.

In COMPLETE-TRANSFORM*-TAC, we used to call SUBST=L-TAC and then SUBST=R-TAC.
Now, there is a new tactic SUBST=-TAC, which goes through the support lines
in order, attempting first SUBST=L and then SUBST=R for each of them. This 
has replaced SUBST=L-TAC and SUBST=R-TAC in the definition of 
COMPLETE-TRANSFORM*-TAC.

For reasons that are utterly obscure to me, and which may in fact be nothing 
more than blind luck, this fixes the problem without (as far as I can see)
creating any more bugs. It's certainly at least as correct as what we had 
before (the order in which SUBST=L and SUBST=R are called should make no 
difference to the translation).

However, I've added an entry to the bugs file, describing how to undo 
the changes to COMPLETE-TRANSFORM*-TAC and recreate the bug again, in case some 
future programmer should want to spend a couple of weeks chasing this bug down.

Changed: ml-etr-tactics-main.lisp, ml-etr-tactics-eq.lisp
=======================================================================
MB		TIMING BUG					2nd Jun 1998
There was a bug in the Allegro timing routines (we were counting system and
user GC times, but only user total time, resulting in negative net (total - gc)
times for some searches. This is now fixed, and explained in the comments
for the function tps-get-internal-run-time (a replacement for get-internal-run-time)
in the file timing.lisp.
Changed: timing.lisp, plus all calls to get-internal-run-time.
=======================================================================
MB		LIBRARY KEYWORDS				3rd Jun 1998
Implemented the commands SHOW-KEYWORDS, ADD-KEYWORD, CHANGE-KEYWORDS and
UPDATE-KEYWORDS, plus the flag LIB-KEYWORD-FILE.
Changed the commands {SHOW,TEX,SCRIBE}-ALL-WFFS and KEY to use the keywords
(the former had used filters; the latter previously searched only names of objects).
Introduced the function write-libitem-quick, which speeds up deletion and modification
of library objects (by not parsing all of the rest of the file every time one object
is changed).
New file: library3.lisp
Changed: defpck.lisp, lib-macros.lisp, lib-ops.lisp, library1.lisp, library2.lisp
=======================================================================
MB		ADD-SUBDIRECTORIES				4th Jun 1998
A new bug with ADD-SUBDIRECTORIES appeared (for no readily apparent reason).
Fixed by rewriting the code completely; ADD-SUBDIRECTORIES now works with Lucid
(for sure) and Kyoto (probably) as well as ACL and CMUCL
Changed: lib-ops.lisp
=======================================================================
MB		UMASK						4th Jun 1998
I've inserted umask 0111 commands into three files in the /home/theorem/tps/
directory on gtps: tps-build, tps-compile and run-tpsallegro; we used to use
0113 in run-tpsallegro and nothing at all in the others. This changed because
we don't have groups on GTPS (so chmod g+rw wasn't enough to allow anybody
to save compiled files over older compilations).
=======================================================================
MB		TEX FORMATTING					18th Jun 1998
Inserted a thin space in all the places where p x might otherwise be mistaken 
for px; stopped it from printing some variables in roman (although abbrevs are
still in roman, as they should be).
Changed: deftex.lisp
=======================================================================
MB		PTREE-FILE					18th Jun 1998
The new command PTREE-FILE outputs PTREE or PTREE* to a file. If you
choose width 200 (the default), then the results fit onto a page when you use:
enscript -r -fCourier-Bold6 -dberyl etree.txt
Changed: etrees-print.lisp
=======================================================================
MB		TIMING-NAMED					19th Jun 1998
Implemented flag TIMING-NAMED.
Changed: timing.lisp
=======================================================================
MB		SCRIBE DOCS					23rd Jun 1998
Added a list of flags to each subject in the facilities guides.
Changed: scrdoc.lisp
=======================================================================
MB		SPLIT-PTREE					25th Jun 1998
In the directory /afs/cs/project/tps/tps/utilities/,
there's a new utility called split-ptree. It consists
of three files: split-ptree, split.awk and split.README.
The .awk file is called by split-ptree (which is an
executable shell file). I suggest defining an alias, say:
alias tps-split "/afs/cs/project/tps/tps/utilities/split-ptree"
Then, to split up a 200-column file etree.txt into 80-column files
col.1, col.2 and col.3, type:

tps-split etree.txt col 200 80
(or just type tps-split, and it will prompt you for the other arguments).
More details are in the .README file.
=======================================================================
MB		CW/CWS/CWD					25th Jun 1998
The new mate commands CW, CWS and CWD create weak labels from the current 
jform, shallow fmla and deep formula respectively.
Changed: etrees-jforms.lisp
=======================================================================
MB		EXPERTS						27th Jul 1998
In the Makefile, you can now set 
experts = t
to mean "everybody has expert permissions"
Changed: tps3-save.lisp
=======================================================================
MB		LOCK-LINE					27th July 1998
In a saved proof, lines can now be marked as "locked", meaning that TPS
will refuse to delete them (or to delete any other lines that would 
result in deleting a locked line). Old saved proofs will (of course) still
work. There are new commands LOCK-LINE and UNLOCK-LINE which allow the user
to mark a line as locked or unlocked.
Changed: saveproof.lisp, otl-rearrange.lisp
=======================================================================
MB		CMDLINE SWITCHES				27th July 1998
TPS now accepts the command line switch -omega, in the following format:
tps3 -- -omega -batch thm15bwk -outfile thm15bresult
means "run the work file thm15bwk.work, then allow the user to work 
interactively, and when the user exits TPS, save the current version of
whichever proof was active at the end of the work file to thm15bresult.prf"
If -outfile is omitted, TPS will use "<proofname>-result.prf" as the filename.
If there is no dproof created by the workfile, the saved proof will be 
whichever proof is current when the user types EXIT, and it will be named 
"tps-omega.prf"
Changed: tps3-save.lisp, macsys.lisp
=======================================================================
MB		COMMAND-LINE-SWITCHES				27th July 1998
COMMAND-LINE-SWITCHES has been added as an INFO object.
=======================================================================
MB		FILESPECP					27th July 1998
The function filespecp used to object to the filespec NIL; now it 
regards it as equivalent to "".
Changed: macsys.lisp
=======================================================================
MB		TACTICS HELP					27th July 1998
HELP <TACTIC> now only expands the tactic to primitive tactics when 
SHORT-HELP is NIL.
Changed: tactics-macros.lisp
=======================================================================
MB		BAD DEFFILES					27th July 1998
ml1-logic3b.lisp and macsys.lisp had deffile declarations which didn't 
correspond to the names of the files. This has been fixed.
=======================================================================
MB		HTML-DOC					27th July 1998
The new command HTML-DOC outputs all the help messages in TPS in HTML
format, organized as for the ENVIRONMENT, but with hyperlinks embedded
in the help text wherever a TPS object whose name is longer than one
letter can be recognized. One-letter commands embedded in the help text 
are omitted (because we didn't want every occurrence of "a" to be linked 
to the TPS command of that name!).
New file: htmldoc.lisp  Changed: defpck.lisp
=======================================================================
MB		MS91 BUG					27th July 1998
Somehow, cmulisp was ending up with current-eproof being NIL when it 
should have been equal to master-eproof. I don't know what caused this, 
but it's easily prevented (by a setq in make-new-options).
Changed: ms91-basic.lisp
=======================================================================
MB		DOCUMENTATION					27th July 1998
There is a link to the appropriate page of the Springer website from the 
TPS homepage.
The user manual now mentions the -omega switch, the extra-short manual and
the HTML documentation.
The HTML documentation now has a more useful contents page, which is more
similar to the facilities guide contents page.
=======================================================================
MB		KEYWORDS					27th July 1998
If you opt to change the provability during DATEREC, then the keywords 
will be changed as well. Also, if you change the provability using 
CHANGE-PROVABILITY then the keywords will be updated accordingly. 
Changed: library2.lisp
=======================================================================
MB		TEXPROOF 					27th July 1998
TEXPROOF would occasionally fail with the error "EXCL::STRING1 argument should be a string".
This was fixed by a change in tex-fudge-comment, in otl-scribeout.lisp;
it was caused by attempting to do STRING= X Y where X was a list.
Changed: otl-scribeout.lisp
=======================================================================
MB		BUG-RESTORE					27th July 1998
BUG-RESTORE was buggy (it didn't load abbreviations properly).
Changed: lib-bug.lisp, lib-ops.lisp.
=======================================================================
MB		VPT						29th July 1998
The VPT command now pays attention to the setting of ALLSCOPEFLAG.
Changed: vpforms-tex.lisp
=======================================================================
MB		Default proof name				29th July 1998
PROVE now provides a default name for the proof, as it used to. 
Changed: argtyp.lisp, otlnl.lisp
=======================================================================
MB		SETUNION NULLSET = NULLSET			31st July 1998
Proving SETUNION NULLSET = NULLSET in ms90-3 caused a crash in find-success-node
(because the root unification node is NIL when it finishes, rather than being a unode).
Proving it in MS91-* caused a divide-by-zero error in limited-mating-search-option,
because number-of-vertical-paths-main is 0.
Changed: ms91-search.lisp, ms90-3-unif-tree.lisp
=======================================================================
MB		GO / ADVICE					4th Aug 1998
Things that used to be true about GO / ADVICE but aren't any more:
1) Typing MORE (to get more suggestions for the next command) used to crash.
2) GO used to suggest EXT= and EXT=0 when they weren't applicable because of
   type considerations.
3) The commands EQUIV-EQ-EXPD, EQUIV-EQ-CONTR, LCONTR*, LEXPD* and 
   EQUIV-IMPLICS were never suggested by GO. (Fixing this also meant assigning
   priorities and ADVICE messages to these commands, which in turn meant 
   spreading out the priorities of some of the other commands, so the default
   setting of GO-INSTRUCTIONS has changed a little, and the help message has
   been made more informative.) These commands will only be suggested when
   they are really applicable, because I've added an extra routine to 
   strengthen the suggestion mechanism for those cases when the match function
   isn't enough.
4) EQUIV-EQ-EXPD, EQUIV-EQ-CONTR and the editor command EXPAND= used to 
   expand all of the equalities in a formula. They now expand only the topmost,
   and the old commands have been renamed EQUIV-EQ-{EXPD*,CONTR*}, and EXPAND=*

Changed: ml2-prior.lisp, otl-suggest.lisp, wffabb2.lisp, edabb.lisp, 
ml2-logic7a.{lisp,rules}, otl-go-mac.lisp, etrees-skolem.lisp, 
etrees-exp-vars.lisp
=======================================================================
MB		USER INTERRUPT					7th Aug 1998
Added M<return> to the possible user interrupts; it shows the current
mating during a search.
Changed: ms90-3-top.lisp, mating-dir.lisp, user manual.
=======================================================================
MB		MBED-* BUG					7th Aug 1998
mbed-f was giving odd type errors, which turned out to be due to trying to apply
gwff-subtype to a default argument without first setting global-type. All of the
mbed-* commands were subject to this bug, which is now fixed.
Changed: wffmbed.lisp
=======================================================================
MB		DEFAULT-MATE, DEFAULT-EXPAND			19th Aug 1998
The flags DEFAULT-MATE and DEFAULT-EXPAND weren't being set when DEFAULT-MS
was updated. This has been fixed, and the help messages for these flags have
been changed to include the exceptional setting MS98-1.
Changed: mating-top.lisp
=======================================================================
MB		GO updates PROOFWINDOWS				2nd Sep 1998
The GO command wasn't updating proofwindows.
Changed: otl-go.lisp
=======================================================================
MB		ETPS windows					2nd Oct 1998
There are apparently two versions of ps, and depending on which is first on your
path, the proof windows might not open on Andrew. The good news is that the
current version of Allegro doesn't need the hack to start proofwindows anyway
(we were piping the output of ps to a file, and then doing grep to discover 
the process IDs).
Changed: tops20.lisp
=======================================================================
MB		TEX superscripts				2nd Oct 1998
ETPS crashed when trying to run TEXPROOF on any proof involving superscripts.
This turned out to be due to the function string-nthcdr, which doesn't exist
in ETPS, but ought to.
Changed: deftex.lisp
=======================================================================
MB		Prenex NF Examples/PRENEX-ITERATE 		16th Oct 1998
All of the exercises from x2200 to x2214 have been added to ETPS as saved
wffs. This means that, for example, you can type ED X2201 to examine X2201
in the editor. If prenex.lisp isn't loaded by the patch file, then load it (it's not
currently part of any module, so it won't get built in to the core image).

The command PRENEX-ITERATE takes the root of a name as an argument, and
checks all of the extensions of that name which exist as saved wffs in
memory (so you'll need to tload the file of saved wffs first). So 
PRENEX-ITERATE FOO will check FOO-BAR, FOO2, FOO-MBISHOP, etc, for 
equivalence to FOO modulo taking a prenex nf. (NB In TPS, "saved wffs" 
are not theorems; in particular, the library does not contain saved wffs.)

It checks both that the longer name represents a wff in prenex normal form,
and that the two wffs are equivalent. (Note: it *doesn't* check that the second
wff is *the* prenex nf; in particular, TRUTH is a prenex nf of any theorem.).
Since the latter needs a call to mating search, I've added a new command to 
bail out of mating search: q<return> will abandon the current search and start
on the next one.

Instructions to students were:
Suppose you are creating a prenex normal form for X2201. From the editor,
you can use the SAVE command to store your answer in a file. You will be
prompted for a name for this wff; please use the format EXERCISE-USERNAME 
for the name. For example, if your user name is jsmith@andrew, you should 
give the prenex normal form of X2201 the name X2201-JSMITH.

This will create a file savedwffs.lisp in your home directory. In this file,
you will find an expression of the form 
(DEFSAVEDWFF X2201-JSMITH
  (REPRESENTS "some well-formed formula"))
=======================================================================
MB		DB / EP / OP / CLAUSE-FORM			19th Oct 1998
The above commands are now part of the core package; the file eddev.lisp has
been moved into the editor module. This was the only file in the
development-seqs module, which has been removed. ETPS has been rebuilt for
the Sun workstations, and everything seems to be working fine.

Changed: eddev.lisp, defpck.lisp, wffsub2.lisp, auto.exp, core.exp, tps-build.lisp, 
tps-compile.lisp
=======================================================================
MB		ETPS manual online				27th Oct 1998
Changed the HTML documentation so that it produces ETPS documentation from 
within ETPS. To use this, from an ETPS core image, do:
tload htmldoc
maint::html-doc <directory>
The current default etps documentation directory is /afs/cs/project/tps-1/etpsdoc/
Changed: htmldoc.lisp
=======================================================================
MB		ETPS typing bugin MBED-F			28th Oct 1998
MBED-F was failing in ETPS because gwff0 was defined using (eq (get gwff0 'type) 'O)
instead of (eq (type gwff0) 'O).
Changed: argtyp.lisp
=======================================================================
MB		Major ETPS rules bug				28th Oct 1998
Almost none of the ND rules which require a variable were testing the 
argument to ensure it *was* a variable (the single exception being RULEC).
As a result, it was possible to quantify over arbitrary terms, and even 
to derive A from B by substitution of any term for any other term (!).
Fixed by adding (is-variable foo) in all the appropriate places and recompiling
the rules files.
Changed: ml1-logic2.rules, ml2-logic2a.rules, ml2-logic4b.rules,
ml2-logic7c.rules, ml1-logic4.rules, ml2-logic2b.rules, ml2-logic4c.rules, 
ml2-hacks.rules, ml2-logic4a.rules, ml2-logic7a.rules,
=======================================================================
MB		CLAUSE-FORM					2nd Nov 1998
Moved CLAUSE-FORM back into the auto package (and out of ETPS), because
it uses the skolemization functions from the auto package, none of which 
are loaded in ETPS.
Changed: eddev.lisp, wff-skolem.lisp
=======================================================================
MB		PRINT-HTML					21st Jan 1999
Defined the utility PRINT-HTML. See the help message for details.
Changed: maint.exp, htmldoc.lisp
=======================================================================
MB		Bug fix						1999 Feb 8
GTPS running Allegro complains of SEGMENTATION FAULT.
DTPS running CMU LISP complains
Type-error in KERNEL::OBJECT-NOT-TYPE-ERROR-HANDLER:
   (QUOTE MACHINE-TYPE) is not of type SYMBOL
Problem is due to an extraneous quote mark which GTPS put into a library file
=======================================================================
MB		Seg fault					18th Feb 1999
Would you believe an infinite loop in lambda-normalization? MS90-3 crashed
(seg fault) after finding a proof of 
~[PARTITION(O(O(OO)))[POWERSET(O(OO)(OO))[LAMBDA X(O)TRUTH(O)]]]
This is now fixed.
Changed: ms90-3-exp-jform.lisp
=======================================================================
MB		Types for polymorphic abbreviations		18th Feb 1999
Polymorphic abbreviations inside gwffs weren't getting their types recorded;
in some circumstances, this meant that the parser would infer the wrong type 
for them. Fixed by setting PRINTTYPES-ALL T and ignoring PRINTNOTYPES for 
polymorphic abbreviations when this flag is set.
Changed: prt.lisp, styles.lisp
=======================================================================
MB		Pretty-print for TEX-ALL-WFFS			19th Feb 1999
The wffs printed by TEX-ALL-WFFS don't fall off the edge of the paper any 
more.
Changed: library1.lisp, lib-ops.lisp, lib-objects.lisp
=======================================================================
MB		BESTMODES					8th Mar 1999
Implemented the bestmodes.rec file in the library.
New commands: ADD-BESTMODE, SHOW-BESTMODE, TEST-INIT, FIND-MODE
New flags: LIB-BESTMODE-FILE
Changed flags: TEST-THEOREMS now accepts NIL as the name of a mode.
Changed commands: TPS-TEST, TPS-TEST2 recognise the change to TEST-THEOREMS,
 DATEREC now offers to save a best mode, and GWFF-P now offers to load a mode
 from the library if (and only if) it loads a gwff from the library.
New function: (core::test-to-bestmode) takes a setting for TEST-THEOREMS and
adds it to the bestmodes.rec file.
Changed files: lib-macros.lisp, library3.lisp, lib-ops.lisp, maint.lisp,
flagging.lisp, library2.lisp, core.exp, maint.exp, wfftst.lisp, review.lisp
=======================================================================
MB		LAST-GWFF-TYPED					16th Mar 1999
core::*last-gwff-typed* isn't always bound. Changed defaultfns of PROVE
to reflect this fact.
Changed: otlnl.lisp
=======================================================================
MB		AUTO-SUGGEST					17th Mar 1999
Fixed some small bugs in AUTO-SUGGEST. Also changed the way in which SUBST= and
SYM= lines are removed; it now doesn't try to outguess the user's choice of 
flag settings. Also fixed the way that etree-nat handles RULEQ so that when
lemmas are introduced, they have the right hypotheses.
Changed: nat-etr.lisp, ml-etr-tactics-{pline,sline}.lisp
=======================================================================
MB		SET OF SUPPORT					29th Mar 1999
MS98-1 now implements a version of the set-of-support strategy, using
the flag MS98-FIRST-FRAGMENT.
Changed: ms98-macros.lisp, ms98-weights.lisp
=======================================================================
MB		TEST-TO-BESTMODE				29th Mar 1999
Exported the function TEST-TO-BESTMODE as a utility, so we'll remember it exists.
Changed: library3.lisp
(See April 23, where this was deleted)
=======================================================================
MB		CONTEXTS					19th Apr 1999
Library and review contexts are now correct, and FIND-MODE has a longer
help message.
Changed: unif-simpl.lisp, library3.lisp, contexts-core.lisp
=======================================================================
MB		PROVE/EXERCISE					19th Apr 1999
PROVE can now be applied to exercises in TPS (but not in ETPS, where
you must still use EXERCISE; this is a security measure designed to 
make sure that students can't substitute an easier exercise under the 
same name).
Both PROVE and EXERCISE will offer to load a mode, if the library is
present (so, again, this will only work in TPS).
Changed: argtyp.lisp, otlnl.lisp, wfftst.lisp
=======================================================================
MB		FALSE nodes					20th Apr 1999
TRUTH is really an empty conjunction in the jform, and so there isn't a 
literal there. The path enumerator gets around this by making a new literal;
unfortunately, it makes a different literal every time! This means that TPS 
is forever finding "new" connections to try in such jforms.

I've fixed this by introducing a function generate-a-fixed-name-for,
which gives the new literal a fixed name generated from its position in 
the jform. Every instance of (make-literal :represents t :parent jform)
has been replaced with (make-literal :represents t :parent jform :name
(generate-a-fixed-name-for jform)). 

I hope this fix works (I can't see any reason why it wouldn't), but if 
it causes trouble in the future, just grep for "generate-a-fixed-name-for"
and remove it.

Changed: mating-paths.lisp, mating-prop.lisp, mating-trans.lisp, 
ms90-3-prop.lisp, newrulep-tsts.lisp, symsimp2.lisp
=======================================================================
MB		TPS-TEST					21st Apr 1999
The changes to PROVE had unintentionally forced TPS-TEST to prompt 
for a mode before running each theorem. This has been fixed.
Changed: maint.exp, maint.lisp, otlnl.lisp
=======================================================================
MB		MS98-1 and QUERY-USER				22nd Apr 1999
MS98-1 now prints the primitive substitutions in the current 
etree before starting the search. It also shows the vpform when
QUERY-USER is set to QUERY-JFORMS, and gives the user the option of 
skipping that jform (the next jform will be created from the next 
primitive substitutions if there are any, and by duplicating 
a quantifier otherwise).
Changed: ms98-top.lisp
=======================================================================
MB		MORE ON BESTMODES				23rd April 1999

The bestmodes.rec file now has a new format: it's a list of lists
of the form: (THM MODE DATE TIME COMMENT)
where DATE is an eight-digit integer like 19990423, and TIME is an
integer representing the number of seconds required to prove THM in mode
MODE, and COMMENT is an arbitrary string.

The same THM and MODE are allowed to occur in multiple entries, and 
entries in one bestmodes.rec file will not be copied into a different
directory. All entries are loaded on startup.

There are new commands:

ADD-BESTMODE is as before, only with more arguments. If there is already a
bestmode with this theorem and mode, you will be asked to confirm the new
mode (if it's in your directory, you will also be asked whether to overwrite
the old mode or not).

SHOW-BESTMODE is also as before; it displays all of the saved information,
plus "read/write" or "read-only" to indicate whether you may modify this
bestmode (i.e. whether it's in your library or someone else's).

SHOW-NEW-BESTMODES shows all of the bestmodes added since a given date.

MODIFY-BESTMODE does exactly what you'd expect. Modifying a read-only mode
will create a modified copy in your own bestmodes.rec file.

DELETE-BESTMODE also does what you'd expect. You can't delete modes in other
people's directories.

FIND-MODE (review top level) does the same as before, as does the 
"load a mode?" prompt which appears after calling PROVE or EXERCISE.

MODEREC (main top level) is similar to DATEREC, but writes to the 
bestmodes.rec file. It can be called after a proof is completed, and
it will attempt to guess all of the arguments that would be required by
ADD-BESTMODES; you are given the chance to confirm its guesses.

TPS-TEST and TEST-INIT behave properly with the new bestmodes.rec format.
Furthermore, TPS-TEST now gives you the option of calling MODEREC silently
after each proof; you will not be asked to confirm these calls. (This is 
fine, since it should guess correctly under these circumstances, unless you
are using TEST-MODIFY, in which case it will alert you to the possible
problem and ask whether you really want to call MODEREC.)

The changes to TPS-TEST mean that the utility TEST-TO-BESTMODE is now
obsolete, and has been removed.

Changed: library2.lisp, library3.lisp, lib-ops.lisp, maint.lisp.
=======================================================================
Subject: More about bestmodes
Date: Mon, 26 Apr 1999 13:43:09 -0400
From: Matt Bishop <Matt_Bishop@FTPS.TPS.CS.CMU.EDU>

There is a new library command, FIND-DUP-MODES; it looks for bestmodes 
entries which have the same theorem and mode, and displays them for the 
user. It doesn't delete them, because there may be a reason for such a 
duplicate (maybe the proof time improved dramatically,
or someone has added a comment like "doesn't work any more").

The bestmodes.rec file itself wasn't being backed up anywhere, which was
worrying (libindex.rec and keywords.rec can be recreated easily if they're 
deleted, but bestmodes.rec can't). So I've introduced rolling backups,
named bestmodes.bk{1,2,3,4,5} --- each time you start up, TPS compares 
bestmodes.rec with bestmodes.bk1. If they're different then 
bestmodes.bk5 is deleted, all the other backups move up one, and bestmodes.rec
is copied to bestmodes.bk1. (It does the right thing if any of these files 
are missing.)

SPRING-CLEAN has been told about the existence of bestmodes.* and keywords.rec
files, so it won't prompt you to delete them.

Also, the makelisptar file, which is called each time we build TPS, now
also tars and gzips the library files (just the *.lib and *.rec files,
ignoring anything else). This is also useful for those of us who have TPS 
running at home: downloading and unpacking the most recent lisp and
library tar files will synchronize your home version with the version on
afs.
=======================================================================
CEB		REMOVE-LEIBNIZ BUGS				28th Apr 1999
There were two bugs handling definitions in remove-leibniz which I have
fixed.  First, if the LEIBNIZ= node is the top of the tree, then the
etree should be changed, not the parent of the LEIBNIZ= node.  Second,
the rewrite nodes below the LEIBNIZ= node must be "lifted".  This was
being done incorrectly in the case in which the LEIBNIZ= node becomes
an application of REFL=.  
Changed: mating-merge.lisp, mating-merge-eq.lisp
=======================================================================
MB              ASSERT                                          27th May 1999
> 	The ASSERT command seems to be completely broken.

ASSERTable theorems contain both quantified and unquantified metavariables;
a few weeks ago, I fixed it so that only variables could be substituted for
quantified metavariables (previously, terms could be substituted for any
metavariable).

I have no idea why this bug didn't show up then, but I've tracked it down
and fixed it (it was in make-assert-argtype-list, where it was assumed that
the value of mwff would always be a symbol with a plist -- in fact, it can
also be a wff with metavariables in place).

Changed: otl-schema2.lisp
=======================================================================
CEB		PROVE, LAST-GWFF-TYPED				2nd Jun 1999
The code in prove1 was supposed to call find-mode using
core::*last-gwff-typed* if it is a symbol (label) for the
wff to prove.  There was a bug because prove1 did not first
check if core::*last-gwff-typed* is a symbol.  I added this check.

Changed: otlnl.lisp
=======================================================================
CEB		PROVE    					2nd Jun 1999
I added an extra check that the wff to prove is of type o.  This
catches the case when we ask it to prove a label for a wff which is
not of type o.

Changed: otlnl.lisp
=======================================================================
CEB		FIND-TYPE-VARS					4th Jun 1999
The function rec-push-types which does the work for the function
find-type-vars was only checking if a symbol was not a typeconst
in order to determine if it is a type variable.  I added an extra
check to rule out typeabbrev's (so that, in particular, S would
not be seen as a type variable).

Changed: read-ruledefs.lisp
=======================================================================
CEB		TYPESUBST					11th Jun 1999
I installed the typesubst inference rule.  The mexpr and main
functions are in ml2-prior.lisp.  Some auxilliary functions are
in wfftyp.lisp.

Changed: ml2-prior.lisp, wfftyp.lisp, core.exp, ml.exp
=======================================================================
CEB		DOUBLE NEGATION AND HNF				21st Jun 1999
I fixed a bug in the function hnf which computes a head normal form
of a term -- if reduce-double-neg is t, then the hnf of NOT (with no
argument) was being returned as ~NIL.

Changed: unif-lambda.lisp
=======================================================================
CEB		AUTO-SUGGEST (REMOVE-SUBST=-LINES)		11th Jul 1999
I wrote a new version of remove-subst=-lines which removes lines
justified by subst= and sym= by using the Leibniz definition of equality,
and extensionality when necessary.  The new version does not rely
on automatic search.

Changed: nat-etr.lisp
=======================================================================
CEB		VPW						11th Jul 1999
Now before merging and translating an expansion tree proof,
TPS prints a message to the vp window file, if the user
has a vp window open.  This can be used to check if tps
has found a proof by looking at the tail of the current .vpw
file.

Changed: diy.lisp
=======================================================================
CEB		LIBRARY SUBDIRECTORIES				13th Jul 1999
I have implemented new library commands CREATE-LIB-DIR,
CREATE-LIB-SUBDIR, and DELETE-LIB-DIR.  These allow the
user to create and delete library directories and subdirectories
from within TPS.

Changed: library2.lisp
=======================================================================
CEB		SEARCH-SUGGESTIONS CONTEXT			13th Jul 1999
A new context, search-suggestions, has been defined and 
auto-suggest has been put into this context.  (Previously,
auto-suggest was in the nat-etr ["PROOF TRANSLATION"] context.)

Changed: auto.exp, contexts-auto.lisp, nat-etr.lisp
=======================================================================
CEB		TYPESUBST BUG					14th Jul 1999
There was a minor bug in the typesubst inference rule code.
I was intern'ing a symbol returned by gensym rather than a
string.  Allegro allows this, but CMUCL does not.  In any case,
the symbol did not need to be intern'ed, so the problem was
easy to fix.

Changed: ml2-prior.lisp
=======================================================================
CEB		CALL-SYSTEM for CMUCL				3rd Aug 1999
call-system (the function for making running UNIX commands) simply
didn't work for CMUCL.  I modified it to work.

Changed: tops20.lisp
=======================================================================
CEB		LIBRARY CHANGES					3rd Aug 1999
Installed new library commands COPY-LIBDIR, RENAME-LIBFILE,
CHECK-NEEDED-OBJECTS, and IMPORT-NEEDED-OBJECTS.  COPY-LIBDIR
and IMPORT-NEEDED-OBJECTS allow the option of omitting
other-remarks.

Also, I made changes to various help messages and failure messages
regarding SHOW-ALL-LIBOBJECTS and when the user is prompted.

Changed: lib-ops.lisp, library1.lisp, library2.lisp, core.exp
=======================================================================
CEB		MORE LIBRARY CHANGES				4th Aug 1999
Updated DELETE-LIB-DIR so it can delete a nonempty library directory.
Installed new library command DELETE-LIBFILE.  Also, added OMIT-OTHER-REMARKS
argument for COPY-LIBOBJECT and COPY-LIBFILE

Changed: library2.lisp, core.exp
=======================================================================
CEB		MORE LIBRARY CHANGES				5th Aug 1999
Updated the LIBFILES library command so the user has the option of
choosing a single library directory from which to list the files.
Installed a new library command RENAME-LIBDIR.  Also, updated DELETE-LIB-DIR
so the user can delete a file which is not listed in DEFAULT-LIB-DIR.
Fixed a few minor bugs concerning the hash table *lib-masterindex*
and library directories not listed in DEFAULT-LIB-DIR or BACKUP-LIB-DIR.

Changed: library1.lisp, library2.lisp, core.exp
=======================================================================
CEB		COPY-LIBDIR					16th Aug 1999
COPY-LIBDIR now copies the bestmodes and keywords files (if they exist),
merging them with existing files in the target directory if necessary.

Changed: library2.lisp
=======================================================================
CEB		USER MANUAL LIBRARY UPDATES			17th Aug 1999
Several changes have been made to Chapter 6 of the User Manual.
The chapter now gives a more detailed description of the library
and the associated file structures.  Also, a section on keywords
has been added.

Changed: user manual
=======================================================================
CEB		ADD-HYPS and DELETE-HYPS			20th Aug 1999
Installed commands ADD-HYPS and DELETE-HYPS which allow the user
to add or delete hypotheses from a given line.  This may cause some
lines to become planned lines.  Under certain conditions, the user
may be given the option of adding or deleting hypotheses from other
lines simultaneously.

Changed:  otl-rearrange.lisp, prfw.lisp, core.exp
=======================================================================
CEB		ETPS MANUAL and HELP for HYP			21st Aug 1999
Updated ETPS manual to include ADD-HYPS and DELETE-HYPS as
special inference rules.  Also, changed the help for the inference
rule HYP to better distinguish it from ADD-HYPS.  The new help for
HYP reads "Introduce a new hypothesis line into the proof outline."

Changed:  ml1-logic0.rules, ETPS manual
=======================================================================
CEB		MOVED GET-A-NUMBER				24th Aug 1999
Moved the definition of get-a-number and get-a-number-list from
lib-ops.lisp to linereadp.lisp so that ETPS functions can call
these functions.  In particular, the code for ADD-HYPS and DELETE-HYPS
calls get-a-number.

Changed:  lib-ops.lisp, linereadp.lisp
=======================================================================
CEB		GET-SCORES					25th Aug 1999
Copied the script get-scores-hp (in admin/etps-scores) to get-scores-linux
and updated both to refer to the new place for the TPS directory.
=======================================================================
CEB		ETREES-DEBUG                                    3rd Sept 1999
Created a new file etrees-debug with functions to check structural
properties of etrees.  This is only for debugging and is not needed
for the normal functioning of TPS.  The file has been added to the
module EXPANSION-TREE.

Changed:  etrees-debug.lisp, defpck.lisp
=======================================================================
CEB		ETREES-DEBUG                                    6th Sept 1999
Updated the programmer's guide to include information about the
file etrees-debug and the function check-etree-structure.

Changed:  Programmer's Guide
=======================================================================
CEB		WFFEQ-DEF1 BUG					21st Sept 1999
Fixed a bug in wffeq-def1 which caused an infinite loop in a case like
[lambda x(A) x(A)] vs. [[lambda y(AA) y] [lambda x(A) x]].  The old
code tried to normalize the first term (which has no effect) instead of
the second, then make a recursive call, resulting in an infinite loop.

Changed:  wffequ2.lisp
=======================================================================
CEB             TPS distribution directory structure           4th Oct 1999

1. Created a dist subdirectory of ~theorem/project.
   Copied the directory structure of /afs/cs/project/tps/dist
   to this directory, with the appropriate new links.

2. Updated references to cs directories in programmer's guide (except
   where Sunil's Propositional Theorem Prover is mentioned in mating.mss).

3. Created subdirectory /home/ftp/pub/old/
     (which is now referenced by tar.mss in prog guide
        as well as in tps-dist.hlp)

4. Updated the file READ.ME.FIRST in /home/ftp/pub (putting the old version in 
     /home/ftp/pub/old)

In /afs/andrew/mcs/math/TPS/admin/tps-dist:

5. Modified tps-dist.hlp (creating .old version)

   . refers to new dist directory on gtps

   . new ftp information (as in new version of tps-dist2-ftp-info-msg, see below)

   . deleted references to UPDATES and the message of 1993 August 19 which
     says to ignore the references to updates.

   . (SOME!) references to old cs directory have been updated to be the new andrew directories
     or the appropriate gtps directories

   . Deleted the following line from the file, because the awk doesn't seem to work
To see how much space they take try
uncompress -c tps3-07apr91.tar.Z | tar tvf - | awk '{sum += $2} END {print $sum}' -
(see the man message for awk.)

      The modified command for gunzip also doesn't work:
       gunzip -c tps3-date.tar.gz | tar tvf - | awk '{sum += $2} END {print $sum}' -

   . Deleted the following:
---------------------------------------------------------------
	The file /afs/cs/project/tps/.anonr
shows which directories people can access when they log in as
anonymous.
---------------------------------------------------------------------
     There doesn't seem to be an anologue in
      the new directory structure.  What one can get using ftp anonymous is under /home/ftp,
      right?  (But the old cs directory did allow anonymous access to keim)

   . Deleted the following dated information:
---------------------------------------------------------------
August 1991 
	The tar file occupies 1,990,011 bytes. When you expand this,
you will get about 6,266,880 bytes. The compiled files occupy about
7.768 megabytes, but the compiled core image that we get using Allegro
Common Lisp (which takes a lot of space itself) occupies just over 14
megabytes.
------------------------------------------------------------------

   . Deleted the entire section "SCRIPT OF SETTING UP A NEW DISTRIBUTION"
     as it all seems to be out-of-date to the point of being misleading.
     Also, it appears to be subsumed by the "KEY STEPS:" part of the file.

6. Modified tps-dist2-ftp-info-msg (creating .old version)
   so it describes ftp from gtps.math.cmu.edu
   instead of ctps.tps.cs.cmu.edu

7. I have updated the file make-tar.exe in admin/tps-dist/ so that it
   uses the new directories and so the date is automatically set
   (adding #!/bin/csh to the top to make sure it runs under csh,
    as otherwise it doesn't work).

8.  Updated Programmer's Guide Chapter 1 to reflect the changes above.
=======================================================================
CEB             Scribe/Tex Bug in common/tps3.ini       19th Oct 1999

The tps3.ini file in the common directory had references to
/afs/andrew.cmu.edu/mcs/math/TPS/lib which I corrected to be
/afs/andrew.cmu.edu/mcs/math/TPS/doc/lib.  This was causing
texproof and scribeproof to create incorrect tex/scribe files.

Changed: common/tps3.ini
=======================================================================
CEB		Alias Files     			20th Oct 1999

There is now a generic alias file for tps: admin/aliases-tps.
On gtps and htps there is a copy of this file as ~theorem/.aliases-tps.
This should be sourced by each user's .tcshrc file.  Also, there
is another alias file specific to gtps: ~theorem/.aliases-gtps.
This should be sourced by each user's .tcshrc file on gtps.
=======================================================================
CEB		Directory Structure    			20th Oct 1999

The ~theorem/project directory was only on htps because htps
used to be gtps.  So, I deleted the ~theorem/project directory
on htps, leaving the copy on gtps, of course.
=======================================================================
CEB		Directory Structure			20th Oct 1999

We should now have a copy of everything we want to keep from the
old /afs/cs/project/ directory.  

FILES AND DIRECTORIES WHICH HAD ALREADY BEEN COPIED

/afs/cs/project/tps-1
 etpsdoc   htmldoc              keim (takes up about 118 megabytes)
 old-source

/afs/cs/project/tps/
admin
common

/afs/cs/project/tps/tps% 
doc			did put onto  gtps
lisp		didn't copy *~ files
oldtps
others
papers			did put onto gtps
proofs 
tpslib
utilities

FILES AND DIRECTORIES RECENTLY COPIED

/afs/cs/project/tps-1/tps/

tarfiles (see $proj/tarfiles.  I edited $tps/admin/makelisptar to put the
           generated tarfiles into this directory.  I also added a link to
           $tps/admin/makelisptar under gtps's ~theorem directory, as was the
           case on ftps.)
unfinished (see $proj/unfinished)

/afs/cs/project/tps
.AMS.prof (see $proj/possibly-useful)
dist  (see $proj/dist)
files.dir (see $proj/possibly-useful)
pba-demo-files (see $proj/dist-for-us/tps-demo-files)
pba-demo-tarfile (see $proj/dist-for-us/tps-demo-tarfiles)
public (see /home/ftp/pub/)
startup (see $tps)
sieg  (see $proj/tps-variants/sieg)
tps.Xclients   (see $tps/startup)
tps.cshrc      (see $tps/startup)

/afs/cs/project/tps/tps/

elisp  (see $proj/tps-variants/emacs-lisp)
fonts  (was already copied into $proj/dist/fonts)
si-prop    (see $proj/tps-variants/si-prop)

FILES AND DIRECTORIES WE WILL NOT COPY

/afs/cs/project/tps-1/

allegro_stable (old version of allegro cl)
allegro4.2hp_huge  (Allegro 4.2 with additional software)

/afs/cs/project/tps/

.AMS.prof.LOCK  (This was empty)
.anonr (but see $proj/possibly-useful/ftp-access.hlp for info about this file)
etps-pmax
keim
next_mach
pmax_akcl
pmax_allegro
pmax_allegro4.1
pmax_allegro_stable
pmax_cmucl
pmax_mach
rt_mach
sun4_mach
theorem-hp (saved only the file SETUP-INSTRUCTIONS under $proj/possibly-useful/)
theorem-pmax (saved only do-pigeon.script under $proj/possibly-useful/)
=======================================================================
CEB		PRENEX-ITERATE				25th Oct 1999

I extended PRENEX-ITERATE to take a list of exercises instead of
just one.  Also, PRENEX-ITERATE now generates a tex file reporting
the results.  I updated the file /home/theorem/project/doc/etps/prenex.hlp
on gtps to reflect these changes, and provided an example session
to show how to use PRENEX-ITERATE.

Changed:  prenex.lisp, prenex.hlp
=======================================================================
CEB		PRENEX-ITERATE				9th Nov 1999

Made the tex file generated by PRENEX-ITERATE include line breaks.
Also, the generated tex file now has the header "PRENEX REPORT".

Changed:  prenex.lisp
=======================================================================
CEB		MS98 AND UNIFY-MSV			23rd Nov 1999

Fixed a bug described below:

Matt's search procedure finds a complete mating:

((LEAF296 . LEAF295) (LEAF286 . LEAF302) (LEAF300 . LEAF301) (LEAF18 . LEAF290) (LEAF19 . LEAF294))

where the pair (LEAF19 . LEAF294) is

LEAF19  =  F^1 X^3 Y^3
LEAF294  =  ~s^1015 X^35 w^7

Then finish-up-ccs calls unify-msv to get the substitution pairs, including:

s^1015(OB(OB))   ->   LAMBDA w^10858(OB) LAMBDA w^10859(B) w^10858 h^122(B)
X^35(OB)   ->   LAMBDA w^10816(B) F^1(OBA) X^3(A) h^122(B)

But when we substitute the pairs become

LEAF19  = F^1 X^3 Y^3
LEAF294 = ~F^1 X^3 h^122

Unification neglected to send h^122 to Y^3.

The function unify-msv appears to assume its input is
a tree where all the leaves are at depth 1.  The bug was showing
up when the mating-utree was deeper.

The fix involved writing a function "pull-up-leaves" in ms98-top
and calling it in ms98-top (to flatten the utree) before calling unify-msv.

Changed: ms98-top.lisp
=======================================================================
CEB		NAT-ETREE and ETR-AUTO-SUGGEST		15th Dec 1999

Updated nat-etree so that removing subst='s from ND proofs works
the same way as for auto-suggest (doesn't call the search procedure).
Also, installed a new command ETR-AUTO-SUGGEST that takes an eproof
and suggests settings for three flags relevant for MS98-1 (Matt's
procedure).  Also, fixed misc bugs.

Changed: hx-natree-top.lisp, hx-natree-duplication.lisp, 
mating-merge-eq.lisp, etrees-auto-suggest.lisp, auto.exp
=======================================================================
CEB		ETR-AUTO-SUGGEST			17th Jan 2000

Added etrees-auto-suggest to the module etr-nat in defpck.lisp.
=======================================================================
CEB & PA	HTML-DOC                                19th Jan 2000

Corrected htmldoc.lisp to reflect the changed web site for TPS

Changed: htmldoc.lisp
=======================================================================
CEB             ETPS on GTPS				19th Jan 2000

Built etps on gtps and put aliases for etps and xetps in
/home/theorem/tps/.tpsrc
=======================================================================
CEB & PA	HTML-DOC                                19th Jan 2000

Ran htmldoc in TPS and ETPS on gtps to fix the links in the online
documentation in /home/theorem/project/doc/htmldoc & htmldoc-etps.
Added a line in the User's manual section 12.9.1 on running
htmldoc in ETPS.
=======================================================================
CEB		FACILITIES GUIDE			19th Jan 2000

Added a line to the introduction stating that the Table of Contents
is at the end of the document (in both the long and short versions).
=======================================================================
CEB		FACILITIES GUIDE			22nd Jan 2000

Due to a cut and paste error, the facilities.lisp file in 
/home/theorem/project/doc/facilities was writing to
facilities-short.mss instead of facilities.mss.  This
caused two problems: 

1.  The short facilities guide was too long if we generated
the facilities guide last (because the short facilities
guide was in fact the facilities guide)

2.  The facilities guide itself was out of date, because
it was not being generated when we loaded facilities.lisp.
This led to inconsistencies between the facilities guide
and short facilities guide.

I fixed the typo and generated the facilities guide, and
this clears up the two problems above.
=======================================================================
CEB		TEX PROGRAMMERS GUIDE			4th Feb 2000

Created a LaTeX version of the Programmer's Guide in
the directory /home/theorem/project/doc/progtex.
=======================================================================
CEB		NAT-ETREE                               9th Feb 2000

Released a new version of nat-etree designed for normal natural
deduction proofs (in the new file ceb-nat-etr).  Created
a new flag NAT-ETREE-VERSION which can be set to OLD, HX, or CEB
to choose between the three versions.  Retired the command
nat-etree-old (which is now nat-etree if NAT-ETREE-VERSION
is set to OLD).  Updated etr-auto-suggest to estimate more flags.
The programmer's guide has much more information about the
new version of nat-etree (and some about the old versions).

Files Changed: argtyp-auto.lisp, nat-etr.lisp, etrees-auto-suggest.lisp,
  hx-natree-top.lisp, hx-natree-aux.lisp, ceb-nat-etr.lisp (created),
  auto.exp, core.exp, defpck.lisp
=======================================================================
CEB		NAT-ETREE                               29th Feb 2000

Moved file ceb-nat-etr.lisp from module etr-nat to module
ml-etr-tactics, so that it is loaded after the hx-*.lisp
files.  

Files Changed: defpck.lisp
=======================================================================
CEB		PROGRAMMERS GUIDE			17th Mar 2000

Updated Programmers Guide to include more information on "status"
of etrees including an email explanation from Dan Nesmith.
=======================================================================
CEB		PARITY1					 7th Apr 2000

Added a new value PARITY1 for REWRITE-EQUALITIES.
This uses the heuristic that one derives things from
equalities using the Leibniz definition, but derives 
equalities (of the right type) using extensionality,
so deepens equality nodes according to their parity.

Files Changed: core.exp, etrees-wffops.lisp, etrees-wffops2.lisp,
               argtyp.lisp, wffabb.lisp
=======================================================================
CEB		CANONICAL EPROOFS			 7th Apr 2000

Added code to make an eproof constructed by nat-etree "canonical".
The notion of canonical depends on the setting of certain flags
(see the help for make-eproof-canonical).  The canonical eproof
should have an etree which looks like the one the search
will generate, so that we can use the command build-corresponding-mating
to transfer the mating from the canonical eproof to the search etree.

Also implemented a few minor changes to nat-etree, and enhancements
to etr-auto-suggest.

Files Changed: ceb-nat-etr.lisp, hx-natree-top.lisp, nat-etr.lisp,
               etrees-auto-suggest.lisp, auto.exp
=======================================================================
CEB		MS98-TRACE			 7th Apr 2000

Added code to trace Matt's procedure's search for a mating
when given a known mating.  The (new) flag MS98-TRACE can
have possible values:

1. OFF - Turn off the tracing facilities.
2. MATING - Search as usual, keeping a record of when good connections and
components are formed.  The value of *ms98-trace-file* is a string giving the
name of a file into which this information is stored.
3. MATING-FILTER - As with mating, except the search is filtered
to only consider good connections and components.  This is useful
for a quick check if the search can possibly succeed.

Files Changed: argtyp-auto.lisp, ms98-top.lisp, ms98-jform.lisp,
               ms98-macros.lisp, ms98-unif.lisp
=======================================================================
CEB		PARITY1				 12th Apr 2000

Updated help for PARITY1 to better describe the
heuristic for this value of REWRITE-EQUALITIES.

Files Changed: argtyp.lisp, wffabb.lisp
=======================================================================
CEB		CONTEXTS			 12th Apr 2000

Put nat-etree and pfnat back into etr-nat ("Proof Translations") context.
Added new context search-analysis and put build-corresponding-mating,
make-eproof-canonical and save-canonical into this context.

Files Changed: contexts-auto.lisp, ceb-nat-etr.lisp, auto.exp
=======================================================================
CEB		MEASUREMENTS			 19th Apr 2000

Installed a new flag MEASUREMENTS in the subject library.
This flag is set by the system to indicate some measures
of complexity of the last problem TPS tried to prove automatically
(number of vertical and horizontal paths, number of literals,
number of acceptable connections).

(For now this is only implemented for MS98-1.)  The flag
RECORDFLAGS should include MEASUREMENTS so that daterec
will record the information.

Files Changed: auto.exp, ms98-top.lisp, ms98-macros.lisp
=======================================================================
CEB		MEASUREMENTS			 27th Apr 2000

Elaborated help for MEASUREMENTS to include description of
what it measures.  Also, changed its type to symbol-data-list
which is now an argtype (along with symbol-data-pair) defined
in argtype-auto.lisp.  These argtypes are exported.

Files Changed: ms98-macros.lisp, argtype-auto.lisp, auto.exp
=======================================================================
CEB		HELP HELP			27th Apr 2000

Added reference to the web site to the help message for help.

Files Changed: mhelp.lisp
=======================================================================
CEB		LIB CONTEXTS			3rd May 2000

Broke up 

EDITING: change-provability check-needed-objects copy-libdir copy-libfile 
     copy-libobject create-lib-dir create-lib-subdir delete delete-lib-dir
     delete-libfile fix-modes import-needed-objects insert move-libfile 
     move-libobject reformat reindex rename-libdir rename-libfile 
     rename-object sort spring-clean

into

LIBRARY-STRUCTURE
 copy-libdir copy-libfile 
     create-lib-dir create-lib-subdir  delete-lib-dir
     delete-libfile   move-libfile 
rename-libdir rename-libfile 

EDITING
 change-provability check-needed-objects
 delete fix-modes import-needed-objects insert 
     copy-libobject move-libobject reformat reindex 
     rename-object sort spring-clean

Files Changed: contexts-core.lisp, library2.lisp, core.exp
=======================================================================
CEB		LIST-RULES*			7th May 2000

Installed new command list-rules* for ETPS and TPS.
This lists the rules with their intermediate rule
definitions, omitting those with no priority
(i.e., the rules that list-rules gives priority 99).

Files Changed: otl-help.lisp, core.exp
======================================================================
CEB		BASE-TYPE			10th May 2000

Changed default of BASE-TYPE to I in file wffinm.lisp.
======================================================================
CEB/PA		Y2K problem with DONE           17th May 2000

Changed status-date function in boot0.lisp to subtract
2000 from the year instead of 1900.

Files Changed: boot0.lisp
======================================================================
CEB		FIXED URL 			17th May 2000

The ?? command in TPS and ETPS now says:
 Manuals for TPS and ETPS, in Postscript or HTML form, are available at
 http://gtps.math.cmu.edu/tps.html

intead of the old web site
 http://www.cs.cmu.edu/~andrews/tps.html

Files Changed: mhelp.lisp
======================================================================
CEB		HTML-DOC                        17th May 2000

Ran html-doc in ETPS again, because last time the html documentation
for ETPS must have been generated from TPS (since it was the same as that
for TPS).  Note that to run html-doc in ETPS, I had to load the
htmldoc.lisp file and call maint::html-doc.
This is probably because the AUTO-DOC module is not included in ETPS.
It probably should be included.
=======================================================================
CEB		NAT-ETREE                       22nd May 2000

Added code to the ceb and hx versions of nat-etree
to do the final mating search and merging
(the old version already did this).  So, one can
simply run nat-etree, then etree-nat to translate
a natural deduction proof to an expansion proof
and back.  A command nat-etree-old doesn't
do the final mating search and merging, in case
we want this.

Files Changed: ceb-nat-etr.lisp, hx-natree-top.lisp, auto.exp
=======================================================================
CEB		RULEC				25th May 2000

Changed the nat-ded tactic rulec-tac (in ml-tactics-quant.lisp)
to use the existentially quantified variable as the default
instantiation variable, unless this would not be a legal
application of RULEC, in which case it offers a renamed
variable as default.  As a consequence, GO2 and MONSTRO
will have these as the default instantiation variable
when applying RULEC.

There is still no default when using the inference rule
RULEC, since the rules package doesn't appear to support
such defaults.  As a consequence, GO will still not have
any default when applying RULEC.

Files Changed: ml-tactics-quant.lisp 
=======================================================================
CEB		PRIMSUB BUG			26th May 2000

Fixed a bug with the way primsubs were generated.
The function dont-apply-prim-subs was returning a list
of list of (<Exp Var> . primsub list) pairs instead of
a list of such pairs.  Fixed this and fixed some called
that calls the function to correspond.

The following is an example of the bug:

mode MODE-THM532-2

<10>mate thm532
. . .
<Mate11>name-prim

Var:   s^0(O(OB))

     PRIM0   LogConst     LAMBDA w^1(OB).s^1(O(OB)) w^1 AND s^2(O(OB)) w^1
     PRIM1   LogConst     LAMBDA w^1(OB).s^3(O(OB)) w^1 OR s^4(O(OB)) w^1
        . . .

<Mate12>prim-single
SUBST (GWFF):  [No Default]>prim0
VAR (GWFF):  [No Default]>"s^0(O(OB))"


<Mate13>go
Error: Attempt to take the car of #S(EXP-VAR :BOGUS-SLOT NIL :VAR #:|s^1<O<OB>>| :SUBST #:|s^1<O<OB>>| :SELECTED (F^0<B<OB>> X^0<OB>)) which is not listp.
  [condition type: SIMPLE-ERROR]

If you try to do this example now, you will see that this bug is fixed, but
there is another (Error: Non-structure argument NIL passed to structure-ref).
See the bugs file HACK-PRIMSUBS-ABOUT-BUG.

Files Changed: etrees-wffops2.lisp, nat-etr.lisp, ms91-search.lisp, ms98-dups.lisp
=======================================================================
CEB		MS98-TRACE			26th May 2000

Changed the flag MS98-TRACE to be a list of symbols
(indicating what to trace) rather than a symbol of MS98-TRACE-TYPE.
Also, fixed a bug by making sure that the global GIVEN-CLIST is
always defined.  The following is a record
of how the bug would occur:

2000 May 25
mode  MS98-HO-MODE
REWRITE-DEFNS [(EAGER (NONE ZERO SUCC))]
PROVE TTTP6101
DIY
...
Now merging 10 current and 170 atomic components, with 18 stored.
..........
Error: Attempt to take the value of the unbound variable `AUTO::GIVEN-CLIST'.
  [condition type: UNBOUND-VARIABLE]

Restart actions (select using :continue):
 0: Try evaluating AUTO::GIVEN-CLIST again.
 1: Set the symbol-value of AUTO::GIVEN-CLIST and use its value.
 2: Use a value without setting AUTO::GIVEN-CLIST.
[1] USER(1):


Files Changed: ms98-dups.lisp, ms98-jform.lisp, ms98-macros.lisp, ms98-top.lisp, ms98-unif.lisp,
     auto.exp, argtyp-auto.lisp
=======================================================================
CEB		UPDATE-LIBDIR			29th June 2000

Created a new library command UPDATE-LIBDIR.
UPDATE-LIBDIR can be used to update a (common) library directory
by copying any object from a directory DEFAULT-LIB-DIR or BACKUP-LIB-DIR
into the (common) library directory, if it is not already there.
Before updating from a library directory, the user is asked whether
to update from this directory.  This is so one can choose a collection
of library directories to combine into the common destination directory.

This has the same effect of calling COPY-LIBDIR with copying from
each (chosen) directory in DEFAULT-LIB-DIR and BACKUP-LIB-DIR
into the (common) destination library directory.

Also, I ran this to update the common library directory.

Files Changed: library2.lisp, core.exp
=======================================================================
CEB		LIBRARY DOC			19th July, 2000

Added a reference to the
distributed library directory 
in Chap 6 of User's Manual.

Files Changed:  user/manual.mss
=======================================================================
CEB		REMOVING ASSERTS		31st July, 2000

Created a command MAKE-ASSERT-A-HYP to change a line
justified by Assert into a Hyp, removed at the end
by Deduct.  This is useful for when we want to translate
an ND-proof into an expansion tree proof, since the
translation cannot handle Asserts.

Files Changed:  otl-rearrange.lisp, core.exp
=======================================================================
CEB		NEW SLOTS IN EPROOF		31st July, 2000

Added two new slots to the eproof structure:
inst-exp-vars-params : alist of (instantiated) exp-var's 
                and the sel vars that occur in their instantiation
all-banned : alist of exp-vars and sel vars whose selection node
     occurs beneath the expansion term
We need these so the acyclicity check can account for the fact
that instantiated exp-vars (from primsubs) may contain selection
variables.

Rebuilt TPS on gtps and htps (and emptied the patch file)
so that these new slots can be used.

Files Changed: etrees-flags.lisp
=======================================================================
CEB			WEB SITE			Aug 6, 2000

Put cade-17 papers on TPS web site

Added to "Other Theorem Proving Links" on the TPS web site:
Mizar Site      http://mizar.org
AAR		http://www-unix.mcs.anl.gov/AAR/
Cade		http://www.cs.albany.edu/~nvm/cade.html

Files Changed: html/tps-papers.html, html/tps-links.html
=======================================================================
CEB			PROG GUIDE			Aug 9, 2000

revise organization of flavors in programmer's manual
Move section 6.10 to Chapter 5; 
  change title to Flavors and labels of gwffs
Also added section on dependency relation.

Files Changed: prog/*.tex
=======================================================================
CEB			BUILDING ETPS ON ANDREW		Aug 25, 2000

built etps for  sun4x_57 on unix12andrew.cmu.edu

Had to include :allegro-v5.0.1 wherever :allegro-v5.0 appeared.

Files Changed: boot0.lisp, tops20.lisp, tps3-save.lisp, core.exp
=======================================================================
CEB			DEPENDENCIES BETWEEN FLAGS	Aug 30, 2000

Added four new slots to flags which allows defflag to specifies
when some flags make other flags relevant/irrelevant.  TPS now
warns the user when he sets a flag that is irrelevant due to
the value of some other flags.  Also, wrote a new command
UPDATE-RELEVANT which allows the user to set a flag and
then prompts the user to also set related flags which are relevant.
Included a new section in the Programmer's Guide chapter on flags
describing this.

Currently the dependencies are only included for MS98-1 related
flags.

Files Changed: core.exp, flagging.lisp, review.lisp, ms98-macros.lisp, 
    mating-top.lisp, doc/prog/flags.tex
=======================================================================
CEB			TEX/DIRECTORY STRUCTURE		Sept 11, 2000

Found an old reference to /afs/cs/project/tps/tps/doc/lib.
Changed to  /afs/andrew/mcs/math/TPS/doc/lib.

Files Changed: otl-scribeout.lisp
=======================================================================
CEB			FLAG RELEVANCY PRIM-BDTYPES     Oct 2, 2000 

Added relevancy info to defflag PRIM-BDTYPES-AUTO to reflect the
fact that the flag PRIM-BDTYPES is only relevant under certain
settings of PRIM-BDTYPES-AUTO.

Files Changed: prim-edops.lisp
=======================================================================
CEB			NEW EPROOF SLOTS		Oct 2, 2000

Added two new eproof slots for use with the (yet to be
  released) PRIMSUB-METHOD PR00:
dissolve - list of connections to be dissolved from the jform
allow-nonleaf-conns - list of (nonleaf) node names to be included
    in the jform

Rebuilt TPS on gtps and htps in order to start using these slots.

Files Changed: etrees-flags.lisp
=======================================================================
CEB			PROG GUIDE			Oct 6, 2000

Added new information to the chapter on Mating Search in
the Programmer's Guide, including informatin about expansion
proof slots, global variables regarding expansion trees,
and information about the code that does the deepening
of expansion trees.

Files Changed: prog/mating.tex
=======================================================================
CEB			PROG GUIDE			Oct 16, 2000

Updated the section "Checking Acyclicity of the Dependency Relation".
In this section, we prove an equivalence between
Miller's dependency relation and a dependency relation relative
to a unification substitution (which corresponds to the way
TPS actually checks acyclicity).  Previously, these results
depended on the assumption that every expansion variable was
introduced in a unique expansion term.  This assumption has
now been dropped, strengthening the results.

Files Changed: prog/mating.tex
=======================================================================
CEB			ETPS RULEP BUG			Oct 28, 2000

There was a bug with RuleP in ETPS.  The function "generate-a-fixed-name-for"
was called from "find-cheapest-rulep-path", though "generate-a-fixed-name-for"
was defined in mating-paths.lisp (not loaded by ETPS).  So, I moved
the function into newrulep-tsts.lisp with "find-cheapest-rulep-path".
I also had to dynamically bind LEAF-NAME because ETPS does not
bind LEAF-NAME.

Files Changed:  mating-paths.lisp, newrulep-tsts.lisp
=======================================================================
CEB			EXPERTFLAG/CHANGE-FN		Oct 29, 2000

In etps, any user could set expertflag to T because
update-flag in review.lisp calls 'CHANGE-FN after setting
the flag (due to a change Hongwei made in Feb. 1994, documented
in the tpsjobs-done file).  I added a new slot PRE-CHANGE-FN
for flags which is called before the flag is set.  Now,
EXPERTFLAG has a PRE-CHANGE-FN which checks the expert list.

Files Changed:  flagging.lisp, review.lisp, maint.lisp, core.exp
=======================================================================
CEB			MS98 UNIFY-MSV BUGS		Oct 30, 2000

There were a couple of bugs showing up when finish-up-ccs called
UNIFY-MSV.  The example was EXT1 in mode MODE-EXT1-BUG.

First, if the unification tree had sons, the msv slot is not
set (because finish-up-ccs uses unify-old to build the tree).
But then, if either MAX-SUBSTS-PROJ or MAX-SUBSTS-PROJ-TOTAL was non-NIL,
unify-msv tried to use this slot.  I changed the code to check if
the slot is set before trying to use it.

Second, a node in the utree might be a failure node (fail in the
terminal-flag slot) with no dpairs.  UNIFY-MSV was calling
simpl on the (empty) dpairs of such a node and returning it
as a success node.  I added a check for failure nodes before
calling simpl.

Files Changed:  unif-tree.lisp
=======================================================================
CEB			MERGING DOCUMENTATION		Nov 9, 2000

Moved the section on Merging from the Mating Search chapter
to be a chapter on Merging in the Programmer's Guide.
Extended this to document the different stages of merging
and the functions involved.

Files Changes: prog/manual.tex, prog/mating.tex, prog/merging.tex
=======================================================================
CEB			TPS-INIT BUG			Nov 15, 2000

Fixed a minor bug using remove-duplicates in tps-init.

Files Changed: maint.lisp
=======================================================================
CEB			SHOW*-WFF			Nov 16, 2000

Created a new library command SHOW*-WFF which shows the definition
for a gwff or abbreviation, its help message, and recursively
shows the same for its needed objects (if any).  Also, fixed a bug
in SHOW-WFF&HELP that prevented it from showing abbr's as
well as gwff's (retrieve-libitem was not failing gently).

Files Changed: library1.lisp, core.exp
=======================================================================
CEB			SHOW*-WFF			Nov 18, 2000

Made some minor modifications to the output given by show*-wff.

Files Changed: library1.lisp
=======================================================================
CEB			REBUILD				Nov 21, 2000

Rebuilt TPS on htps and gtps, and cleared out the patch file.
=======================================================================
CEB			TEST-INIT			Nov 24, 2000

Changed test-init to set test-theorems to all (THM . BESTMODE)
examples with the quickest examples first and the examples which
take the longest to run last.

Files Changed: maint.lisp
=======================================================================
CEB			MERGING DOC			Nov 25, 2000

In order to fix a bug in prettify, I separated the cleanup-etree
phase of merging from the prettify phase.  This code will be
included in a soon-to-be-released batch of code.  For now,
I have updated the Programmer's Guide to reflect the change.
In the new section of prettify, there is a theory of renamings
and a proof that if the renamings satisfy two conditions then 
they avoid variable capture.

Files Changed: prog/merging.tex
=======================================================================
CEB			RELEASE OF NEW CODE		Dec 1, 2000

Released a great deal of new code implementing PR00
primsub-method, dissolution in jforms, some changes 
to nat-etree, changes allowing nonleaf nodes to be mated,
changes in the way acyclicity is checked,
changes to merging, and bug fixes.  These are described in more
detail in separate entries below.  

I also rebuilt tps on gtps and htps.
=======================================================================
CEB			MS98 BUGS			Dec 1, 2000

MS98 had trouble with Rewrite [REFL=] -> TRUE nodes.
(For example, trying to prove "a = a" led to an error!)
Fixed this bug by setting active-mating to (init-mating) in finish-up-ccs.

MS98-TRACE sometimes had a problem when a symbol was sent to equal-conn
instead of a literal.  I changed this so either a symbol or literal works.

Files Changed: ms98-top.lisp
=======================================================================
CEB			JUNCTIVE SLOT BUG		Dec 1, 2000

The junctive slot of TRUE & FALSE nodes was not set in many
places.  Fixed these.  We may not need TRUTHVALUES-HACK or ADD-TRUTH
anymore after this fix.

Files Changed: hx-natree-duplications.lisp, symsimp2.lisp, nat-etr.lisp,
      ml-etr-tactics-pline.lisp, ml-etr-tactics-symsimp2.lisp
=======================================================================
CEB			UNIFY-MSV BUGS			Dec 1, 2000

MSV Bug:  There was a problem with the MSV slot
when the final utree has sons and either
MAX-SUBSTS-PROJ or MAX-SUBSTS-PROJ-TOTAL is not NIL.
Modified the code to check if the slot is nil before
trying to use it.

Another unify-msv bug:  Wasn't checking that a son
was not already a failure node before calling simpl,
which sometimes caused a child of a failure node
to be incorrectly returned as a success node, since
it had no dpairs.

Files Changed: unif-tree.lisp
=======================================================================
CEB			MERGING BUGS			Dec 1, 2000

There were bugs with prettify leading to variable capture.
I separated the cleanup & the prettify phases of merging,
completely rewriting prettify in a way that is very careful
to avoid variable capture when renaming variables.
I also commented out the call to randomvars
which made some bugs hard to reproduce.

Remove-Leibniz was not setting :positive t in the
second rewrite in check-shallow-formulas.

Sometimes during cleanup, the newshallow for a REFL=
rewrite node was not of the form A = A.  Dealt with
this by adding intermediate rewrites when necessary.

Files Changed:  mating-merge.lisp, mating-merge-eq.lisp
=======================================================================
CEB			MODE				Dec 1, 2000

Changed the mode command to set all 'important' flags
not set by the mode to their default values.  This came
up mainly because several old modes do not set MAX-SUBSTS-VAR,
and MAX-SUBSTS-VAR really needed to be NIL for the mode to work.
Now, whenever a new subject is created that contains flags
important for automatic search, they should be included on
the list in the function mode in flagging.lisp

Files Changed: flagging.lisp
=======================================================================
CEB			NONLEAF CONNS			Dec 1, 2000

Changed the code to allow nonleaf connections.  First, we include
literals for the nodes we want in the jform.  Which nodes are included
is determined by the values of the flags ALLOW-NONLEAF-CONNS and DISSOLVE,
and the slots allow-nonleaf-conns & dissolve of current-eproof.

Merging had to be changed to allow for such connections.  In particular,
remove-leibniz and raise-lambda-nodes may need to modify connections
to nodes that are destroyed.  (This is described in the Programmer's Guide.)

Finally, the translation process had to be modified to copy support
lines (and other changes suggested by Frank's thesis) that correspond 
to mated nonleaf nodes.  This included creating a new tactic
DUPLICATE-SUPPORT-TAC based on Pfenning's Tactic 183.
The check that a list of connections spans parts of 
the etree had to be modified too.

Files Changed:  mating-merge-eq.lisp, mating-merge.lisp,
    mating-merge2.lisp, hx-natree-aux.lisp, etrees-jforms.lisp,
    ms98-unif.lisp, ms98-rewrite.lisp, ml-etr-tactics-book.lisp,
    ml-etr-tactics-eq.lisp, ml-etr-tactics-main.lisp,
    ml-etr-tactics-sline.lisp, ml-etr-tactics-pline.lisp
=======================================================================
CEB			DEEPENING			Dec 1, 2000

Wrote dual-p to test when a rewrite is a dual instantiation node.
Modified deepening to make sure the left child of the conj or disj
beneath such a rewrite is not deepened (remains a leaf).
Added comments to deepening code.

Files Changed: etrees-wffops.lisp
=======================================================================
CEB			PR00				Dec 1, 2000

Implemented a new primsub-method PR00 which finds set variable
substitutions (setsubs) by solving part of the problem.
For now, it only uses the method of connecting two nodes
and finding a setsub by unifying.  This process can be iterated.
Eventually, it should include other methods, such as finding
solutions to maximal/minimal/closure constraints.  We also
use ftrees to create the etree that will be searched upon,
and dissolution to dissolve the assumed connections from the
jform before search begins.  Since these setsubs can contain
selected variables from elsewhere in the tree (something that
has never happened with PRIMSUBS), checking acyclicity became
more difficult.  This was changed as described in another entry
in the tpsjobs-done file, and in the Programmer's Guide.

PR00 can be used to prove some induction examples:
THM578, THM579, THM581, THM582, THM583, THM584, THM587.

Modified NAME-PRIM to work with PR00.  This generates a collection
of instantiated & deepened etrees (rather than primsubs) with names.
One can use SET-SEARCH-TREE to choose one of these (as opposed to
instantiating with PRIM-SINGLE).

Files Changed: prim.lisp, ms98-dups.lisp, etrees-wffops2.lisp,
     ms98-macros.lisp, defpck.lisp
Files Created: pr00.lisp (in module primitive-subst)
=======================================================================
CEB			ACYCLICITY			Dec 1, 2000

Before, all we needed to do is check the substitution
generated by unification.  Now, since setsubs can contain
selected and expansion variables that occur elsewhere in
the tree, we must check both the setsub
from pre-processing and the unifier.  The method is described
in the Programmer's Guide.  This uses new eproof slots:
all-banned and inst-exp-vars-params.

Files Changed: ms90-3-unif-simpl.lisp, etrees-renumber.lisp, 
      option-tree-aux.lisp, ms98-top.lisp, ms98-dagify.lisp,
=======================================================================
CEB			FTREES/SAVING ETREES		Dec 1, 2000

Ftrees are a new "functional" representation of etrees.  In particular,
operations are not destructive, there are no circular references, and
minimal information at each node.  These are much easier to manipulate
using recursive algorithms.  There are translations between ftrees & 
etrees.  These are used by PRIMSUB-METHOD PR00 when creating instantiations
involving set variables along with connections which are to be
dissolved.

We can also use ftrees to save etrees to a file and restore them
using the mate operations SAVE-ETREE and RESTORE-ETREE.

Files Changed:  defpck.lisp
Files Created:  ftrees.lisp (in module expansion-tree)
=======================================================================
CEB			JFORMS				Dec 1, 2000

There were some problems with generating normalized jforms.
So, I wrote a normalize-jform function which does the normalization
after generating the jform.  

Created literals for nonleaf nodes, depending on the
values of the flags ALLOW-NONLEAF-CONNS and DISSOLVE,
and the slots allow-nonleaf-conns & dissolve of current-eproof.

Implemented dissolution for a jform given a connection.  
Jforms dissolve connections listed in the flag DISSOLVE 
and those listed in the dissolve slot of current-eproof.

Files Changed: etrees-jforms.lisp, 
=======================================================================
CEB			NAT-ETREE			Dec 1, 2000

Made annotations and coercion steps in natree explicit.  Also,
made use of nonleaf connections when appropriate.
Also, fixed some minor problems with etr-auto-suggest.
Updated the Programmer's Guide to reflect the fact that
we use nonleaf connections now.

Files Changed: ceb-nat-etr.lisp, hx-natree-top.lisp,
         etrees-auto-suggest.lisp
=======================================================================
CEB			TESTING				Dec 1, 2000

Made bestmodes for each example in the aliases test-short, test-long,
etc. so that test-init subsumes all of these (except
THM112A MODE-THM112A-TRY4, which should not be in the test suite).
=======================================================================
CEB			PRETTIFY			Dec 1, 2000

Minor modification to prettify to make it more likely that
selected vars will be the same as bound vars.

Files Changed: mating-merge-eq.lisp
=======================================================================
CEB			SCRIBE LIB FILES		Jan 16, 2001

Found some scribe files in doc/lib that referred to the old
/afs/cs directory structure.  I updated them.  The files
are:  tpkdoc.lib tpldoc.lib tpmdoc.lib tpqdoc.lib tprdoc.lib
=======================================================================
CEB & PBA 		ETPS RECORDS ACCESS		2001 January 25  
Changed access to 
/afs/andrew.cmu.edu/mcs/math/etps/records to
  pa01:tps rlidwka
  system:authuser rliw
  pa01 rlidwka
Note that system:authuser rliw has no deletion rights.
	Changed code so that when etps creates a directory such as 
/afs/andrew.cmu.edu/mcs/math/etps/records/guest004,
the access is 
  pa01:tps rlidwka
  pa01 rlidwka
  guest004 rliw
File: /afs/andrew.cmu.edu/mcs/math/etps/common/etps.ini 
========================================================================
CEB			NNF RULES			2001 Feb 16

Created two new natural deduction rules: NNF & NNF-Expand.
NNF allows one to infer the negation normal form of a wff A from A.
NNF-Expand allows one to infer a wff A from its negation normal form.

Files Changed: ml1-logic3a.rules, ml.exp
========================================================================
CEB			COMMON LIBDIR			2001 Feb 27

Rebuilt common lib directory.
========================================================================
CEB			ELIMINATING RULEP		2001 Mar 3

Created new commands eliminate-conj*-rulep-apps,
eliminate-all-rulep-apps, and eliminate-rulep-line.
These commands can be used to replace an application of
RuleP (or other propositional rules: 
Assoc (Assoc-Left), EquivConj (in favor of EquivImplics),
Imp-Disj-L, Imp-Disj-R, Imp-Disj, Disj-Imp-L, Disj-Imp-R, 
and Disj-Imp) with basic propositional rules.  This may
bring many proofs much closer to being normal, so that
nat-etree can be applied.

Part of this involved creating a new tactic BASIC-PROP-TAC
which translates a propositional expansion proof into
a natural deduction proof using only basic propositional rules.

Files Changed: ceb-nat-etr, ml-etr-tactics-main, auto.exp, ml.exp
========================================================================
CEB			CONNECTIONS UP TO NNF		2001 Mar 3

We can now make connections when formulas are complementary up
to NNF (we could already do this up to AB).  This involved the
following changes:

When creating a jform, if a nonleaf node is to be included
as a literal, put the formula into negation normal form. 
We make the literal positive or negative so as to ensure
EXISTS/OR is the outer quantifier/connective.

Changed first-order-problem-p to return NIL if ALLOW-NONLEAF-CONNS is
non-NIL, because we need higher-order unification to unify
compound formulas.

Created a new NNF-TAC to handle the translation to a natural
deduction proof, and included this in COMPLETE-TRANSFORM-TAC
and PFENNING-TAC.

Files Changed:  ml-etr-tactics-main, ml-etr-tactics-book,
   etrees-jforms, hx-natree-aux, mating-aux
========================================================================
CEB			MS98 NONLEAF CONNS		2001 Mar 3

Had to change ccs-place-neg to treat outermost quantifiers
as rigid heads.  Fixed a bug in similar-paths --
it mistaking nonleaf literals for duplicate literals coming
from quantifier duplication.

Files Changed: ms98-unif, ms98-jform
========================================================================
CEB			TRANSLATION BUGS		2001 Mar 3

The support line tactics PUSHNEG-SHORT and UI-SHORT had a bug
arising when the planned line the tactic is using is not
the first planned line in the proof-plans slot.  A call
to subproof fixes this.  Also, changed DUPLICATE-SUPPORT
to look beneath the kids of negation nodes, because the
negation may have been added, for example, by an application
of INDIRECT.  

Some problems with the negation tactics when dealing
with nonleaf matings showed up.  Whenever a negation
tactic is applied to a support line, we should immediately
apply an introduction rule to the new planned line
(see Pfenning's thesis, Tactics 214-220).  But the
introduction tactics were being blocked when the
new planned line is part of the mating.  An easy
fix is to mark the new planned line as a 'duplicate
(since the original line is still part of the support,
the new planned line is, up to negation, a duplicate
of the support line).

The function for checking if the rulep tactic applies
has been changed to deal with nonleaf connections.
Note that in this case we do NOT allow mating up
to NNF, since NNF may involve pushing negations past
quantifiers.  The function lines-to-rulep-jform 
creates a jform appropriate for checking if rulep applies.

Files Changed:  ml-etr-tactics-sline, ml-etr-tactics-neg,
  ml-etr-tactics-book, ml-etr-tactics-main, ml-etr-tactics-pline
========================================================================
CEB			GET-DEEP BUG			2001 Mar 3

The function get-deep was not handling expansions correctly.
The old way, it checks if the junctive slot is DIS or CON,
and makes a disjunction or conjunction, resp.  However,
The junctive property of an expansion is ALWAYS CON, so
it was always making conjunctions.  This gives the
wrong deep formula in some examples.  Consider the example
"exists x P x".  If we form an etree and duplicate the expansion
var, get-deep gave the deep formula "P(OI) x^0(I) AND P x^1(I)"
where the AND should be an OR.

The new way, if the expansion node is positive, it makes a conjunction.
If it is negative, it makes a disjunction.

Files Changed: etrees-labels
========================================================================
CEB			CONNECTION-FLATTENLIST BUG	2001 Mar 3

The function connection-flattenlist is sometimes called with
a list of numbers (representing connections) and
sometimes with the pairs that represent the connections.
But it was written assuming it always gets numbers, causing
a bug.  This showed up trying to prove
"~[FORALL x P x] implies ~[FORALL x P x]"
automatically where ALLOW-NONLEAF-CONNS is (ALL)
so we can mate the two universal formulas.

Files Changed: connections
========================================================================
CEB			NEW OPERATIONS ON FTREES	2001 Mar 3

Added some new functions for getting selected variables/skolem terms
from the ftree.  Substitution now throws 'cycle if the substitution
leads to a cycle in the dependency relation.  Also, made some changes
in the way skolems are handled.

Files Changed: ftrees
========================================================================
CEB			MERGING BUG			2001 Mar 3

When an expansion has no children, merging changes it to a leaf.
But if the expansion occurred in the mating (since we now allow
nonleaf conns), we need to change it to be the new leaf.
This is now done in replace-non-leaf-leaves.

Files Changed: mating-merge
========================================================================
CEB			MODE BUG			2001 Mar 3

If the value of TRUTHVALUES-HACK is changed, the
change-fn changes the defn of NULLSET.  Mode has been
changed to set all (important) flags to their default
value, but it wasn't calling the change-fn.
As a result, TRUTHVALUES-HACK could be set to NIL by
a mode without changing the defn of NULLSET back to
"lambda x FALSEHOOD".  This caused a problem translating
the proof of BOOL-PROP-114.  I fixed it by having
mode call the change-fn of a flag when setting it to
its default.

Files Changed: flagging
========================================================================
CEB			TEST-INIT			2001 Mar 11

Changed TEST-INIT to check that the theorems in the list it
generates are in an accessible library.  They are left out
if they are not accessible.

Files Changed: maint.lisp
========================================================================
CEB			RESTOREPROOF			2001 Mar 11

Changed the defsavedproof macro used by restoreproof
so that the abbreviations get defined before the lines
are parsed.

Files Changed: saveproof.lisp
========================================================================
CEB			PROG GUIDE			2001 Mar 11

Added items about using definfo and adding new subjects to
the list in the definition of the function mode.
These items are part of the list 

  Writing New Code Without Making A Nuisance of Yourself

Files Changed: doc/prog/intro.tex
========================================================================
CEB			USER MANUAL			2001 Mar 11

Added brief note to user manual, Chapter 6 (about the library),
in "File Maintenance" section, explaining how to create and
maintain a common library directory using UPDATE-LIBDIR.

Files Changed: doc/user/manual.mss
========================================================================
CEB			USER MANUAL			2001 Mar 16

In the "Initialization" subsection where tps3.ini is discussed,
added the fact that a local tps3.ini file is loaded only
when EXPERTFLAG is T.

Note that if EXPERTFLAG is NIL, then it still loads the common
tps3.ini, although quietly.

Files Changed: doc/user/manual.mss
========================================================================
CEB			SILENT LOAD			2001 Mar 26

Made Silent Load depend on an environment variable TPS_SILENT.
To use silent load, first do "setenv TPS_SILENT T".
========================================================================
CEB			COPYING BESTMODES		2001 Apr 2

COPY-LIBDIR and UPDATE-LIBDIR were not merging the bestmodes
properly to form the common library directory.  This was fixed
by simply including (output-bestmodes-to-file) in copy-libdir-work.

I made the change and rebuilt the common library using UPDATE-LIBDIR.

Files Changed: library2.lisp
========================================================================
CEB			SAVEPROOF			2001 Apr 12

I changed prove to save the name of the gwff, if, for example,
the gwff is given by giving its name as a gwff in the library.
This is associated with the proof.  Saveproof saves this
property (which is NIL if the gwff was not given as a name),
and restoreproof restores this property.

This allows us to determine which gwff in the library a
saved proof proves.

Files Changed: otlnl.lisp, saveproof.lisp
========================================================================
CEB			SCAN-SETSUBS UTILITY		2001 Apr 12

Put files scan-setsubs.lisp and scan-setsubs.doc in the utilities
directory.  The function scan-setsubs takes a list of proof files
and determines which proofs use setsubs (which involve some
logical connectives, quantifiers, or equality).
========================================================================
CEB			KEYWORD FILTERS			Apr 18, 2001

Created new argument types keyword-prop and keyword-list.
keyword-list is the argument type for the filter argument
of the library commands SHOW-ALL-WFFS, TEX-ALL-WFFS, and
SCRIBE-ALL-WFFS.  The argument type used to be 
gwff-prop-list, which hardwired some of the 

Also, wrote a central function keyword-filter used to
decide if a library item has the property associated
with the keyword.

Files Changed: argtyp.lisp, library1.lisp, core.exp
========================================================================
CEB			SCAN-SETSUBS EXAMPLE		Apr 18, 2001

Included an example of how to use the scan-setsubs utility
in the scan-setsubs.doc file.

Files Changed: scan-setsubs.doc
========================================================================
CEB			TRUTH RULE			May 6, 2001

Created a new inference rule ITRUTH to infer a line with
assertion TRUTH.  Previously we could only make this inference
with RuleP, which caused problems when we wanted to eliminate
applications of RuleP.  I also changed the tactic TRUTH-TAC
to use the ITRUTH inference rule instead of RuleP.

Files Changed: ml2-logic1a.rules, ml-etr-tactics-pline ml.exp
========================================================================
CEB			PR00 UPDATE			May 6, 2001

Released a new version of the pr00 code.  PR00 uses unification
to suggest set substitutions.  An alias "test-pr00" sets test-theorems
to be a list of examples using PR00.

Files Changed: pr00.lisp, prim.lisp, etrees-wffops2.lisp, ms98-dups.lisp
========================================================================
PBA & CEB		ASCII RENAMED			May 23, 2001

Changed ascii to tps-ascii because Allegro 6.0 complained.

boot0.lisp:(defmacro ascii (int) `(code-char ,int))
core.exp:    setdiff  ascii  flatc 
core.exp~:    setdiff  ascii  flatc 
tpinf.lisp:       ((tconstp (intern (string (ascii nexttvarc)) *user*))
tpinf.lisp:    (setq nxvar (intern (string (ascii nexttvarc)) *user*))
tpinf.lisp:       ((tconstp (intern (string (ascii nexttvarp))))
tpinf.lisp:    (return (intern (string (ascii nexttvarp))))))
vpforms.lisp:    (if (memq style '(ascii concept concept-s generic xterm sail scribe))
vpforms.lisp:              ((ascii concept concept-s) 78)
wffing.lisp:       (bytestream nil (cons (intern-str (string (ascii byte))) bytestream)))
wfftyp.lisp:                (not (tconstp (intern (string (ascii nexttvarp))))))
wfftyp.lisp:           (intern (string (ascii nexttvarp)))))

Files: boot0.lisp, core.exp, tpinf.lisp, vpforms.lisp, wffing.lisp, wfftyp.lisp
========================================================================
CEB			FTREES IN PROG GUIDE		July 6, 2001

Added a section to the Programmer's Guide briefly discussing
ftrees.
========================================================================
CEB			CUT ELIM IN PROG GUIDE		July 6, 2001

Added sections to the Programmer's Guide (in the chapter on
Proof Translations) about cut elimination.  This includes
an example showing a loop if we try to have eliminate
"Cut" nodes from an expansion tree, a description of
the new implementation of a sequent calculus (ftree-seq)
and cut/mix elimination for this sequent calculus.
========================================================================
CEB			CEB-NAT-ETR IN PROG GUIDE	July 6, 2001

Updated description of my version of nat-etree in the Programmers
Guide to reflect recent changes (eg, eliminating RuleP, cut elimination,
etc.).
========================================================================
CEB			ACL 6.0				July 10, 2001

Added (force-output) after (princ) in linereadpp,
but only for Allegro 6.0:

  (princ prompt output-stream)
#+:allegro-v6.0
  (force-output)

Otherwise the prompt doesn't show up appropriately
because streams are handled differently in Allegro 6.0
than in previous versions.	

Files Changed: linereadp.lisp
========================================================================
CEB			NAT-ETREE			July 10, 2001

Implemented an updated version of the CEB version of
NAT-ETREE which uses a sequent calculus and cut elimination
algorithm.  The code for the sequent calculus and cut/mix elimination
is in ftree-seq.lisp.  This file also contains code for
translating from the sequent calculus to ftrees with complete matings.
In addition to cut elimination, the file contains code to
modify a sequent calculus derivations so that the weaken
rule is applied eagerly - this may eliminate unnecessary cuts
before full cut elimination is called.  The sequent calculus
and cut/mix elimination implemented in the code is described
in the Programmers Guide.

The code to translate an annotated natree into a sequent
calculus derivation is in the new file ceb-nat-seq.lisp.
The idea for the mutually recursive algorithm is
described in the Programmers Guide.

Finally, I made a few changes to pre- and post-processing
associated with NAT-ETREE.  It now automatically eliminates
applications of RuleP and related propositional
rules (using ELIMINATE-ALL-RULEP-APPS implemented
earlier this year), automatically removes applications of
Subst= and Sym=, and even tries to eliminate applications
of RuleQ.  If there are any Assert's other than Refl= in
the proof, these are changed to be hypotheses which
are discharged at the end of the proof.  The new proof
is given a different name so that the old proof remains
unmodified.  After the translation has finished (successfully),
the user is given the option of merging the tree.
(The command NAT-ETREE used to automatically merge
where NAT-ETREE-OLD didn't.  NAT-ETREE-OLD no longer exists.)

The new files ceb-nat-seq.lisp and ftree-seq.lisp were entered
into the module etr-nat in defpck.lisp.  I also moved ceb-nat-etr.lisp
to be in the module etr-nat, instead of expansion-tree.

Files Changed: ftree-seq.lisp, ceb-nat-seq.lisp, ceb-nat-etr.lisp,
   hx-natree-top.lisp, hx-natree-aux.lisp, defpck.lisp
========================================================================
CEB			MAKE-ASSERT-A-HYP		July 10, 2001

The function to change an Assert line into a hypothesis discharged at
the end had to be fixed to properly handle the case when the assertion 
wff contains eigenvariables associated with RuleC/UGen.

Files Changed: otl-rearrange.lisp
========================================================================
CEB			EXPANDING DEFNS			July 10, 2001

The cut elimination algorithm requires being able to compute
a common reduct of two wff's, where the notion of "reduction"
allows lambda-reduction, expanding definitions, and expanding
equality (either by Leibniz or Ext=).  I wrote code for computing such
a reduct by expanding as few abbreviations as
needed (see the functions common-defn-*-reduct-* in wffequ2.lisp). 
This code is not only used by cut elimination,
but also by wffeq-def and wffeq-def-eq (in place of wffeq-def1).

Files Changed: wffequ2.lisp, ftree-seq.lisp
========================================================================
CEB			TRUTH				July 10, 2001

Changed the function "justifying-lines" to recognize the
new Truth introduction rule.

Files Changed: otl-cleanup.lisp
========================================================================
CEB			MS98 OUTPUT			July 10, 2001

Minor change in the output MS98 gives.

Files Changed: ms98-top.lisp
========================================================================
CEB			PR00/NNF			July 10, 2001

There was a bug resulting from the way jforms now build literals
in negation normal form.  For some PR00 examples we want to use
the original subformula (eg, in X5210).  So, there is now a flag
MATE-UP-TO-NNF that allow the user to turn this negation normalization
on and off.  PR00 now turns it off during one part of the computation
of setsubs.

Files Changed:  pr00.lisp, etrees-jforms.lisp
========================================================================
CEB			FTREES				July 10, 2001

Modifies ftrees to never use skolem functions, only selected variables.
The problem with skolem functions is that the arguments for the
skolem function should be the expansion variables introduced above
the skolem/selection node.  But we never want an ftree node to
depend on nodes above it (part of the point of ftrees was to
allow sharing of nodes).

Files Changed:  ftrees.lisp
========================================================================
CEB			SPANS				July 10, 2001

Forced the function "spans" to consider the connection list it
was given.  Previously it would also check for existence of a propositional
mating.  This was causing a problem in the translation to
a natural deduction proof.  (An example was when we try to prove
an instance of excluded middle, A or ~A, without RuleP.  Assuming
the negation means there is always a mating, giving improper guidance
to the tactics.)

Files Changed: etr-nat-macros.lisp
========================================================================
CEB			GO BUG				July 10, 2001

For some time, there has been a GO bug illustrated by
the following example:

Given a gap like

1,2  |- A
 . . .
1    |- A

GO would try to apply SAME, which would fail because of
the hypotheses, so GO tries to apply SAME again to the
same gap, leading to a loop.  The function "apply-rule"
should return t if the rule is successful and nil otherwise.
But in this situation, go-main was calling SAME and
always returning T.  Now it returns nil if the rule
fails.  So, in a case like the SAME rule
above, SAME will fail, and as a result GO is stopped.

Files Changed: otl-go.lisp
========================================================================
CEB			SEVERAL CHANGES			August 19, 2001

I installed several changes made in the TPS code during my
visit to Saarbrucken.  These are described below under today's
date, August 19, 2001.
========================================================================
CEB			ACL 6.0				August 19, 2001

Eliminated the #+allegro-v6.0 before the (force-output)
in linereadpp, since it can't hurt to do a force-output
when we print the prompt.

Files Changed: linereadp.lisp
========================================================================
CEB			ACL >= 5.0			August 19, 2001

Changed the #+ . . . :allegro-v5.0 :allegro-5.1 etc.
to be #+ . . . (and allegro-version>= (version>= 5 0))
so we don't have to keep adding to the lists whenever
a new version of Allegro is released.  (Found this
way of doing it in the Omega code - - - )

Files Changed: boot0.lisp core.exp tops20.lisp tps3-save.lisp
========================================================================
CEB			MODULES				August 19, 2001

Moved hx-natree-top to be in the etr-nat module.
It really belongs here since this module is intended to
include translation facilities between expansion proofs
and natural-deduction proofs.  Before it was in the
module ml-etr-tactics which caused a bug because
some of the functions in ceb-nat-seq use the natree
struct's.  Since hx-natree-top defines the natree struct,
it needs to be loaded before the files that use it.
The error showed up at runtime as:

Error: attempt to call the undefined function (SETF AUTO::NATREE-HYPO) with args:THM563-0-0THM563-0-0 () .
  [condition type: UNDEFINED-FUNCTION]

Such an error will show up as a warning at the time one compiles 
TPS.  One can find such warnings using "grep SETF maketps.log"
after making a new tps.

Files Changed: defpck.lisp
========================================================================
CEB			MS98 REWRITE BUG		August 19, 2001

There was a bug with Boolean Extensionality rewrite nodes
that ms98 rewrite was trying to treat as Leibniz.
(Showed up with BOOL-PROP-110 in MS98-HO-MODE)

Files Changed: ms98-rewrite.lisp
========================================================================
CEB			TPS AS AN EXTERNAL SERVICE	August 19, 2001

TPS can now be used to process external requests (to prove
a theorem).  Right now this is so Omega can start up a tps
service via Mathweb and communicate through sockets (instead
of files).  Before now, whenever Omega wanted TPS to work
on a problem, it would create a prf file and a work file
and start a new TPS image in batch mode.  There is a lot
of overhead in starting a TPS image (eg, loading the library
index) so we wanted to only start TPS once.

But this is not specific to Omega.  We can start tps
in service mode by giving command arguments

lisp -I tps3.dxl -- -service <hostname> <inout-port> <service-port>

eg:

lisp -I tps3.dxl -- -service gtps.math.cmu.edu 1000 1001

The inout-port is used for TPS to recieve requests
and send back the results.  The service-port is
used to allow TPS to send tasks to other programs
(eg, fetch a definition from MBase).

Files Changed: tps3-save.lisp
Files Created: external.lisp, socket.lisp, tps-processes.lisp,
    process.lisp, serv.lisp
========================================================================
CEB			OMDOC/MBASE SUPPORT		August 19, 2001

To ease the translation of Omdoc wff's to TPS wff's,
created PI and SIGMA abbreviations for the quantifiers
(as the constants corresponding to the binders).
Also, wrote def-abbr-quick that reconstructs some type information
and then makes an abbreviation.  This is used in a
new function get-mbase-definitions-for in external.lisp

Files Changed: external.lisp ml2-abbrev.lisp lib-ops.lisp
========================================================================
CEB			NEW IMAGES			August 19, 2001

Built new images on gtps and htps.
========================================================================
CEB			TPS AS AN EXTERNAL SERVICE	August 28, 2001

Added a new command line argument -lservice to bring tps
up in service mode with ports local to the machine that
tps is running on.  -service brings up a tps in service
mode with ports on the remote host running the process
calling tps.

Files Changed: tps3-save.lisp
========================================================================
CEB			MSWINDOWS			August 28, 2001

Added #+ mswindows comments so we can build a tps for Allegro
under MS Windows that won't try to bring up xterms, check for
subdirectories, or generally try to run shell commands.

Files Changed:  tops20.lisp, lib-ops.lisp
========================================================================
CEB			COMPLETE PROOFS DIR		August 31, 2001

Many of the proofs in the proofs/complete directory did not
save all the library constants and abbreviations with the proof.
When one of these was infix, restoreproof could not parse the
prf file unless the user fetched the appropriate library objects.
The files have now been fixed (by fetching all lib objects we
need, restoring the proof, then saving them with a fixed version
of saveproof that will also be released soon.)

The old version of the proofs/complete directory is on gtps:
/home/theorem/project/proofs.complete.old/
========================================================================
PBA                                            2001 Sept 6, Oct. 9

In afs/andrew.cmu.edu/mcs/math/etps/i386_rh60/etps
Changed
set etps_user=`/usr/ucb/whoami`
to
set etps_user=`/usr/bin/whoami`

In afs/andrew.cmu.edu/mcs/math/etps/tps/i386_rh60/tps3
Changed
set tps_user=`/usr/ucb/whoami`
to
set tps_user=`/usr/bin/whoami`
========================================================================
CEB PBA 		LIBRARY INITIALIZATION		Sept 20, 2001

Changed flag LOAD-WARN-P to decide whether to probe library files
while building the master index hash table.  Previously it always
probed and only used LOAD-WARN-P when deciding whether to print
the warning.

Files Changed: maint.lisp, lib-ops.lisp
========================================================================
CEB			COMPLETE PROOFS DIR		September 27, 2001

While running tps-test, saved ND proofs created automatically.
There are now copies of these proofs in the complete proofs directory,
named THMNAME_MODE.prf.  There is also an auto subdirectory of
complete that contains links to these proofs.
========================================================================
CEB			EPROOF LIST			September 27, 2001

Created a new type% eproof, and a global list
*eproof-list* that contains a list of symbols.
Each of these symbols has a property 'EPROOF
which is an eproof structure.  This symbol can
be passed as an argument (while entering the
MATE top level, for example).

An eprooflist command gives a list of the
eproofs in memory.

Files Changed: argtype-auto.lisp, diy.lisp, ftrees.lisp,
hx-natree-duplication.lisp, hx-natree-top.lisp, mating-top.lisp,
nat-etr.lisp, auto.exp
========================================================================
CEB			MERGING BUGS			September 27, 2001

Changes to etree merging.  Fixed a small prettify bug,
made major changes to the cleanup phase, and 
with handling dual rewrites.

Files Changed: mating-merge-eq.lisp, mating-merge.lisp
========================================================================
CEB			SILENT BELL			September 27, 2001

turned off the bell after a diy succeeds
when MATING-VERBOSE is SILENT.  This is so I can
run tps-test (which uses QUIET modes) without the bell
beeping over and over.

Files Changed: diy.lisp
========================================================================
CEB			CEB NAT-ETREE			September 27, 2001

Various updates to the CEB version of nat-etree:

. in the preprocessing, discharge any left over hypotheses
(in case the last line of the proof still has hyps),
and expand any three- or four-disjunct version of
the "Cases" rule to a series of binary "Cases" rules.
. when building the natree, there are three versions of the
Indirect rule (corresponding to the rules Indirect, Indirect1,
and Indirect2).  All of these now translate into the rule
corresponding to Indirect.
. updates to the way translation to sequent calculus
handles dual rewrites and binder definitions (eg, EXISTS1)
. the ftree merging algorithm had bugs and has now
been completely rewritten using temporary "merge" nodes
that are reduced.
. new commands seqlist, pseq, pseql to allow the user
to see sequent calculus derivations, and a flag
pseq-use-labels to determine whether to replace
wff's by labels for wff's when printing these derivations.

Files Changed: ceb-nat-etr.lisp, ftree-seq.lisp, ftrees.lisp, hx-natree-aux.lisp,
otlnl.lisp 
========================================================================-
CEB			NEW CONTEXTS			September 27, 2001

Created two new contexts: dec-frags and pers.
These are not yet used, but will be the contexts
for some code I'm working on to find models for
formulas.

Files Changed: contexts-auto.lisp
========================================================================-
CEB			TRANSLATION BUGS		September 27, 2001

Changes to etree-nat translation to fix bugs:
 
. handling rewrites of equiv when we're not using RuleP,
including new tactic neg-equiv-sline-tac.
. when NEG-*-ELIM tactics are applied, the 'duplicate
property is propagated from the negated support line
to the new planned line.
. changes in the way DUAL rewrites are translated.
Now, a dual rewrite uses equivwffs to justify a derivation
from A to [A and A], or from [A or A] to A.  Then the
actual definition is expanded in one at a later time.
. Changed indirect-tac and neg-mated-line
to avoid "indirect <-> neg elim" loops
arising from nonleaf matings

Files Changed: etr-nat-macros.lisp, ml-etr-tactics-main.lisp,
ml-etr-tactics-neg.lisp, ml-etr-tactics-pline.lisp, ml-etr-tactics-sline.lisp
========================================================================-
CEB			ETR-INFO			September 27, 2001

Created a new mate command etr-info.
This should give information about the expansion tree,
as opposed to etr-auto-suggest that interprets information
to suggest flag settings.  Currently etr-info lists
the expansion terms in the etree.

Files Changed: etrees-auto-suggest.lisp, auto.exp
========================================================================-
CEB			DEBUGGING ETREES		September 27, 2001

check-etree-structure now checks more detail in rewrite nodes.

Files Changed: etrees-debug.lisp
========================================================================-
CEB			NNF OF TRUTH AND FALSEHOOD	September 27, 2001

Changed neg-norm to reduce
~FALSEHOOD to TRUTH
and
~TRUTH to FALSEHOOD.
Also changed make-nnf-literal so that
~FALSEHOOD is *not* reduced to NNF TRUTH
so that FALSEHOOD's can mate.  The example THM120B
in mode MODE-THM120B didn't work when it was
reduced to TRUTH.

Files Changed: etrees-jforms.lisp, wffneg1.lisp
========================================================================-
CEB			COLORS SLOT			September 27, 2001

Added a new "colors" slot for etrees.
I will use this slot to experiment with 
using colors to restrict the search for matings.

Files Changed: etrees-labels.lisp
========================================================================-
CEB			TPS LOCAL SERVICE		September 27, 2001

New way to start a tps service.  The original way was

tps3 -service host inoutport servport

The new way is

tps3 -lservice localport

where "lservice" stands for "local service".
The ports are for communication.  In "service"
mode, the inoutport and servport are ports on
a remote machine.  These are used to communicate
requests and results.  In "local service" mode,
the localport is on the machine on which the tps service
is running.

Also, changed some errors to warning messages.

Files Changed: external.lisp, socket.lisp,
tps-processes.lisp, tps3-save.lisp
========================================================================-
CEB			MS98 SETSUB BUG			September 27, 2001

Changed dup-outers-fn-1 to recognize
setsubs that have a negation or abbreviation
at the head.  Without this, CR-THEOREM
with mode MS98-CR-THEOREM-MODE doesn't work.

Files Changed: ms98-dups.lisp
========================================================================-
CEB			MS98-TRACE			September 27, 2001

Changed ms98-trace to use "colors" on an
expansion tree to identify "good" components
and print information about them.  It is
easier to transfer a mating to a coloring
than to another mating, since two expansion
trees for the same shallow formula need not
structurally correspond.

Files Changed: ms98-jform.lisp, ms98-top.lisp
========================================================================-
CEB			DNODE PRINTING			September 27, 2001

Changed the way dnode structures are printed.
They were being printed as huge, ugly #S expressions.

Files Changed: ms98-macros.lisp
========================================================================-
CEB			REMOVE-SYM=			September 27, 2001

Set rewrite-equalities dynamically in remove-sym=-line
so that the equality is expanded as Leibniz.
The proof s-join-fpprop.prf didn't work before because
it would try to expand the equality using extensionality.

Files Changed: nat-etr.lisp
========================================================================-
CEB			REFL= BUG			September 27, 2001

Handled the case where a line with justification of Refl= 
does not have a support line.  This wasn't being recognized
in cleanup before.

Files Changed: otl-cleanup.lisp
========================================================================-
CEB			RESTOREPROOF BUG		September 27, 2001

Changes to restoreproof to guarantee that variables
have the appropriate type property.  

Files Changed: saveproof.lisp
========================================================================-
CEB			SUBSTITUTE-TYPES BUG		September 27, 2001

substitute-types wasn't working for = or IOTA
(polymorphic logical constants).

Files Changed: wffprim.lisp
========================================================================-
CEB			POLYMORPHIC LIB-CONSTS		September 27, 2001

Changed const-list to return polymorphic lib-consts
like INFIX-LESS so these will be saved with saveproof.

Files Changed: wffabb.lisp
========================================================================-
CEB			WFFEQ-DEF/WFFEQ-DEFEQ		September 27, 2001

Changed the way wff's are tested for equality
up to definitions/equality.  It now looks
for a reduct (but does not look for the
least instantiated reduct - code is still there
to find the least instantiated reduct, and is
used by nat-etree and cut elimination).

Files Changed: wffequ2.lisp, core.exp
========================================================================-
CEB			TYPE-EQUAL			September 27, 2001

Changed type-equal to test for equality of
unabbreviated types of wff's (so that x<S>
and x<O<OI>> are recognized as having the same
type).

Files Changed: wfftst.lisp
========================================================================-
CEB			MINOR FIXES			September 30, 2001

The name of the function ftree-seq-nnf-init-1 should have
been ftree-seq-nnf-init.  Also, moved some exports into
auto.exp, and replaced some calls to query that I had
commented out while debugging. Made these changes and put
the files in the patch file.

Files Changed: ftree-seq.lisp, ceb-nat-etr.lisp, saveproof.lisp, auto.exp
========================================================================-
CEB			UPDATE-LIBDIR			October 4, 2001

Fixed the help message for update-libdir.  
Update-libdir now creates the library directory if it does not exist.
Had update-libdir call import-needed-objects at the end.

Files Changed: library2.lisp
=========================================================================
CEB			DOCUMENTATION			October 16, 2001

Updated Section 2.8 of the User's Manual by including a subsection 
about NAT-ETREE outlining the steps CEB NAT-ETREE uses, along with 
commands relevant for natree's and sequent calculus derivations.

Updated Section 2.10 of the User's Manual by adding subsections
with two examples describing ETR-AUTO-SUGGEST and MS98-TRACE.
The two examples are THM12 and X2116.  I deleted the parts
about BUILD-CORRESPONDING-MATING and MAKE-EPROOF-CANONICAL
since these commands have been deleted and replaced by
the more general method of coloring nodes to correspond to
connections in the known mating.

Added a paragraph at the beginning of Section 17.3 of 
the Programmer's Guide giving a reference to the User's Manual
for a description of ETR-AUTO-SUGGEST and MS98-TRACE with
examples.

Files Changed: user/natetr.mss, user/manual.mss, user/searchanalysis.mss,
      prog/nat-etr.tex
=========================================================================
CEB			MS98-TRACE			October 16, 2001

Since the tracing now uses "colors" (documented in the User's
Manual now) to transfer the mating, we no longer need
MAKE-EPROOF-CANONICAL, so this has been deleted.  
(BUILD-CORRESPONDING-MATING has already been deleted.)
I added a top level command SET-BACKGROUND-EPROOF so one can
set a particular eproof to be the background proof to
be used by MS98-TRACE.

Files Changed: ms98-top.lisp, ceb-nat-etr.lisp
=========================================================================
CEB			LEMMAS IN EPROOFS		October 16, 2001

Added a "lemmas" slot in the eproof structure.  This is used to
indicate when the expansion tree has a form like [A => A] => THM
where A is a theorem.  This is used during merging to prevent moving
lambda nodes above these implications, and to add the eproof-dissolve
connections to the mating at the beginning of merging.
More importantly, the slot is used in the etree-nat 
translation to add a planned line for
A (which is then proven) and a support line for A
In general, we can have several lemmas so that the tree has the form
[A1 => A1] => . . . => [An => An] => THM
and even lemmas can have lemmas as in
[[[B => B] => A] => A] => THM
The value in the lemmas slot is (for now) a tree of NILs that indicates
how the lemmas appear in the etree.  For example,
for a tree without lemmas, the lemmas slot is NIL.
For [A => A] => THM, the lemmas slot would have value (NIL).
For [A1 => A1] => . . . => [An => An] => THM, the lemmas
slot would be a list of n NIL's.  And for,
[[[B => B] => A] => A] => THM the lemmas slot would have
value ((NIL)).

Rebuilt on htps and gtps so the slot can be used.

Files Created: lemmas.lisp
Files Changed: etrees-flags.lisp, diy.lisp, etr-nat-macros.lisp,
   mating-merge.lisp, auto.exp, defpck.lisp
=========================================================================
CEB			EXTENSIONALITY LEMMAS		October 16, 2001

Created a new flag USE-EXT-LEMMAS.  If this is set to T, then
diy calls a procedure which creates some instances of extensionality
to use as lemmas.  These are added to the etree (changing the lemmas
slot of the eproof) along with connections that are dissolved from
the jform.  Then automatic search is called.  This is a fairly naive
method of implementing extensionality, since it finds these lemmas
in a preprocessing step.  But since it is done in preprocessing,
it is compatible with all mating search procedures.  

There is also a MATE command ADD-EXT-LEMMAS that finds these
lemmas and adds them to the current etree and eproof.

To make this work, I had to change the remove-leibniz part of
merging so that it doesn't replace a Leibniz= rewrite with
a Subst= rewrite when there are nonleaf matings beneath the
rewrites.  I also had to fix a problem with get-priority
in ms98-jform.lisp which was mistaking some literals introduced
by an extensionality lemma as being a duplicate.

Files Changed: lemmas.lisp, diy.lisp, auto.exp, mating-merge-eq.lisp,
   ms98-top.lisp, ms98-jform.lisp
=========================================================================
CEB			LIBRARY CLASSIFICATION SCHEMES	November 15, 2001

Implemented code allowing to create library classification schemes,
and use this to access and view the library.  A default classification
scheme based on the library directory structure is built when
backup-lib-dir or default-lib-dir is set (eg, when TPS is started).
The flag CLASS-SCHEME controls which classification scheme is used.
Classification schemes can be stored in and retrieved from the library.

Created a new top level unixlib which allows users to access
the library via unix-style interface, treating the classification
scheme like a directory structure.

Commands for modifying classification schemes are in both
the library and the unixlib top level.

Also updated the Library chapter of the Users Manual.

Files Changed: core.exp, contexts-core.lisp, argtyp.lisp, lib-ops.lisp
   library3.lisp, lib-objects.lisp, defpck.lisp
Files Created: unix-library1.lisp
=========================================================================
CEB				INPUT			November 15, 2001

Changed the function LISP-IZE so that if part of the user input
is all dots ("..") then it is left as a string instead of trying
to read it as a lisp object.  I needed to do this to allow commands
like cd .. in the unixlib top level.

Files Changed: linereadp.lisp
=========================================================================
CEB				LEMMA DOCUMENTATION	November 26, 2001

Added documentation on lemmas in expansion proofs to the
Programmers Guide in the chapter on Mating Search.
The section on lemmas includes an example using extensionality
lemmas, in the Programmers Guide.
=========================================================================
CEB				LEMMAS			December 14, 2001

Updated the code handling expansion proofs with lemmas.
For example, deepening doesn't deepen the proofs of lemmas.
Created a flag ASSERT-LEMMAS.  If this is set to T, then expansion
tree proofs with lemmas translate into multiple natural deduction
proofs (one for the main theorem and one for each lemma).
Also, changed the values for the lemmas slot of an eproof
to contain symbols naming the lemmas.   Also, changed merging
to handle lemmas in the new way.  See the programmer's guide
for documentation.

Files Changed: auto.exp, diy.lisp, etr-nat-macros.lisp, etrees-wffops.lisp,
       lemmas.lisp, mating-merge-eq.lisp, mating-merge.lisp, 
       mating-merge2.lisp 
=========================================================================
CEB				SET CONSTRAINTS CODE	December 14, 2001

Released code for search combining ms98-1 with set constraints.
This is documented in the Programmer's Guide.  Most of the new
code is in the new file constraints.lisp.  The changes in the ms98-*.lisp
files incorporate new kinds of stop's to throw - DELAY-SETVARS tells
MS98-1 to search again, but on the rigid part of the jform - and
NEXT-CONSTRAINED-SOLN to search on the next constrained soln generated
during some part of the search when set variables were delayed.

Files Changed: auto.exp, etrees-jforms.lisp, constraints.lisp, ms98-dups.lisp,
   ms98-jform.lisp, ms98-macros.lisp, ms98-paths.lisp, ms98-top.lisp,
   ms98-unif.lisp, wffmbed.lisp, ftrees.lisp, defpck.lisp
=========================================================================
CEB				HELP MESSAGE		December 14, 2001

Changed the help message for the argument to set-search-tree
from "Which Etree" to "Which Etree or Eproof".

Files Changed: etrees-wffops2.lisp
=========================================================================
CEB				SUBJECTS AND MODES	December 14, 2001

In the code that sets the mode, changed some of the symbols naming subjects
because they are exported from auto, not core - eg, PRIMSUBS is
AUTO::PRIMSUBS.  Without the AUTO::
it doesn't find the flags in this subject and hence does not set
them to their default value when they are not set by the mode.

Files Changed: flagging.lisp
=========================================================================
CEB				LIBCLASS STRUCT		December 14, 2001

Moved the defstruct for libclass to lib-macros.lisp from library3.lisp
so that the struct is known before other files are compiled.

Files Changed: lib-macros.lisp, library3.lisp
=========================================================================
CEB				FONTS			January 25, 2001

Wrote some code to convert fonts into individual image files.
This code is in the file "fontconversion.lisp" in the utilities
directory.
=========================================================================
CEB				WEB DISTRIBUTION	February 21, 2001

Modified the TPS web site on gtps to include a page for downloading
TPS on the web.  The main file is the perl script

/home/httpd/cgi-bin/tpsdist.pl

which shows the TPS distribution agreement (contained in the text
file /home/httpd/cgi-bin/tps-dist-agree.txt) and ends with
an html form asking for information.  Once this information is
submitted, tpsdist.pl is called again with a query string including
the information.  The query string is parsed using perl code in

/home/httpd/cgi-bin/cgi-lib.pl (which I found on the web)

When given this query string, tpsdist.pl puts the information
into the log file

/home/theorem/tps-dist-logs/tpsdist_log

on gtps and gives instructions for downloading the compressed tar file.
The compressed tar file is actually a link

/home/httpd/html/tps3.tar.gz

to

/home/ftp/pub/tps3-<date>.tar.gz

The link is automatically updated when a new distribution is built
using the /afs/andrew/mcs/math/TPS/admin/tps-dist/make-tar.exe
script (which was also modified to do this extra work).
=========================================================================
CEB				MANUALS			February 27, 2002

Created pdf versions of the manuals using ps2pdf.
Updated the /home/theorem/project/doc/*/README files to be
scripts that take the .ps file(s), create a gzipped version,
and create a pdf version.  Added a link from the web page
to the pdf versions.  Also, we had an access problem from
the web today because the /home/theorem/project directory 
did not have o+x permissions.  Every directory in the subpaths
of /home/theorem/project/doc/* must have o+x permission
for web browsers to access the manuals and online documentation.
=========================================================================
CEB				EXECUTE-FILE		March 3, 2002

Added a (force-output) to the pause function in save-work.lisp
to make sure that all the output is shown before lisp waits
for a RETURN when executing a work file in "step" mode.

Files Changed: save-work.lisp
=========================================================================
CEB				CMUCL			March 13, 2002

Changed defpck.lisp to define external-services as an empty module
(module with no files) when we are not in Allegro 5.0 or later.

Files Changed: defpck.lisp
=========================================================================
CEB				SMALL CORRECTION	March 13, 2002

:postive to :positive in ftrees.lisp

Files Changed: ftrees.lisp
=========================================================================
CEB				CMUCL 18c		March 18, 2002

Installed CMUCL 18c in /home/theorem/cmucl/18c/ on gtps and htps.
Fixed some tps bugs to get tps to compile in 18c:

In merge-reconstruct-ftree in ftrees.lisp, I had to change
  (find-if-not #'ftree-p kids)
to
  (find-if-not #'(lambda (f) (ftree-p f)) kids)
since ftree-p is a macro.

Files Changed: ftrees.lisp
=========================================================================
CEB				RULEP TACTIC		April 9, 2002

Changed rulep-match2 & lines-to-rulep-jform to use
etree-to-rulep-jform so the rulep-tactic applies when it
needs to.  It still doesn't always apply, so there's more
to do (eg, X5304, MODE-X5304).

Files Change: ml-etr-tactics-book.lisp, ml-etr-tactics-main.lisp
=========================================================================
CEB				TEXPROOF BUGS		April 26, 2002

There were some bugs in texproof that would show up in large proofs,
like X6201, when USE-INTERNAL-PRINT-MODE was NIL or
TEX-MIMIC-SCRIBE was T.  (In general, when the style TEX was used instead
of TEX-1.)  This was partly due to simple bugs (a $ where a } should be)
and partly due to the fact that the TEX style (+ LATEX-EMULATION NIL)
uses an \halign around the whole proof.  Inside an \halign there's a problem 
using \filbreak, so I'm using \cr in that situation.  Once those problems
were fixed and tex could actually compile the output of texproof, we noticed
that with PPWFFLAG NIL long lines were being written completely off the page.
This was happening because we couldn't break or wrap lines within the math
or display mode.  So, I added global vars tex-curpos (an integer counting how
far across we are on a line), *in-tex-math-mode* and *in-tex-display-mode*
(booleans to keep up with which mode we're in).  When tex-curpos surpasses
the rightmargin and we're trying to write a space, I force a line break.

Files Changed: pprint.lisp, otl-scribeout.lisp, deftex.lisp
=========================================================================
CEB				XTERM STYLE		April 26, 2002

Made a few changes to the xterm style so that when PPWFFLAG is NIL
and the rightmargin is exceeded, a line break is forced.  This also
helps keep the justifications from being misaligned.  It's still not
perfect.

Files Changed: xterm.lisp
=========================================================================
CEB				XTERM STYLE		April 26, 2002

There was a bug in the change I made to xterm (when curpos or rightmargin
was nil, we'd get thrown to the debugger - and this was happening often -
eg, BLEDSOE-FENG-SV-10 in MODE-NBHD-THM2).
I simply added an extra check that curpos and/or rightmargin was not NIL
whenever necessary.

Files Changed: xterm.lisp
=========================================================================
CEB			NEW RELEASE			May 30, 2002

Released a number of new lisp files related to the Java Interface,
bug fixes, changes to the code for constraints and lemmas, 
changes to reducde the number of compilation warnings,
code for relevancy of flags, and code for computing classification
schemes.  These are each described in more detail below.
=========================================================================
CEB			JAVA INTERFACE			May 30, 2002

Wrote a java interface for TPS.  The java code is in the TPS/java/
directory.  The lisp TPS code was updated to interact with the
java interface, both as a service running over the web, and as
a local interface.  The code in tps3-save.lisp recognizes command
line arguments -javaservice and -javainterface to let TPS know
it's running through the java interface.  This sets global variables
*using-interface*, *running-remotely*, and *expert-running-remotely*
and sets the STYLE to a new style "ISTYLE" ("interface style") described
below.  It also starts a process to listen for commands and prompt responses
from the Java interface, and starts a process that actually runs commands.

The new style ISTYLE (interface-style.lisp) is similar to the XTERM
style, but outputs certain control information.  The control information
may, for example, tell the Java Interface to change the color of the output,
pop up a prompt window, or pop up or write to an editor window, proof window,
or vpform window.

There is also new categories for menus and menuitems.  Menus are defined
for mexprs, flags, and other top level commands.  Some are only active
when in the appropriate top level.

More documentation is in the Programmers Guide and User Manual.

Files Changed: tps3-save.lisp, external.lisp, top.lisp, tpstop.lisp,
boot0.lisp, linereadp.lisp, library1.lisp, library2.lisp, library3.lisp,
lib-ops.lisp, lib-bug.lisp, lib-macros.lisp, gensty.lisp, macsys.lisp, 
xterm.lisp, vpforms.lisp, otl-scribeout.lisp, otl-rearrange.lisp, defpck.lisp
prfw.lisp, otl-prt.lisp, diy.lisp, edtop.lisp, mhelp.lisp, argtyp.lisp, core.exp
Files Created: menus.lisp, interface-style.lisp, ed-menus.lisp, test-top-menus.lisp,
unif-menus.lisp, lib-menus.lisp, unix-lib-menus.lisp
=========================================================================
CEB			EXPERTFLAG			May 30, 2002

Fixed a loop in gwff-p which occurred when expertflag is NIL.

Fixed a problem with weak labels vs library objects when expertflag is NIL.

Files Changed: wfftst.lisp, library2.lisp
=========================================================================
CEB			CONSTRAINTS			May 30, 2002

Made a few changes to the way set constraints are handled.
I rearranged the code so that instead of directly solving
set constraints, they are processed into new set constraints
(which may be in solved form).  This should make it easier
to extend the code to handle constraints that cannot be
algorithmically solved.  Also, added new constraint related flags 
INCLUDE-COINDUCTION-PRINCIPLE, WHICH-CONSTRAINTS, and
BAD-VAR-CONNECTED-PRUNE.

Files Changed: auto.exp, constraints.lisp, ms98-top.lisp
=========================================================================
CEB			LEMMAS				May 30, 2002

Fixed some problems with lemmas.  In diy, and in the library, when
we want the shallow formula of an expansion proof with lemmas,
we want the shallow formula of the tree without the lemmas.

Added a command DEASSERT-LEMMAS which takes a natural deduction
proof with asserted lemmas, converts the proofs into a single
natural deduction proof.  Another command NORMALIZE-PROOF
combines these proofs and then constructs a single
sequent calculus proof, then calls cut elimination to get a
cutfree proof, and finally translates back to a single natural
deduction proof.  This can be used after searching with
set constraints to obtain a natural deduction proof in which
the definitions of the sets are explicit.

Files Changed: diy.lisp, library2.lisp, ceb-nat-seq.lisp, lemmas.lisp
=========================================================================
CEB			ETR-NAT TRANSLATION BUGS	May 30, 2002	

Fixed a problem with the match function for the use-rulep-tac tactic.
Also, fixed a bug with "false" expansion nodes associated with
planned lines during a proof by contradiction.  These nodes should
always be negative, but were sometimes being computed as positive.

Files Changed:  ml-etr-tactics-book.lisp, ml-etr-tactics-pline.lisp
=========================================================================
CEB			MS98 BUG			May 30, 2002

Fixed a bug with build-duplicate-reln which computes list of lists
of nodes which correspond up to duplication of quantifiers.
The problem showed up with a variant of THM145, THM145L1.
The relevant difference (with respect to this bug) between the two 
was simply a leading universal quantifier.
There may still be other problems with other variants of THM145,
eg, THM145A.

Files Changed: ms98-jform.lisp
=========================================================================
CEB			WFFEQ BUG			May 30, 2002

Fixed a minor bug in wffequ2.lisp (the var lcontr was referenced
where lcontr-defs should have been - the compiler found this bug).

Files Changed: wffequ2.lisp 
=========================================================================
CEB			DUAL-P 				May 30, 2002

The compiler warned that a local variable "l" in dual-p wasn't
used.  It really should have been used, and the code now uses it.
It wasn't a bug, it just caused a very minor amount of extra
computation.

Files Changed: etrees-wffops.lisp
=========================================================================
CEB			COMPILER WARNINGS		May 30, 2002

In an effort to reduce compiler warnings, I added "special"
and "ignore" declarations throughout the code (unless the
warning was an actual bug, as in the wffequ2 case documented above).
In some cases ("oldplans" in ml-etr-tactics-sline, "jform2" in pr00,
"ab2" in ceb-nat-etr, and misc. examples in ftree-seq.lisp),
a variable defined in a let wasn't used, so I could simply delete these.
I also commented out some declarations from the code we inherited
from the Omega project, since the compiler complained about them.

Files Changed:  pr00.lisp, ml-etr-tactics-sline.lisp, ceb-nat-etr.lisp,
wfflmbd2.lisp, vpforms-tex.lisp, unix-library1.lisp, tpstop.lisp, tps3-save.lisp,
tops20.lisp, test-top-top.lisp, save-work.lisp, mating-top.lisp,
maint.lisp, macsys.lisp, library2.lisp, lib-ops.lisp, hx-natree-top.lisp,
etrees-wffops2.lisp, etrees-debug.lisp, etrees-auto-suggest.lisp,
etrees-exp-vars.lisp, argtyp.lisp, cnf.lisp, diy.lisp, ms98-top.lisp,
ms98-macros.lisp, ms98-dagify.lisp, ms98-unif.lisp, etr-nat-macros.lisp,
ftrees.lisp, process.lisp, serv.lisp, socket.lisp, tps-processes.lisp,
pprint.lisp
=========================================================================
CEB			DELETED EXTRA DEBUGGING CODE	May 30, 2002

There were a few extra globals being set and messages being printed
for debugging purposes that I should have deleted before previous 
releases of code.  The compiler was complaining about them, so I deleted them.
I also moved some exports from etrees-debug.lisp to auto.exp.

Files Changed: ftrees.lisp, ms98-jform.lisp, ms98-paths.lisp,
etrees-debug.lisp, auto.exp
=========================================================================
CEB			UNIXLIB TOP LEVEL		May 30, 2002

Changed the unixlib top level interpreter, so the user can run any library
command from the unixlib top level (unless there's a unixlib command
with the same name).  Added a "mv" (move) command to the unixlib top level,
equivalent to "cp" followed by "rm".

Files Changed: unix-library1.lisp, core.exp
=========================================================================
CEB			LIBRARY INITIALIZATION		May 30, 2002

We're now setting BACKUP-LIB-DIR in the common tps3.ini file
and leaving each user to set DEFAULT-LIB-DIR in their personal
tps3.ini file.  Since only experts can read a personal tps3.ini file,
I used set-flag in the common tps3.ini file to set BACKUP-LIB-DIR
so that the hash table would be created.  To keep restore-lib-hashtable
from being called more than once during the initialization,
I inserted *lib-masterindex* (in tps3-save.lisp) a dummy value before
loading the ini files and then cleared this from the hash table and
explicitly call restore-lib-hashtable after loading the ini files.

Changed Files: tps3-save.lisp, library2.lisp
=========================================================================
CEB		LIBRARY CLASSIFICATION SCHEMES		May 30, 2002

I modified the code for classification schemes so that we can
classify abbreviations and theorems defined in the TPS code
(eg, SUBSET, X5310) as well as those in the library.
Instead of listing a library file with these objects,
the symbols :INTERNAL-ABBREV and :INTERNAL-THEOREM are used.

There is a new library and unixlib commands GENERATE-CLASS-SCHEME
that can organize the library based on needed objects.
The generated classification scheme automatically generated
class names.  In the unixlib top level, one can find classes
with such names using the new command FIND-GENERATED-CLASS.
Then, the new command RENAME-CLASS can be used to give the
class a more descriptive name.  The user can also modify
this (or any) classification scheme in the unixlib top level
using the new command IMPORT-CLASS to delete a class and
move its contents up one level.

Michael Kohlhase and I are trying to get a good classification
scheme to use to translate the library into OMDOC. (See below.)

I also needed to use GET-ALL-DEFNS to extract abbreviations
from a wff.  This was defined in the auto package (in etrees-wffops.lisp).
I moved this to wffprim.lisp in the core package (with extensions
via flavors to exp-vars, skolems, and etrees in etrees-exp-vars.lisp,
etrees-skolems.lisp, and etrees-labels.lisp).

Finally, I fixed a minor bug with mhelp of class-schemes that
was keeping the help messages for class-schemes from being displayed.

Files Changed: lib-objects.lisp, library3.lisp, unix-library1.lisp
etrees-wffops.lisp, etrees-exp-vars.lisp, etrees-labels.lisp,
etrees-skolem.lisp, wffprim.lisp
=========================================================================
CEB			SHOW-BESTMODE-THMS		May 30, 2002

Added a library command SHOW-BESTMODE-THMS, and coded a general
printing function print-unordered-symbol-table which prints
a list of symbols in a tabular form, from shorter symbol names
to longer.

Files Changed: prtcmd.lisp, library3.lisp
=========================================================================
CEB			BESTMODES AND TEST-INIT		May 30, 2002

Modified moderec and daterec to ask whether the mode should
be used for automatic testing (via test-init and tps-test).
If it shouldn't be used for automatic testing, this is saved
along with the bestmode comment in the bestmodes.rec file.

Files Changed: library3.lisp, maint.lisp
=========================================================================
CEB			UPDATE-RELEVANT			May 30, 2002

I wrote some new code (in the new file flag-deps) which analyzes
the uses of flags in the lisp code.  In the review top level,
when the user calls UPDATE-RELEVANT on a flag, he has
the option of computing relevance information from the code
or loading it from a file.  After being computed, relevance information
can be saved to a file using SAVE-FLAG-RELEVANCY-INFO.
There is also a command SHOW-RELEVANCE-PATHS can give
information about how a flag is used in the code.
If the user never chooses to compute the information or load
it from a file, UPDATE-RELEVANT uses the relevancy information
built into the defflag declaration of flags.  I added more
relevant-kids, relevancy-preconditions, etc, slots to flags
in the code based on information from the results of analyzing
the lisp code automatically.  I also added a flag
SUPPRESS-IRRELEVANCE-WARNINGS which will turn off
warnings when the user tries to set an irrelevant
flag.  (It defaults to T, so the user does still
see the warnings normally.)  I do suppress the
irrelevance warnings when setting a mode, since
the order in which the flags in the mode are set
was causing inappropriate irrelevance warnings.

Files Changed: review.lisp, flagging.lisp, xterm.lisp
unif-tree.lisp, unif-subs.lisp, unif-simpl.lisp, unif-match.lisp,
prim-edops.lisp, prim.lisp, pr00.lisp, ms90-3-top.lisp, 
ms91-basic.lisp, ms91-enumerate.lisp, ms98-macros.lisp,
etrees-flags.lisp, node.lisp, order-components.lisp, defpck.lisp
Files Created: flag-deps.lisp
=========================================================================
CEB			OMDOC				May 30, 2002

Added a new file omdoc.lisp containing commands for creating
omdoc files from the library and from proofs.  This code has
existed for about a year, but this is the first time it's been
included as part of TPS.

Files Changed: maint.exp, defpck.lisp
Files Created: omdoc.lisp
=========================================================================
CEB			TPS-TEST			June 12, 2002

Had tps-test look at the last line of a proof
to make sure it really is the same as the theorem
we're testing.  This helped me find a few merging
and translation bugs described below.

Files Changed: maint.lisp
=========================================================================
CEB			TRANSLATION BUGS		June 12, 2002

Fixed some translation bugs.  One was caused
by deleting the last line of the proof
when it's redundant (which was leading to
proofs with a last line which is not the
intended conclusion of the proof).
Also, fixed problems with support lines.
Som of the neg-*-sline tactics were leading to
negative etrees that should have been positive.
The only time support lines should correspond
to a negative etree is when this support line
is also a planned line (or used to be a planned
line).  In such a case, we now don't use these
support lines to check for complete matings,
since it may be the negative etree support line
which is provable in a context, instead of
the planned line we're working on.

Files Changed: ml-etr-tactics-sline.lisp,
otl-cleanup.lisp, ml-etr-tactics-book.lisp
=========================================================================
CEB			ADD-TRUTH PROBLEM		June 12, 2002

I had changed the way add-truth works by putting
a negative implication node at the root of the
tree (eg, turning Q- into [TRUTH IMPLIES Q]-)
instead of a conjunction node.  But I hadn't
changed the merging code to look for an implication
instead of a conjunction.  So, merging wasn't
getting rid of these extra TRUTH/~FALSEHOOD's.
Fixed this.  Also, updated translation tactics
to treat leaf nodes with TRUTH/FALSEHOOD like
true/false nodes.

Files Changed: ml-etr-tactics-pline.lisp,
mating-merge.lisp
=========================================================================
CEB			UNIXLIB				June 12, 2002

Added new unixlib commands, ls-items*, locate, pup,
pdown, rename-class-scheme.

Files Changed: core.exp, unix-library1.lisp,
unix-lib-menus.lisp
=========================================================================
CEB			CLASS-SCHEMES			June 12, 2002

Allowed class-schemes to classify abbrevs, etc,
defined in the core of TPS (eg, SUBSET) instead
of the library.  Also, included classifying
defined binderes (eg, EXISTS1).

Fixed some problems with GENERATE-CLASS-SCHEME.

Files Changed: unix-library1.lisp library3.lisp
=========================================================================
CEB			OMDOC				June 12, 2002

Updated omdoc code based on conversations with Kohlhase.

Files Changed: omdoc.lisp
=========================================================================
CEB			LIBRARY BUG			June 12, 2002

If a library item happens to have a name that
is the name of a lisp function, insert would
try to call this function when trying to
find the library object's definition.  Fixed
this.

Files Changed: library2.lisp
UPDATE-RELEVANT

Update-relevant now offers to create a mode
and store it in the library after the user
modifies two or more flags.

Files Changed: review.lisp, lib-objects.lisp
=========================================================================
CEB			INITIALIZATION			June 12, 2002

Fixed the initialization so that it only
tries to initialize the library hash table
if the library module is loaded.
This way, ETPS (which doesn't include the library)
doesn't try to initialize the library and cause
an error.

Files Changed: tps3-save.lisp
=========================================================================
CEB			KNASTER-TARSKI LEMMAS		June 12, 2002

Fixed a couple of bugs with generating the
lemmas for set constraints (which basically
involved changing the order of quantifiers
in a few places).

Files Changed: constraints.lisp
=========================================================================
CEB			NORMALIZE-PROOFS		June 12, 2002

Added pall to end of normalize-proof.

Files Changed:  ceb-nat-seq.lisp
=========================================================================
CEB			CEBCS CLASSIFICATION SCHEME	June 17, 2002

There is now a classification scheme CEBCS for the library in the library.
To use it, set class-scheme to CEBCS and class-direction to UP.
This can be used to omdoc the library via the command omdoc-class-scheme.
I started building generate-class-scheme (modifying it so it can
also update an existing class-scheme's, so we can use the same command
tomaintain completeness of this, or any other, classification scheme).

Files Changed:  library3.lisp
=========================================================================
CEB			OMDOC CODE			June 17, 2002

Made some modifications to the way type variables are handled
in generated omdoc files.

Files Changed:  omdoc.lisp
=========================================================================
CEB			INSERT/DATEREC			June 17, 2002

We've made several changes to the TPS library recently in order
to eliminate different library objects with the same name but
different types or definitions.  I made some changes to insert
and daterec to try to prevent ending up with such conflicts again.
If someone tries to insert a library item that already exists
in someone else's library, TPS gives the user the (suggested)
option of copying that item to their library (using copy-libobject,
omitting extra-remarks) and then allowing the user to modify his
copy (eg, changing provability status, etc).  A similar change was
made to daterec.  The user is given the chance to copy the gwff
from someone else's library to his before doing the daterec.
Before, daterec would create a new entry for the gwff (shallow
of the eproof), but was having trouble calculating the constants
(eg, infix constants) that should be in the needed-objects.
In the (unlikely) case that daterec is called on a gwff that
isn't anywhere in the library, it still allows the user to create
an entry for it in his library, but now calculates the constants
that should be in needed-objects.  

Files Changed:  library2.lisp
=========================================================================
CEB			CLASS SCHEME/DIRECTION		June 17, 2002

There are two flags: CLASS-SCHEME and CLASS-DIRECTION.  Each
classification scheme has a "class direction" (Up or Down).
I changed the code so that this direction is saved along with
the class-scheme in the library, and so that when the user sets
class-scheme, class-direction automatically gets set.

Files Changed:  lib-objects.lisp
=========================================================================
CEB			CONSTRAINT TYPEABBREV BUGS	June 18, 2002

Changed a number of calls to the "type" function to calls to
the "unabbreviated-type" function in the constraints code.
The problem with the type function is that it may return, eg,
S instead of (O(OI)) in certain contexts.  

Files Changed:  constraints.lisp
=========================================================================
CEB			QUIETING NATURAL DEDUCTION	June 18, 2002

Setting the flag printlineflag to NIL eliminates the printing of many
lines during the construction of a natural deduction proof
(eg, when lines get deleted).  So, I added "printlineflag NIL"
to the quiet mode defined in maint.lisp.  I also added this to
the alias quiet in the common tps3.ini file.  I changed the
end of the function etr-nat-assert-lemmas to avoid calling
pall (when printlineflag is NIL) by calling (cleanup) and
(remove-unnecessary-gaps) explicitly instead of calling
the tactic make-nice.  I also commented out the closefns
for the mexpr move so that messages like "(n moved to m)"
aren't printed.  The INTRODUCE-GAP tactic still prints
this kind of information when verbosity is up.

Files Changed:  maint.lisp, etr-nat-macros.lisp, otl-rearrange.lisp,
                common/tps3.ini
=========================================================================
CEB			DEBUGGING HINTS IN PROG GUIDE	Sept 26, 2002

Added some information to Section 1.10 of the Programmers' Guide
about using dumplisp in Allegro to save and restore a Lisp image.

Files Changed: doc/prog/intro.tex
=========================================================================
CEB			MS98-TRACE-FILE			Oct 3, 2002

Changed direct reference to the file "ms98-trace" to the
global *ms98-trace-file*.  This global can be used to set
the filename for the ms98 trace file and was already used
in, e.g., ms98-top.lisp.

Files Changed: ms98-unif.lisp
=========================================================================
CEB			PREVENTING THROWS TO DEBUGGER	Oct 3, 2002

We noticed that TPS gets thrown into the debugger when it tries to
write to or create a file for which the user does not have permission
to do so.  I changed copy-file and vpd to handle these errors by
alerting the user of the failure and returning to a top level prompt.

Files Changed: maxsys.lisp, vpforms.lisp
=========================================================================
CEB			TEMPORARY FILES			Oct 3, 2002

Some temporary files were being created in the directory from which
the user started TPS.  (For example, the library "search" command.)
This would cause an error when the user did not have permission.
I created a new function new-tmp-filename which creates a temporary
file (name) under the /tmp/ directory (where every user should have
permissions).  This new function is now used by the library commands
search, sort, reformat, retrieve-file and reindex.  It is also used
by create-subproof.  For uniformity, I also modified diy-l and 
uniform-search-l to use this function (though they were already 
creating a file in the /tmp/ directory).

Files Changed: core.exp, boot0.lisp, diy.lisp, library1.lisp,
   library2.lisp, saveproof.lisp, test-top-top.lisp 
=========================================================================
CEB			HELP FOR ADD-BESTMODE		Oct 15, 2002

Added information about test-init/tps-test to the help message for 
add-bestmode.  Also, changed the add-bestmode argument dont-auto-test
to auto-test and default to T so that the user is asked if the
mode should be used for automatic testing instead of being
asked if it should not be used.

Files Changed: library2.lisp, library3.lisp
=========================================================================
PBA		FIXED FONT PROBLEM ON ANDREW		2002 Oct. 22

Changed /afs/andrew.cmu.edu/mcs/math/etps/etps.Xclients, replacing
"xset fp+" to "xset +fp" everywhere. This puts the special fonts for
ETPS users at the beginning rather than at the end of the font path.
This fixed a problem on sun4x_58 machines, where the formulas were
being printed with the special characters higher than they should be.
Presumably the default fonts on these machines had some variants of
the fonts in /afs/andrew.cmu.edu/mcs/math/etps/fonts/decfonts which
were being used instead of the desired fonts and causing the trouble.
=======================================================================
CEB			LINELIST HELP			2002 Oct 24

Added examples to help for linelist argtyp.

Files Changed: argtyp.lisp
=======================================================================
CEB			COPYRIGHT			2002 Oct 24

Removed dates from copyright notice.

Files Changed: tps3-save.lisp
=======================================================================
CEB			ETPS INTERFACE			2002 Oct 31

Created a new file and module "external-interface" for code
for communicating with an external interface (which used to
be in external.lisp and the module external-services).
This module is now included in ETPS (in the files common/etps-build.lisp
and common/etps-compile.lisp) so that the Java interface can
be used with ETPS.  Also included the option "-etps" which
is sent to the Java code when starting the Java interface.
This tells Java to only include menus and menu items appropriate
for ETPS.  "defmenuitem" now has an extra slot to indicate
if the menuitem should be available in ETPS.

Files Created: external-interface.lisp
Files Changed: defpck.lisp, external.lisp, tps3-save.lisp, menus.lisp,
   boot0.lisp, ed-menus.lisp, flag-deps.lisp, lib-menus.lisp,
   mate-menus.lisp, metree-menus.lisp, review-menus.lisp, unix-library1.lisp,
   core.exp
=======================================================================
CEB			JAVA INTERFACE			2002 Oct 31

Included a new option "-nopopups" when starting TPS with the
Java interface.  Suppose this option is included in the command line
as in the example:

lisp -I /home/theorem/tps/tps3.dxl -- -javainterface cd /home/theorem/tps/java/ \; /usr/bin/java TpsWin -nopopups

Then it will be passed as an option to the Java code in TpsWin.java
and the Java interface will include a TextField at the
bottom of the TPS window.  The user can use this TextField to
directly enter commands (instead of using the menus).
The "-nopopups" option also tells TPS not to send "fancy" prompt
information.  Instead it uses the same kind of prompts as
the xterm interface and uses the TextField for responses to
prompts.

Files Changed: otl-rearrange.lisp, lib-bugs.lisp, lib-ops.lisp, 
  library1.lisp, library2.lisp, library3.lisp, tpstop.lisp,
  core.exp
=======================================================================
CEB			JAVA INTERFACE SYMBOLS		2002 Nov 12

Changed the way symbols are communicated from TPS to the
Java interface (sending two bytes instead of one) so that
we can have many more symbols.  As an example, I added
EPSILON for ISTYLE (interface style).

Files Changed: interface-style.lisp (and some java files)
=======================================================================
CEB			JAVA INTERFACE 			2002 Nov 12

Added a tps/etps command "javawin" and a (maintenance)
flag "java-comm" which allows the user to open the java interface from
a running tps.  The value of "java-comm" is not meant to be set
by the user, but is one of the flags set in tps3.sys when building
TPS.  Updated the Makefile to put this into tps3.sys when building
under Linux.  The command "javawin" also should allow the user to bring
up the Java interface under Windows.

In addition to updating the Makefile (in common and on each *tps machine),
I updated tps3.sys.example and tps3.sys.windows.example
in /home/theorem/project/dist on gtps, so that the distribution will
provide an example of how to set java-comm.

Files Changed:  external-interface.lisp, maint.lisp, argtyp.lisp,
  maint.exp, core.exp
=======================================================================
CEB			JAVA INTERFACE 			2002 Nov 19

Added a new tps command line argument "-other" for use with the command
line "-javainterface" which allows us to distinguish which command
line arguments are meant to be sent to java TpsStart.  The java
code now recognizes new command line arguments -screenx, -screeny,
-bottomOffset, and -rightOffset.  These allow the user to
set up the initial size of the Java Tps window and the extra
room needed at the bottom (to account for the prompt) and right
(to account for the scrollbar).  These values differ with different
machines and different operating systems.

Files Changed:  tps3-save.lisp
=======================================================================
CEB			MS WINDOWS INSTALLATION		2002 Nov 19

Added a file make-tps-windows.lisp to common and a link to it
from /home/theorem/project/dist on gtps.  This will be sent out
with the new distributions.  The file helps Windows users compile
and build TPS and ETPS on their machines.  It also helps compile
the Java files (when appropriate) and batch files for various ways
of starting TPS under Windows.  Also updated admin/aliases-dist
(also a link in /home/theorem/project/dist) to reflect the new ways
of starting tps with java.  Updated README.unix and README.windows
in /home/theorem/project/dist.
=======================================================================
CEB			DOCUMENTATION			2002 Nov 21

Updated ETPS Manual, User's Manual, and Programmer's Guide to
include information about the Java interface.  The chapter of
the User's Manual on setting things up includes information
about how to install TPS (and ETPS and the Java interface)
under MS Windows.
=======================================================================
CEB			DOCUMENTATION			2002 Dec 1

Updated User's Manual chapter about setting things up
to correspond to changes we made in the README.unix
and README.windows.txt files in the dist directory.
Also included remarks in the ETPS and User's Manuals
about needing to click on a Java TextField prompt to 
enter input.
=======================================================================
CEB			GOODMODES and TEST-INIT		2002 Dec 20

Created a new (MAINT) flag GOODMODES and added a setting
for it in the common tps3.ini file.  It should be a list
of modes that have been sufficiently successful.

Also, changed TEST-INIT to allow the option of setting
TEST-THEOREMS to a set of user specified theorems
on a set of user specified modes (with GOODMODES as the default).
It also allows the user to set TEST-THEOREMS to all
theorems with goodmodes as before.

Files Changed: maint.exp, maint.lisp
=======================================================================
CEB			TPS-TEST			2002 Dec 29

Added a new argument STOP-ON-SUCCESS for TPS-TEST that stops
trying to prove a theorem once it has found a successful mode.
If TEST-THEOREMS lists several theorems, TPS-TEST will
continue to seach for proofs of other theorems.  For example,
if TEST-THEOREMS is set to

((X5310 MODE-X5310-PR00) (X5310 MODE-X5310-MS98) (THM2 EASY-SV-MODE))

and one chooses STOP-ON-SUCCESS to be T, then TPS-TEST will
succeed on X5310 in mode MODE-X5310-PR00, *skip* trying X5310 
with mode MODE-X5310-MS98, then prove THM2 in mode EASY-SV-MODE.

Also, added a timeout feature for TPS-TEST when running under
Allegro (5.0 or later).  This uses the multiprocessing
available under Allegro.  The timeout can be set to a number of seconds
or INFINITY.

Files Changed: maint.lisp, maint.exp
=======================================================================
CEB			ETPS CLASS INTERFACE		2003 Jan 2

I added some code to TPS to allow students to access etps
through the web using the java interface.

There is a new TPS command SETUP-ETPS-CLASS that a teacher
can use to create a file of "userids" and "passwords"
for students.  The filename is set by the new flag
USER-PASSWD-FILE.  This file should be placed in the
directory where the etps server will be running, e.g.,
/home/theorem/etpsclassonline/

To start an etps server, use the new command line option
-classjavaservice (this works with either TPS or ETPS)
as follows.  From the directory with the 

lisp -I <fullpath>/etps.dxl -- -classjavaservice portnum . lisp <fullpath>/etps.dxl &

This will wait for a connection.  When a connection is established,
ETPS will start a new server waiting for another connection.
Meanwhile, ETPS will ask the user to give a userid and password.
If this is not listed in the USER-PASSWD-FILE, ETPS will break
the connection and exit.  Otherwise, a java window interface will
open and the session with ETPS via the java interface will begin.

The relevant java file is java/EtpsAppletClassStart.java
The current version of the web files include a perl script
etpsclassonline.pl and text files etpsclassonlineform
and etpsclasstutorial.   All of these files are under 
/home/httpd/cgi-bin on htps.  We need to include them 
in the distribution if we want others to use these.

Files Changed: tps3-save.lisp, external-interface.lisp,
   etps-events.lisp, core.exp
=======================================================================
CEB			GOODMODES			2003 Jan 10

Updated the setting of the flag GOODMODES in common/tps3.ini
to be a complete set of 53 "good modes".  That is, for every
theorem that has a bestmodes, there is some member of
GOODMODES that proves that theorem.  There are alternative
complete sets of 53 or 54 goodmodes.
=======================================================================
CEB			GOODMODES			2003 Jan 29

Added a new kind of library item "GOODMODE-LIST" and
tps object "GOODMODES".  One can create a "GOODMODES"
object using "defgoodmodes" (an example for the default
value GOODMODES1 is in the common tps3.ini file now).
One can insert a list of goodmodes into the library
using INSERT giving GOODMODE-LIST as the type.
I changed the flag GOODMODES so that it is set to a symbol
naming a list of goodmodes.  

Updated TEST-INIT to allow other options for testing
theorems with goodmodes.  Also made new library commands
ADD-GOODMODES and REMOVE-GOODMODES for manipulating goodmodes.

I added library objects GOODMODES1 - GOODMODES672 in my
library.  These correspond to the sets of goodmodes I
generated using testing over the past few months.

Files Changed: core.exp, maint.exp, lib-objects.lisp, library3.lisp,
   flagging.lisp, review.lisp, maint.lisp
=======================================================================
CEB			ETPS CLASS JAVA INTERFACE	2003 Jan 29

Updated the user interface of students using ETPS over the web.
The command line switch -classjavaservice is used to start an
ETPS server (this can also be used to start a TPS server).
We still require users to login with a USERID and PASSWORD
listed in the file named by the flag USER-PASSWD-FILE
(see SETUP-ETPS-CLASS).  But now, after the student has been
accepted, ETPS makes a new subdirectory for the student
(if one does not yet exist), cd's to that directory, and
starts a new ETPS (or TPS) using the command line switch
-classjavauser.  Then, the student (remote user) is working
with ETPS under 'e's own directory.

I updated the "definfo" for "command-line-switches" in tps3-save.lisp
(which was quite out of date at this point).

Ensured remote users of etps cannot change expert flag (unless
their "remote-userid" is on expert-list).  Note that the
"remote-userid" is distinct form (status-userid) since the
remote-userid is the userid of the student using ETPS remotely
and (status-userid) is the userid that is running the ETPS
service (e.g., theorem).

Created a new command "ls" that lists the files in the current working
directory.  This can be used by students using ETPS remotely to
see what files they have in the directory etps creates for them.

Files Changed: tps3-save.lisp, external-interface.lisp, core.exp,
   maint.lisp, etps-events.lisp
=======================================================================
CEB			JAVA MENUS			2003 Feb 17

Fixed a misspelling of "propositional" in a java interface menu.

Files Changed: menus.lisp
=======================================================================
CEB			LIST-RULES			2003 Feb 17

Changed "list-rules" to list rules organized by contexts.
Also, the new one makes sure to list RULEP, ASSERT, ADD-HYPS
and DELETE-HYPS, though these are not generated from the rules 
package.

Files Changed: otl-help.lisp
=======================================================================
CEB			MATH-LOGIC-2-* MODULES		2003 Feb 17

Moved the files ml2-replace and ml2-axioms from the
MATH-LOGIC-2-RULES module to the MATH-LOGIC2-WFFS module
since there are no ml2-replace.rules or ml2-axioms.rules.
This caused a problem when ASSEMBLE-MOD was applied to
MATH-LOGIC-2-RULES.

Files Changed: defpck.lisp
=======================================================================
CEB			RULEC1 CONTEXT			2003 Feb 17

Changed the context of rulec1 in ml2-hacks.rules to
be rules-4-quant instead of rules-2-prop.

Files Changed: ml2-hacks.rules
=======================================================================
CEB			ETPS JAVA INTERFACE		2003 Feb 18

Fixed the "ls" command so that it displays the type of a file,
e.g., "x2109.work" or "x2109.prf" instead of just "x2109".

Files Changed: external-interface.lisp
=======================================================================
CEB			HELP FOR ASSERT			2003 Feb 21

Updated help for assert.

Files Changed: ml1-prior.lisp
=======================================================================
CEB			LATEX-PREAMBLE			2003 Feb 21

Changed LATEX-PREAMBLE default value so it's appropriate for
latex2e.  \documentstyle[tps]{article} is now \documentclass{article}.
Also, we explicitly input tps.sty.
Also, changed the value in the common tps3.ini and etps.ini file.

Files Changed: otl-scribeout.lisp
=======================================================================
CEB			TEXPROOF, ETC.			2003 Mar 12

I made several changes to the way TEXPROOF works.
First, there are new TeX macros defined in tps.tex:
\raggedleft (used to right justify justifications)
\cebproofline and \cebprooflinea (used to print
a line nicely formatted allowing more flexibility
for the occurrences of turnstiles).  The old
way of formatting proofs used "halign" (and this
is still used for some flag settings).  The
setup for the "halign" was part of the default
setting of the flag TEX-PREAMBLE.  Since most
TeX files generated by TPS don't need to use 
the "halign" environment, I changed the default
value of TEX-PREAMBLE to the empty string "".
The old value is in the global variable
*tex-halign-preamble* which is used where appropriate.

The original reason for these updates was to make texproof respect
TURNSTILE-INDENT-AUTO and TURNSTILE-INDENT.  Before, texproof always
placed the turnstile at column 24.  The value of TURNSTILE-INDENT-AUTO
can be FIX, MIN, VARY, or COMPRESS.  If the value is FIX, then the
number which is the value of TURNSTILE-INDENT determines where to put
the turnstile (if this is too small for a particular line, then it
puts the turnstile in the smallest possible column on the line).  If
the value is MIN, then texproof computes the least column that works
for all lines and puts the turnstile in this column on every line.  If
the value is VARY or COMPRESS, then the turnstile is always put just
after the line numbers of the hypotheses of the line.  The value
COMPRESS also makes texproof leave some spaces out of the formulas in
the proof.

I added a new flag PAGEWIDTH which sets the RIGHTMARGIN
for the TeX file.  This only has an affect if PPWFFLAG is T
or if DISPLAYWFF is T.  There are also new flags 
TEX-BREAK-BEFORE-SYMBOLS and TEX-BREAK-AFTER-SYMBOLS
which list symbols that TeX should allow line breaks
before or after.  (Effectively, this means TeX goes
out of and back into math mode before and/or after
the symbol.)  This only has an affect when PPWFFLAG and
DISPLAYWFF are both NIL.

Internally, I improved the way TPS counts the
cursor position ("curpos") so that (when PPWFFLAG or
DISPLAYWFF is T) TPS makes more reasonable line breaks.
I also fixed some indentation problems (some lines
were not being indented that should have been).

I also made changes to the way the library commands
TEX-ALL-WFFS, TEXLIBDIR and TEXLIBFILE work.
The main difference is that before the comments
in mhelp and other-remarks often contained special
characters that caused errors for TeX.  I now have
TeX use the \tt font for such comments and use
special ASCII character codes for special characters.

Files Changed: core.exp, deftex.lisp, otl-scribeout.lisp,
    pprint.lisp, prenex.lisp, prtop.lisp, lib-objects.lisp,
    lib-ops.lisp, library1.lisp, wffout.lisp 
=======================================================================
CEB			CD				2003 Mar 12

Stopped exporting the symbol cd from the core package
since this caused a problem with Allegro 4.3.
Instead, the defunixlibrary command is now (internally)
user::cd.  One still calls the command "cd".

Files Changed: core.exp, unix-library1.lisp
=======================================================================
CEB			EXT= RULE			2003 April 4

Added side conditions to ext= rule to make sure the bound variable
"x" is not free in the left or right side of the equation.
The old rule was unsound.

Files Changed: ml2-logic7a.rules
=======================================================================
CEB			LIST-RULES*			2003 April 4

Changed list-rules* to list the rules ordered in the same way
as list-rules, separated by contexts.

Files Changed: otl-help.lisp
=======================================================================
CEB			NEW PRINTING SUBJECTS		2003 April 4

Added new subjects PRINTING-TEX and WINDOW-PROPS.
Several flags were changed to have this subject either
instead of the subject PRINTING or in addition to the
subject PRINTING.

Files Changed: subjects-core.lisp, core.exp, deftex.lisp, edtop.lisp,
  etr-nat-macros.lisp, otl-scribeout.lisp, prfw.lisp, prtop.lisp,
  prtotl.lisp, test-macros.lisp, vpforms.lisp, wffout.lisp,
  xterm.lisp
=======================================================================
CEB			GOODMODES			2003 April 5

Changed the libobject GOODMODE-LIST to MODES-GWFFS.
Also, created a category and an argtype MODES-GWFFS.
Changed flag GOODMODES to be of flagtype MODES-GWFFS
instead of SYMBOL.  Created a MODES-GWFFS called EMPTYGOODMODES
which has no modes and no gwffs.  This is used as the
default value for GOODMODES.  Updated the help information of
test-init to be more descriptive and reflect these changes.

Files Changed: core.exp, maint.exp, argtyp.lisp, flagging.lisp,
  lib-objects.lisp, library3.lisp, maint.lisp, review.lisp
=======================================================================
CEB			SUBJECTS			2003 April 5

Added an argument show-help to the subjects review command
which shows the help message for each subject along with listing
the subjects.

Files Changed: review.lisp
=======================================================================
CEB			HELP				2003 April 5

Suppressed the MENU and MENUITEM categories when printing help.
Practically everything is a MENU or MENUITEM and there's no
useful help information about them (and no need to have help about them).

Files Changed: mhelp.lisp
=======================================================================
CEB			TPS-TEST			2003 April 17

Changed TPS-TEST so that one can choose to iterate
testing the theorems and modes on TEST-THEOREMS a finite
number of times increasing the timout by a factor on each
iteration.  Also, had TPS-TEST catch errors and put the
error information in the output file (e.g., tps-test-output.doc)
unless the error is a Keyboard interrupt.  Changed the default
of the argument stop-on-success to be T.

Updated the help message.

Files Changed: maint.lisp
=======================================================================
CEB			JAVAWIN				2003 April 25

Changed the JAVAWIN command to use the universal internal
IP address 127.0.0.1 instead of the value of MACHINE-INSTANCE.
This fixed a problem with using JAVAWIN on itps (the laptop)
when the wireless card was in.

Files Changed: external-interface.lisp
=======================================================================
CEB			TPS-TEST			2003 April 26

Added an argument to TPS-TEST which starts a new TPS image
for each proof attempt.  This uses the -batch command line
switch.  Added a -testwinfile command line switch so the
slave TPS can send info to the testwin info.

Files Changed:  core.exp, tps3-save.lisp, maint.lisp
=======================================================================
CEB			TPS-TEST			2003 May 22

Changed the default value for the output file of tps-test.
It was always "tps-test-output.doc".  Now, if there is a single
theorem <THM> in the TEST-THEOREMS list, the default value
is "tps-test-<THM>.doc".  If there are multiple theorems
but one mode <MODE> in the TEST-THEOREMS list, the default value
is "tps-test-<MODE>.doc".  Otherwise, the default is
"tps-test-output.doc"

Files Changed: maint.lisp
=======================================================================
CEB			BESTMODES			2003 May 22

Changed the loading of bestmodes to remove duplicates.
When TPS reads an entry from a bestmodes.rec file, 
it now uses "adjoin" to put it in the list (of bestmodes for
that theorem) unless it already occurs.  
Previously it always added it to the list.
As a result, copy-libdir will no longer create duplicate
copies of bestmodes in bestmodes.rec.

Files Changed: library3.lisp
=======================================================================
CEB			EXT-SEQ				2003 June 3

Released code for a new top level: EXT-SEQ.
In this top level, one can use ND-style commands (prove, pall,
delete, pstatus, pplan, saveproof, restoreproof) to
construct, modify, save and restore extensional sequent
derivations.  There are sequent calculus rules and tactics.
The rules can be applied by issuing commands.
The tactics can be applied using the command GO2.
There is now a new "use" for tactics called EXT-SEQ.
GO2 uses the compound tactic GO2-TAC with use EXT-SEQ.

The new files are in a new module ext-dags (see defpck.lisp).
This module has been added to the tps-compile*.lisp and 
tps-build*.lisp files in common.

I also made a minor change in prt.lisp which has the affect
of omitting printing the "type" of a symbol that has no type.
(This case would usually be a bug anyway, but was being printed
as the type "NIL".)  The affect is to print a "," separating
wff's of a sequent without printing a type for the ,.
Before I handled this problem by *never* printing types
when printing a sequent calculus derivation.  Now, we can
show the types without showing a "NIL" type for the ","
separators.

Files Changed:  auto.exp, ml.exp, core.exp, defpck.lisp, contexts-auto.lisp
	tactic-macros.lisp, prt.lisp, ftree-seq.lisp
New Files: ext-seq.lisp, ext-seq-top.lisp, ext-seq-tactics.lisp,
=======================================================================
CEB			MINOR = BUG			2003 June 3

create-propsym was being used with the = symbol when
inherit-abbrev was intended.  Fixed this.

Files Changed:  nat-etr.lisp
=======================================================================
CEB			WFFOPS				2003 June 3

Wrote a few new operations on wff's which are used in the sequent
code but may certainly be useful in other contexts:

(replace-wff-posn wff posn newsub) : replaces the subformula of "wff"
   in position "posn" with the formula "newsub"

(get-wff-posn wff posn) : returns the subformula of "wff" in position "posn"

A "position" is a list of T's and NIL's where NIL indicates a "car"
and T indicates a "cdr".

(instantiate-all-rec inwff exceptions) : returns the result of instantiating all 
   abbreviations in "inwff" (except those listed in "exceptions") recursively until
   none remain.

Created an editor command install-rec which calls instantiate-all-rec.

Files Changed:  wffsub1.lisp, wffabb2.lisp, edabb.lisp
=======================================================================
CEB			RESTOREPROOF			2003 June 4

restoreproof wasn't checking that the S-expr in the .prf file
is a cons before taking the car.  It does now.

Files Changed: saveproof.lisp
=======================================================================
CEB			TPS WEB SERVER			2003 June 7

Made some major changes to the way TPS and ETPS are accessed online.
There are new command line switches -server and -remoteuser.
When TPS or ETPS is started with the -server switch,
it acts as a web server.  The default port for the socket
waiting for connection is 29090, but this can be explicitly
given using a -port switch after the -server switch.
The -remoteuser switch is used when the server starts a fresh
TPS or ETPS image which is being used remotely.
These switches are more fully documented in the definfo
for COMMAND-LINE-SWITCHES.  From TPS, run
HELP COMMAND-LINE-SWITCHES.

The old command SETUP-ETPS-CLASS has been changed to the more
general SETUP-ONLINE-ACCESS.  Using this command one can
specify user id's and passwords for remote access to both TPS and ETPS.
One can also specify if anonymous users are allowed to run TPS or ETPS.

Old command line switches -javaservice, -classjavaservice, and -classjavauser
have been deleted.

Documented how to set up and use the TPS server (generally and for a teacher
of a class using ETPS) in the User manual.

Files Changed: core.exp, tps3-save.lisp, external-interface.lisp, linereadp.lisp,
   doc/user/set-up.mss
=======================================================================
CEB			TPS WITH INTERFACE		2003 June 10

handle-user-interrupt was sometimes halting a mating search when
using the interface.  I disabled handle-user-interrupt when using
the interface to fix this problem (the interface provides its
own way of interrupting an executing command).  Also, the timing
information wasn't showing up after running diy through the interface.
This was because "istyle" wasn't listed in case statements in
timing.lisp.  I added the istyle case.

Files Changed: external-interface.lisp, mating-dir.lisp, timing.lisp
=======================================================================
CEB			CONTEXTS			2003 June 12

Moved code for generate-java-menus and setup-online-access
into the maint package and the tps-maintenance context.
Put the ls mexpr in the lib-printing context.
Created a new interface context and put the javawin
command in this context.

Files Changed:  maint.exp, core.exp, defpck.lisp, maint.lisp,
  menus.lisp, external-interface.lisp
=======================================================================
CEB			PIY, DIY2, DIY2-L, PIY2		2003 June 30

Programmed new commands PIY, DIY2, DIY2-L and PIY2 for attempting to
prove a theorem automatically.  PIY combines PROVE and DIY.  PIY will
try to get the user to load a mode, either a bestmode (if one exists),
or a goodmode (determined by the value of GOODMODES), or an explicitly
given mode.

PIY2, DIY2 and DIY2-L are analogous to PIY, DIY and DIY-L, resp.,
except they try to prove the theorem (or planned line) using a variety
of modes like TPS-TEST does.  The default list of modes is determined
by the value of GOODMODES (as with TEST-INIT option 1).  Under some
lisps (Allegro >= 5.0), one can give a time limit for each proof
attempt as with TPS-TEST.  This time limit is for the time to conduct
mating search and does not include time for merging or translation.
In other versions of lisp, the user is warned that TPS can't time out
and offers to abort the command.

Under Allegro >= 5.0, there are also new commands DIY-WITH-TIMEOUT
and DIY-L-WITH-TIMEOUT which act just like DIY and DIY-L except
the user gives a timeout for the search attempt.

Changed the way default values for line-range are computed for DIY-L
and DIY2-L since it was giving bad results when there is no gap
between the support lines and planned line.  Also, made DIY-L and
DIY2-L double check to make sure that the line-range gap is empty.
When there is a line somewhere in the gap, we sometimes had problems
with translations.  Now it fails immediately and warns the user if a
line exists in the given range.  In particular, if one tries to do a
DIY-L or DIY2-L when there is no gap between a support line and the
planned line, the command will fail and the user will be forced to
introduce a gap explicitly.

Finally, I noticed during the translation of examples like THM2
where a (set existence) lemma gets asserted, the lemma was asserted
with hypotheses.  This sometimes causes a problem with DIY-L since
the lemma might get asserted on a line *before* a hypothesis.
So, now these lemmas are asserted without hypotheses (which makes
more sense since the lemma does not depend on any hypotheses).

Files Changed:  auto.exp, diy.lisp, library3.lisp, test-top-top.lisp,
	etr-nat-macros.lisp
=======================================================================
CEB			Classification Schemes		2003 June 30

We weren't able to see the help messages for class-scheme's.
I fixed this by making class-scheme a category (defcategory)
so we could see the help messages.  I also added a new deftype%
for libclass, corresponding to the already existing defstruct
for libclass.  Since class-scheme is now a category, there is
a corresponding global list of class-schemes "global-class-scheme-list"
which is now used for may computations (e.g., pschemes).
New class-scheme's are now defined using the macro def-class-scheme
instead of just adding properties to a symbol.  

Added a help message to the automatically generated class-scheme
called "LIBDIR".

Files Changed: core.exp, lib-macros.lisp, lib-objects.lisp,
	lib-ops.lisp, library2.lisp, library3.lisp,
	unix-library1.lisp
=======================================================================
CEB			EXT-DAGS CHANGES		2003 Aug 12

The module ext-dags (added to tps with the ext-seq top level)
has been changed.  First, a new file ext-exp-dag-macros.lisp
now contains definitions of structures and variables (some of
which were previously in ext-seq.lisp and ext-seq-top.lisp).
This is loaded as a macro file to ensure the compilation process
works properly.  Also, changed the code so that a natural
deduction proof and a sequent calculus proof can have the
same name without confusion.  Added the code dealing with
translating extensional expansion dag proofs into natural
deduction.  Added new contexts ext-exp-dags and ext-search.

Files Changed: defpck.lisp, ext-seq.lisp, ext-seq-top.lisp, auto.exp,
	contexts-auto.lisp, tactics-macros.lisp
Files Added: ext-exp-dag-macros.lisp, ext-exp-dags.lisp,
        ext-exp-dags-nd.lisp, ext-exp-open-dags.lisp
=======================================================================
CEB			MS03-7 SEARCH PROCEDURE		2003 Aug 12

Added a new search procedure MS03-7.  This is a possible value
for DEFAULT-MS.  The procedure works with extensional expansion
dags instead of expansion trees (making the search complete for
extensional reasoning), can do primsubs during search instead
of just in preprocessing, and can to some extent use set constraints
(though there is more to be done).  There are many new flags
under the new subjects MS03-7 and EXT-SEARCH.

Files Changed: argtyp-auto.lisp, auto.exp, constraints.lisp, diy.lisp,
	etrees-flags.lisp, subjects-auto.lisp, mating-top.lisp
Files Added: ext-search.lisp
=======================================================================
CEB			EXT-MATE TOP LEVEL		2003 Aug 12

Added a new top level, EXT-MATE which works like the MATE
top level except uses extensional expansion dags instead of
expansion trees.  Many of the operations for printing the
tree (etd, etp, etc), creating and viewing jforms (cjform, vp, etc),
moving in the tree (l, r, 0, up, etc), and manipulating the tree 
(add-conn, rem-conn, etc) are analogous to the operations for 
trees in the MATE top level.

The EXT-MATE command DIY-LIFT will take a complete extensional expansion
dag and use it to guide the MS03-7 search for a proof, suggesting
flag settings if successful.

Files Changed: core.exp, auto.exp, ext-exp-dag-macros.lisp
Files Added: ext-mate-top.lisp
=======================================================================
CEB			MS03 AND EXT-MATE UPDATES	2003 Sept 2

Added commands for instantiating variables in EXT-MATE top leve.
Added new flags for MS03-7.  There was a bug that caused
some distinct nodes to have the same name, thus making MS03-7
think it had a complete mating when it actually didn't.  This
in particular caused the following bug with THM15B:

THM15B, using MS03-7

     3  prove thm15b  ; load first bestmode
     4  default-ms MS03-7
     5  diy !  ; thinks it succeeds, but doesn't
     6  ext-mate ; (open path, but empty jform?)

When a variable is instantiated into an ext-exp-open-dag node,
sometimes the name of the node changes.  A property on
the old node name points to the new node.  Since this
can happen several times, I changed the code to
recursively check the properties of the names until
it gets to the latest node.

There were bugs with the way definitions which never come
to the head of an atom (e.g., COMPOSE) were being handled
when deepening an instantiated ext-exp-open-dag.  In particular,
if a projection is instantiated for a variable causing the
abbreviation to come to the head of one side of an equation,
it was not being expanded.  This also caused a bug with
THM15B.  I now handle all definitions by expanding them
as soon as they come to the head of an atom or head of
one side of an equation *without* having an explicit
EQUIVWFFS rewrite node (like beta-eta normalization is handled
with such nodes).  This way instantiating does not
force us to surgically put in a rewrite node.

Fixed some minor bugs with tactics for EXT-SEQ top level
and added rules and tactics for expanding abbreviations at the head
of a side of an equation.

Updated relevance information on flags dealing with set constraints
to reference MS03-7.

Expanded the test in pr00.lisp for compound formulas to
allow one to look past negations (where we don't count
a negation as making a formula compound).

Updated the printing of the legend in vpforms.lisp to remove duplicate
names (since dissolution can result in the same literal having
multiple occurrences in the jform).

Files Changed: ext-exp-dag-macros.lisp, ext-mate-top.lisp, 
  ext-search.lisp, ext-exp-open-dags.lisp, ext-exp-dags.lisp, 
  ext-exp-dags-nd.lisp, ext-seq.lisp, ext-seq-tactics.lisp, 
  ext-seq-top.lisp, auto.exp, constraints.lisp, pr00.lisp, vpforms.lisp
=======================================================================
CEB			JAVA MENUS			2003 Sept 9

Changed java menus "Misc Commands" to be "Misc-commands"
and "Top levels" to be "Top-levels" so it's clearer each
is a single menu.  I also ran generate-java-menus with these
updated names, put the new java code into TpsWin.java
and compiled new versions of java on jtps and gtps.

Files Changed:  menus.lisp, java/tps/TpsWin.java
=======================================================================
CEB			TPS Online Documentation	2003 Sept 11

I had to restart the tps online server on htps.  I modified the
documentation in the User manual about the online server by splitting
the steps to set up the online server from the steps to start and
restart it.  Hopefully this will make it easier for a new-comer to
just restart TPS as an online server in the future.
=======================================================================
CEB			PROVABILITY STATUS		2003 Sept 16

We added an item to provability status - 
"Successful mode for automatic proof found automatically."
- corresponds to DIY2.  We also defined a global provability-list.

Files Changed: lib-macros.lisp, library1.lisp, library2.lisp,
	 library3.lisp
=======================================================================
CEB			TPS-BATCH-JOBS			2003 Sept 16

When tps was started with command line switch -batch or -problem,
it would write info to a file named tps-batch-jobs.
We commented this out to minimize extra things written to
user directory.

Files Changed: tps3-save.lisp
=======================================================================
CEB			MODEREC				2003 Sept 16

Fixed a bug with moderec that marked a bestmode to be used
for automatic testing iff the user said not to use it for automatic
testing.

Files Changed: library3.lisp
=======================================================================
CEB			TRANSMIT			2003 Sept 24

Created a new subject called TRANSMIT and added this subject
to many flags.  Updated DIY2 (and PIY2) to transmit the values of
the TRANSMIT flags from the slave tps to the master tps when
the slave finds a successful proof.  The slave also sends
timing info back to the master.  There is a new timing
statistic called DIY2 which gives the total time for running
DIY2.  (This includes unsuccessful attempts to prove the theorem,
time for starting slave tps images, etc.)  Now, daterec
can record the information transmitted from the slave.

Created new flags DIY2-INIT-TIME-LIMIT, DIY2-NUM-ITERATIONS
and DIY2-TIME-INCREASE-FACTOR that give default values for
corresponding user prompts for DIY2 (and PIY2).  If the
user chooses a value other than the default, the flag
automatically gets set to the new value.

Also, made sure DIY2 and PIY2 put temporary files in /tmp
(unless TPS is running under MS Windows) and deletes
these temporary files.

The main changes in the code are in timing.lisp and diy.lisp.
Most of the other files were only changed by adding TRANSMIT
as a subject to some of the flags defined in the file.

Files Changed :  ext-search.lisp subjects-auto.lisp timing.lisp
auto.exp mtree-top.lisp mtree-duplication.lisp mtree-query.lisp
etr-nat-macros.lisp tacticals.lisp tactics-macros.lisp
ms90-3-node.lisp unif-simpl.lisp tactics-aux.lisp rulep-mac.lisp
cnf.lisp constraints.lisp prim.lisp prim-edops.lisp pr00.lisp
wffabb.lisp order-components.lisp etrees-jforms.lisp node.lisp
unif-match.lisp unif-tree.lisp ms90-3-top.lisp unif-subs.lisp
ms90-3-unif-simpl.lisp ms90-3-path-enum.lisp ms90-3-unif-tree.lisp
mating-aux.lisp ms98-macros.lisp ms91-weights.lisp ms91-search.lisp
ms91-enumerate.lisp ms91-basic.lisp min-quant-etree.lisp
option-tree-mateops.lisp etrees-flags.lisp data-structures.lisp
mating-top.lisp lemmas.lisp diy.lisp flagging.lisp wffop-otl.lisp
mtree-print.lisp etrees-wffops.lisp
=======================================================================
CEB			PIY/PIY2 BUG			2003 Oct 14

PIY and PIY2 would look at *last-gwff-typed* to determine
a default wff to prove.  If the value of *last-gwff-typed* is a
string, this caused a bug:

<?> prove "A" A 100
. . .

<41>piy2 
WFF (GWFF0-OR-LABEL): Prove Wff [
Error: Attempt to take the car of "A" which is not listp.
  [condition type: SIMPLE-ERROR]

Restart actions (select using :continue):
 0: Abort entirely from this process.
[1] CL-USER(1): :res

I added a check to only use *last-gwff-typed* as a default if
its value is not a string.

Files Changed: diy.lisp
=======================================================================
CEB			TPS ONLINE			2003 Oct 14

Changed online server web page to distinguish between
anonymous and privileged users more clearly.

Files Changed: external-interface.lisp
=======================================================================
CEB			TPS-TEST OUT FILE		2003 Oct 23

Changed the format of the output file for tps-test
so that it is lisp readable.  That is, everything
in the file is either a comment or is an S-expression
(actually, a string or a list).  

The strings in the file are general messages like

"Proving 3-DIAMOND-THM in mode MODE-DISTRIB-THM-MS98 + QUIET "

The lists in the output file give information like
(HEADER (<prop> <val>) . . . (<prop> <val>))
or
((THM <thmname>) (MODE <modename>) (RESULT . . .) (DATE "<date>") (TIMING "<timeinfo>") (MEMORY "<memoryinfo>"))

The possible values for (RESULT . . .) are
(RESULT TIMEDOUT <numseconds>)
(RESULT MATE-TIMEDOUT <numseconds>)
(RESULT SUCCESS)
(RESULT MATE-SUCCESS)
(RESULT FAILED)
(RESULT WRONG-LAST-LINE)

Files Changed: maint.lisp
=======================================================================
CEB			TPS-TEST 			2003 Nov 6

I made the output file for tps-test pretty printed.
I also added timing information to the list of information
when theorems are successfully proven by a mode.
Also, there was a problem when modes set the flag TEST-THEOREMS
since obviously we don't want the value TEST-THEOREMS to be changed
while running tps-test.  So, I added a new argument to mode
(in flagging.lisp) so that one can pass exception flags which
will not be reset by the mode.  Also, when calling tps-test
with MATE-ONLY, I added an explicit check to make sure the
mating is really complete.  (Before we were always assuming
success unless we timed out.)

Files Changed: maint.lisp, flagging.lisp
=======================================================================
CEB			TPS-TEST 			2003 Nov 13

Added quotes around the file name for tps-test when
it is a command line argument to start a slave TPS.
Without quotes, upper case letters were being changed
to lower case, leading to problems.

Files Changed: maint.lisp
=======================================================================
CEB			EXTRACT-TEST-INFO		2003 Dec 10

Added command EXTRACT-TEST-INFO which extracts and reports information
from a file generated by a run of tps-test.  The user has several
options for what information to extract (there are currently six
options).  The options are listed in the variable
*extract-test-info-options* defined in maint.lisp.  To add a new
option add a new entry into this list in the format used for other
options.  (You can also rearrange options.)  A list of the available
options is added to the help message (for the mexpr) automatically.

Files Changed: maint.lisp, maint.exp
=======================================================================
CEB & PBA	alisp8 vs. alisp			2004 Jan 13

In /afs/andrew.cmu.edu/mcs/math/etps/tps/i386_rh80/Makefile
changed
lisp = /usr/local/bin/alisp
to
lisp = /usr/local/bin/alisp8

In /afs/andrew.cmu.edu/mcs/math/etps/tps/i386_rh80/tps3
changed
alisp -I /afs/andrew/mcs/math/etps/tps/@sys/.tps.dxl -- $*
to
alisp8 -I /afs/andrew/mcs/math/etps/tps/@sys/.tps.dxl -- $*
=======================================================================
CEB		UNIXLIB PROMPT				2004 Feb 23

I changed the unixlib prompt so that it doesn't give an
error if the value of *current-class* is not a LIBCLASS structure.
This problem showed up when we tried to build the facilities guide,
which calls TPS to print the prompt for the unixlib top level
even though *current-class* is NIL.

Files Changed:  unix-library1.lisp
=======================================================================
CEB		USER MANUAL				2004 Mar 3

Added documentation to the User Manual on how to start TPS with the 
-service or -lservice command line switches and then how a client 
program can ask TPS to try to prove a theorem.
=======================================================================
CEB		SEMANTICS				2004 Mar 10

I added two new files for experimenting with semantics.  The files are
included in a new module "semantics".  There are new contexts
"semantics", "models" and "log-relns" and a new subject
"semantic-bounds" for flags bounding computations in models.

All the models considered are standard models where the base types are
domains {0,...,n-1} where n is a power of 2.  The new top level "models"
allows the user to compute in these models.  The command "models" enters
the top level and "leave" returns to the previous top level.

The default value for n at base types is 2, but this can be changed
for any base type (other than "O") using the command CHANGE-BASE-TYPE.
Formulas can be interpreted using the INTERPRET command once variables
are assigned values.  There are several commands such as ASSIGN-VAR,
UNASSIGN-VAR, etc., for changing the values assigned to variables.
There is also a general SOLVE command that will solve for values of
some "output" variables in terms of values of "input" variables making
a given proposition true.

Two flags MAX-DOMAIN-SIZE and MAX-BINDER-COMPUTATION limit the amount
of computation TPS will do when working with these models.  If a
computation exceeds these bounds, a failure is thrown.

Printing commands for viewing elements of types are PELTS, PELTS-REC,
PELT, PELT-REC.  The values in domains at any type are represented by
integers.  At function types, these integers encode a function.  The
size of every type is a power of 2.  PSIZE shows the size of any
particular type (until this value exceeds MAX-DOMAIN-SIZE).

Files Changed: auto.exp, subjects-auto.lisp, contexts-auto.lisp,
               defpck.lisp
New Files:  semantics-macros.lisp, models.lisp
=======================================================================
CEB		MODELS TOP LEVEL			2004 Mar 17

Fixed the help messages for UNASSIGN-VAR and REMOVE-ALL-ASSIGNMENTS.
Updated help messages for PELT and PELT-REC to explain what
EMPTY, FULL, SIGMA and PI mean.  Chaned INTERPRET to give
the return value in 3 notations:  The actual value as a number,
an intermediate notation and a fully recursively expanded notation.
Changed "l" to "k" in help message for models.

Files Changed: models.lisp
=======================================================================
CEB		MS04-2 SEARCH				2004 Mar 21

Installed a new search procedure MS04-2 that corresponds to my
thesis work.  MS04-2 (like MS03-7) uses extensional expansion dags
to search for proofs using extensionality and equality reasoning.
MS04-2 (unlike MS03-7) performs a depth-first (actually, best-first
using weights controlled by flags) search with backtracking.
The depth of the search tree (where depth includes weights)
is bounded, preventing MS04-2 from traversing a false path forever.
The initial depth bound is controlled by MS04-INITIAL-DEPTH.
If no solution is found with this bound, iterative deepening is used.
The depth bound is increased by MS04-INCR-DEPTH and search
begins again.  The user can also set an absolute depth bound
MS04-MAX-DEPTH at which point MS04-2 will give up (the default
value of MS04-MAX-DEPTH is INFINITY in order to ensure completeness).

Created a new subject, MS04-2, which has all the flags relevant to
MS04-2.  Many (but not all) weight flags used for MS03-7 are also
used for MS04-2.  In MS04-2 these flags determine how much weight
to add to the depth of search as some step is performed.

If the flag MS04-TRACE is set to T, MS04-2 will gather information
about the search.  If the search succeeds, then flag settings
will be suggested.  Another way to get suggestions for flag settings
is to use MS04-LIFT in the EXT-MATE top level.

Files Added: ms04-search.lisp
Files Changed: auto.exp, defpck.lisp, ext-exp-dags.lisp, 
	ext-exp-dag-macros.lisp, argtyp-auto.lisp, mating-top.lisp
	diy.lisp, ext-exp-open-dags.lisp, ext-search.lisp
=======================================================================
CEB		EXT-MATE TOP LEVEL			2004 Mar 21

Changed several commands so that the jform will automatically
recomputed after an operation is performed on the extensional
expansion dag (e.g., a connection is added or a substitution 
is performed) if the (new) flag EXT-MATE-RECOMPUTE-JFORMS is 
set to T.

Also renamed the old DIY-LIFT ext-mate command to MS03-LIFT.
Created a new ext-mate command MS04-LIFT which will (attempt to)
lift an extensional expansion proof to a successful search
for a proof using MS04-2.  This should use the given proof
to rule out any bad search paths and lead search directly
to correct choices.  Afterwards, MS04-LIFT will suggest
settings for MS04-2 flags.

Files Changed: auto.exp, ext-mate-top.lisp
=======================================================================
CEB		MS04-2 SEARCH				2004 Mar 30

Added new code for the MS04-2 search procedure including new
flags to control the search and code for set constraints.
Also fixed a minor bug in the translation to natural deduction
from extensional expansion proofs.

Files Changed: auto.exp, ms04-search.lisp, ext-exp-dag-macros.lisp,
    ext-exp-dags-nd.lisp, models.lisp
=======================================================================
CEB		MS04-2 SEARCH				2004 Apr 5

Added new flags for controlling unification in MS04-2 search.
Also updated set constraints to prevent the generation of
trivial set constraints.

Files Changed: auto.exp, ms04-search.lisp, ext-exp-dag-macros.lisp
=======================================================================
CEB		MS04-2 SEARCH (MULTIPROCESSING)		2004 Apr 7

Added a flag MS04-MP-OPTIONS which takes a list of symbols
and uses this to determine which options should start a parallel
process in the search.  This only works when TPS is using Allegro 5.0
or greater.

Files Changed: auto.exp, ms04-search.lisp, ext-exp-dag-macros.lisp
=======================================================================
PBA		ETPS Manual				2004 April 13

Reorganized the ETPS Manual, putting less-used information into
appendices.
=======================================================================
CEB		EXTENSIONAL SEARCH 			2004 May 26

Updated MS04-2 to be closer to the search procedure described
in my thesis.  In particular, I got rid of START-DUP/STOP-DUP
and START-PRIMSUBS/STOP-PRIMSUBS.  Instead the procedure
automatically stops duplicating expansions after the procedure
chooses to do something other than duplicate an expansion node,
and the procedure stops generating primsubs after the procedure
chooses to do something other than duplicate an expansion or
generate a primsub.

Also, updated various help messages.

Files Changed: ext-exp-dag-macros.lisp, ms04-search.lisp 
  ext-mate-top.lisp, ext-search.lisp, constraints.lisp, auto.exp 
=======================================================================
CEB		GNU CLISP	 			2004 May 29

Updated files so TPS would compile under GNU Common Lisp
(http://clisp.cons.org/).  I did this because Ed Zalta wanted TPS on
his Macintosh (with OS Darwin) and Gnu Clisp is freely available for
Darwin (as well as Linux and Microsoft).  We can identify Gnu Clisp by
the :clisp entry in the value of the *features* variable.  The new
compiler directives are identified by #+:clisp or #-:clisp.

The updates mainly involved adding compiler instructions for exporting
conflicting symbols, adding clisp versions of functions in
tops20.lisp: %top-catch%, tps3-save, call-system, etc.  The compiler
also found a few bugs that I fixed.

I also changed the Makefile to make sure tps3-save gets called
when we do a tps-build.  Before it only worked because the versions
of lisp would evaluate several forms piped into the lisp instead of
just one.  Gnu clisp only evaluates the first (apparently) so 
I put a progn around (load "tps-build.lisp") and (tps3-save).

Files Changed: special.exp, core.exp, omdoc.lisp, boot0.lisp,
  ext-seq-top.lisp, tops20.lisp, tps3-save.lisp, common/Makefile
=======================================================================
CEB		MS04-2		 			2004 June 1

Updated the code for MS04-LIFT to account for the changes
to the MS04-2 procedure released on May 26, 2004,
making MS04-LIFT closer to the lifting proof in my thesis.
I also made two minor changes to the way MS04-2 generates
primsubs for quantifiers.  If the type abbreviation S
for (O(OI)) occurs in the theorem, MS04-2 was confusing
this with a base type, now it doesn't.  If every type in the
theorem is propositional, then we add the base type I as
the only base type explicitly.  Otherwise, we would not
generate any primsubs for quantifiers.

Files Changed: ms04-search.lisp
=======================================================================
CEB		DIY2 BUG				2004 June 13

Fixed two bugs with DIY2.  First, there was a problem when merging
raises a lambda rewrite above nodes connecting supporting lines
with goal lines.  Fixed this by changing merging for expansion trees
not to lift such lambda rewrites and by changing the translation
for extensional expansion proofs to look past such lambda rewrites.

Second, DIY2 didn't know it was successful if there were planned
lines other than the one we were proving.  I updated it so
it checks for success by checking if the particular goal line
has been proven.

Files Changed: diy.lisp, mating-merge.lisp, mating-merge2.lisp
=======================================================================
CEB		STOP-SAVE on EXIT			2004 June 18

TPS with the Java interface was exiting by calling "exit"
instead of "userexit".  "userexit" automatically saves any
open work file.  I changed the code to call "userexit" instead of
"exit" so open work files are saved upon exit.

Files Changed: external-interface.lisp
=======================================================================
CEB		JAVA POPUP HELP				2004 June 18

The help messages in popup prompts were being truncated.  The reason
was that lisp was sending java special characters asking the java
interface to change colors.  However, in the help in the popup window
needs to be pure text.  I changed prompt-read so that these particular
help messages are generated as pure text (in particular, using generic
style with *using-interface* temporarily set to NIL).

Files Changed: tpstop.lisp
=======================================================================
CEB		PRFW					2004 June 24

Added some commands to the value of *prfw-iftrue-update-commands*
to make sure all proof windows are updated (e.g., after PALL, CLEANUP,
etc.).

Files Changed: prfw.lisp
=======================================================================
CEB		WEB SITE				2004 July 13

Updated the TPS web site.  Put a new entry into the "whatsnew.html"
file (first update in 6 years).  Added a page giving links to
implementations of Common Lisp and linked this page to the main
TPS page.

files changed: tps.html, whatsnew.html
Files Created: lisp-links.html
=======================================================================
CEB		PROG GUIDE				2004 July 14

Updated the information about porting TPS to new implementations
of lisp.  Added information about extensional proofs to
the chapters on mating and translation.
=======================================================================
CEB		USER MANUAL				2004 July 14

Added a subsection about EXT-SEQ top level in the section
on "Interactive Mode".
=======================================================================
CEB		EXT-SEQ UPDATES				2004 Sep 20

I updated some of the output of tactics used by
GO2 in the EXT-SEQ top level to be more informative.
I also reversed the order in which new plans are
put on an EXT-SEQ derivation to correspond to
the order in which they are returned by tactics.
I updated the debugging code in ext-exp-dags
so it doesn't signal an error when an expansion
term contains an abbreviation (something I've
been meaning to fix for a while).

Files Changed: ext-seq-top.lisp, ext-seq-tactics.lisp,
               ext-exp-dags.lisp
=======================================================================
CEB		MS04-2 BUGS				2004 Dec 6

I fixed minor bugs in the code to calculate weights for 
E-unification steps during the MS04-2 procedure.

Files Changed: ms04-search.lisp
=======================================================================
CEB		MAKE-RRULE				2005 Jan 18

The editor command make-rrule had an argtyp of "bidir" that
is not a defined argtyp.  (This must not have ever worked?)
I changed the argtyp to "yesno" (corresponding to the type
of argument "bidir" in the mexpr make-abbrev-rrule)

Files Changed: edrew.lisp
=======================================================================
CEB		GOODMODES				2005 Jan 22

Updated GOODMODES1 to include 15 new modes and 60 new gwffs
to account for new theorems with bestmodes since 2003.
There are now 68 modes and 639 gwffs in GOODMODES1.

Files Changed: common/tps3.ini
=======================================================================
CEB		XTERM					2005 Jan 31

Added a new flag xterm-ansi-bold with default value 53 which
is used to switch to using the symbol font in xtps (and xetps).
The value of 53 is inherited from the old code.   In Saarbrucken
(in 2005) under Fedora linux and xterm version <X.Org 6.7.0(192)>,
this gives blinking text instead of the symbols (corresponding
to bold).  The value of 49 works in Saarbrucken and may work
everywhere (as 49 corresponds to the ANSI code for bold).
Added some documentation to the Programmers Guide and User
Manual about this.  Also, added commented lines:

;; If you see blinking text in xtps, try uncommenting the next line.
;; For more information, see the User Manual.
;*;(set-flag 'xterm-ansi-bold 49)

to the distributed tps3.ini (and similar text in etps.ini) in
/home/theorem/project/dist/.

Files Changed: core.exp, xterm.lisp, dist/tps3.ini, dist/etps.ini,
  Programmer's Guide, User's Manual
=======================================================================
CEB		XTERM BUG				2005 May 30

I introduced a bug into xterm.lisp in January.
The result was that sometimes pretty printing in XTERM style
would throw to the debugger.  I had forgotten to
put a certain expression in a list.  In particular,
the old line (from Jan 2005)

  (list (list '(27) '(91) (list xterm-ansi-bold) '(109))

in xterm.lisp is now

  (list (list (list '(27) '(91) (list xterm-ansi-bold) '(109)))

Files Changed: xterm.lisp
=======================================================================
MK		TPS FOR CLISP			      2005 September 19

Fixed things so TPS proofwindows work under Clisp

Files changed: core.exp, special.exp, boot0.lisp, tops20.lisp
=======================================================================
MK		MS98-1 & REWRITING			2005 October 11

Added the following flags:

	ms98-external-rewrites, ms98-pollute-global-rewrites,
	assert-rrules

Files changed: auto.exp, core.exp, ms98-macros.lisp, ms98-rewrite.lisp,
  ms98-top.lisp, otl-macros.lisp, otlnl.lisp
=======================================================================
MK		TPS FOR CMUCL19: USER to CL-USER	2005 October 11

Changed things so TPS compiles under CMUCL19.

The essential change is replacing all references to the
package nickname USER by corresponding references to CL-USER.

Additionally, the following files were changed:
  Makefile, make-tps-windows.lisp, tops20.lisp, tps-compile.lisp,
  tps-build.lisp

Note: TPS can be compiled, but automatic proof search doesn't work
properly under cmucl19b.  Automatic proof search does work under
cmucl18c.

=======================================================================
MK              LIBRARY ISSUES                          2005 November 2

- Implemented access to library subdirectories for the Clisp version.
- Fixed several issues concerning write acces to the library by the
  Clisp version. Open streams needed to be closed before the
  corresponding files could be deleted. Similarly, while renaming files
  one was not allowed to overwrite existing files.
- Clisp has special syntax for calling external programs. Changed
  library routines to use that syntax.
- Modification of rewrite rules using the INSERT command failed in some
  cases. This is now fixed.
- Library routines now support reading and writing an additional
  property of rewrite rules - the list of universally quantified
  variables.

Files changed: lib-objects2.lisp, lib-ops.lisp, library2.lisp
=======================================================================
MK              LONG-ETA			       2005 November 10

Fixed the function long-eta for computing the corresponding normal
forms such that we get correct behaviour for non-beta-normal terms.

Files changed: wfflmbd2.lisp
=======================================================================
MK              REWRITING			       2005 November 26

- Added the REWRITING top level.
- Added ASSERT2, ACTIVE-THEORY and DEACTIVATE-THEORY.
- Fixed another bug with clisp in the library routines.
- Modified Matt Bishop's COMMUTE rule in rrule.lib for compatibility
  with the new calling convention for rewfns and appfns. Both types
  of functions are now required to accept at least 3 arguments.

Files added: meta-var2.lisp, s-eqn-macros.lisp, s-eqn-top.lisp,
  s-eqn-rew.lisp, s-eqn-prfw.lisp
Files changed: argtyp-auto.lisp, auto.exp, contexts-auto.lisp,
  core.exp, defpck.lisp, edrew.lisp, lib-objects2.lisp, lib-ops.lisp,
  library2.lisp, match-wffs.lisp, meta-var.lisp, ml2-prior.lisp,
  otl-schema2.lisp, prfw.lisp, saveproof.lisp, wffchange.lisp
  tps-build.lisp, tps-build-windows.lisp, tps-compile.lisp,
  tps-compile-windows.lisp
=======================================================================
MK		REWRITING - SEARCH		       2005 November 30

- Fixed a type-checking issue in the rewriting procedures.
- Added SEARCH to the rewriting top level.

Files changed: auto.exp, edrew.lisp, prfw.lisp, s-eqn-macros.lisp,
  s-eqn-top.lisp, s-eqn-rew.lisp, s-eqn-prfw.lisp
=======================================================================
MK              REWRITING - AUTO                        2005 December 8

- Renamed SEARCH to AUTO, added bidirectional search.
- Changed the definition of call-system for clisp.
- Revised rewrite theory management.
- Improved TeX output for rewriting proofs.

Files changed: auto.exp, core.exp, edrew.lisp, argtyp-auto.lisp,
  library2.lisp, otl-scribeout.lisp, prfw.lisp, tops20.lisp,
  wffchange.lisp, s-eqn-macros.lisp, s-eqn-top.lisp, s-eqn-rew.lisp,
  s-eqn-prfw.lisp
=======================================================================
MK              REWRITING - THEORIES & LIBRARY         2005 December 12

- Extended the definition of theories to contain the attributes
  DERIVED-APPFN and DERIVED-REWFN.
- Fixed bugs with clisp in COPY-LIBOBJECT and MOVE-LIBOBJECT.
- Fixed several issues with the rewriting core.

Files changed:  auto.exp, core.exp, edrew.lisp, lib-objects.lisp,
  library2.lisp, s-eqn-macros.lisp, s-eqn-rew.lisp, s-eqn-top.lisp
=======================================================================
MK              USER TO CL-USER: MAINT.LISP            2005 December 14

maint.lisp still generated references to "user" instead of "cl-user"

Files changed: maint.lisp
=======================================================================
MK              S-EQN AND CMUCL18                      2005 December 16

- The S-EQN package now compiles on cmucl18.
- Miscellaneous bug fixes and minor improvements.

Files changed: auto.exp, core.exp, edrew.exp, s-eqn-macros.lisp,
  s-eqn-prfw.lisp, s-eqn-rew.lisp, s-eqn-top.lisp
=======================================================================
MK              REWRITING: MISCELLANEOUS               2005 December 19

- Restored Matt Bishop's implementation of apply-rrule-once in
  edrew.lisp, since my intermediate implementation is not really used
  by the REWRITING top level, and is not very likely to be of more use
  to Matt's routines than his original version.
- Made several minor improvements in rule matching procedures for the
  REWRITING top level.

Files changed: edrew.lisp, s-eqn-rew.lisp
=======================================================================
MK              REWRITING: SAVE-RRULE                  2005 December 21

SAVE-RRULE now prompts for needed library objects.

Files changed: lib-objects2.lisp
=======================================================================
MK              REWRITING: ABBREVS & PROVE-IN           2006 February 5

- In some cases abbreviations weren't recognized as such by the
  matching routines.
- Due to a bug, PROVE-IN tried to partition the new assertion using
  the relation sign of the active theory. Now it uses the sign from
  its argument theory.

Files changed: argtyp-auto.lisp, edrew.lisp, s-eqn-rew.lisp,
  s-eqn-top.lisp
=======================================================================
PBA 		ADJUSTED DIRECTORY ON JTPS		2006 Sept 27

		OLD
[jtps]/home/theorem% ls -l
drwxrwxrwx    4 theorem  theorem      4096 Sep 20 16:20 tps
drwxrwxr-x    5 theorem  theorem      4096 Sep 19 12:56 tps.jtps
It's not clear why tps.jtps is there. Maybe it's used for the tps that runs on the web.

[jtps]/home/theorem/tps% ls -l
lrwxrwxrwx    1 theorem  theorem        25 Dec  2  2004 doc -> /home/theorem/project/doc
But /home/theorem/project/doc is not there

[jtps]/home/theorem/tps.jtps/doc% ls -l
lrwxrwxrwx    1 cebrown  cebrown        32 Nov 30  2004 lib -> /afs/andrew/mcs/math/TPS/doc/lib

		NEW
Created a new directory /home/theorem/tps/doc which is not a link
[jtps]/home/theorem/tps/doc% ls -l
lrwxrwxrwx    1 pa01     pa01           32 Sep 27 15:44 lib -> /afs/andrew/mcs/math/TPS/doc/lib


=======================================================================
CEB & PBA 	CORRECTED ms04-search.lisp		2006 October 6

In two places changed
       (declare (special checked nil))
to
       (declare (special checked))

File changed:  ms04-search.lisp
=======================================================================
PBA		update afs references			2006 October 11

replace /afs/andrew/mcs/math/TPS/
by
/afs/andrew.cmu.edu/mcs/math/TPS/
everwhere in links in
[gtps]/home/theorem/tps/java 
and [gtps]/home/theorem/tps/java/tps

=======================================================================
PBA		Blinking fonts instead of TPS symbols			2006 Oct 12

Problem about fonts. We got blinking characters instead of the etps
fonts The problem was being caused by the a change in behaviour of
newer xterms, namely that your xetps alias was trying to use the bold
attribute as a character bank switch, but was instead sending the
escape sequence for blink

The key is to insert into the xterm command the following: 
-xrm XTerm.vt100.showBlinkAsBold:true

Replaced
alias xetps "xterm -geometry 80x54 -rw -fn vtsingle -fb vtsymbold -sb -n ETPS -T ETPS -e $tpsdir/bin/etps  &"
alias xetps-big "xterm -geometry 80x36 -rw -fn gallant.r.19 -fb galsymbold -sb -n ETPS -T ETPS -e $tpsdir/bin/etps &"

by

alias xetps "xterm -geometry 80x54 -xrm XTerm.vt100.showBlinkAsBold:true  -rw -fn vtsingle -fb vtsymbold -sb -n ETPS -T ETPS -e $tpsdir/bin/etps  &"
alias xetps-big "xterm -geometry 80x36 -xrm XTerm.vt100.showBlinkAsBold:true  -rw -fn gallant.r.19 -fb galsymbold -sb -n ETPS -T ETPS -e $tpsdir/bin/etps &"

in /afs/andrew.cmu.edu/mcs/math/etps/etps.cshrc
and /afs/andrew.cmu.edu/mcs/math/etps/tps/tps.cshrc

Replaced -fn
by
-xrm XTerm.vt100.showBlinkAsBold:true  -fn
in /home/theorem/tps/.tpsrc on gtps

Made similar changes in tops20.lisp

Files changed: tops20.lisp
/afs/andrew.cmu.edu/mcs/math/etps/etps.cshrc
/afs/andrew.cmu.edu/mcs/math/etps/tps/tps.cshrc
========================================================================================
PBA		Adjusted for fc3 operating system and new lisp		2006-oct-17

After the editing we have:
/afs/andrew.cmu.edu/mcs/math/etps/tps/i386_fc3% diff tps3 tps3-to-2006-oct-17
3c3
< set tps_user=`/usr/bin/whoami`
---
> set tps_user=`/usr/ucb/whoami`
7c7
<  alisp -I /afs/andrew/mcs/math/etps/tps/@sys/.tps.dxl -- -user $tps_user -homedir $tps_homedir $*
---
>  exec /afs/andrew/mcs/math/etps/tps/@sys/.tps.exe -- -user $tps_user -homedir $tps_homedir $*

FIles changed:
/afs/andrew.cmu.edu/mcs/math/etps/i386_fc3/etps
/afs/andrew.cmu.edu/mcs/math/etps/tps/i386_fc3/tps3
=============================================================================
PBA		Compiled TPS with -deprecation			2006 Oct 23

	Compiled TPS with -deprecation for java code on gtps so that 
error messges about deprecated java code would be seen. Used
/afs/andrew.cmu.edu/mcs/math/TPS/old-source/Makefile.deprecate-java.
See tpsjobs file for more information.
=============================================================================
PBA						2006 Oct 23

	Changed andrew to andrew.cmu.edu

Files changed:
/afs/andrew.cmu.edu/mcs/math/TPS/admin/etps-scores/get-scores-linux
=============================================================================
PBA and Michael Wasson				2006 Oct 30

Added file library2-no-auto-keywords.lisp

This is a modified copy of library2.lisp with one line deleted.
When the line is invoked, all abbreviations are recursively expanded,
which sometimes creates an enormous and unmanageable explosion of the
wff.  See the comment in the file about AUTO-KEYWORDS.

At present this file is not included when TPS is built, but it can
loaded into TPS later using a load command or the patch file
=============================================================================
PBA						2006 Nov. 3
	Changed andrew to andrew.cmu.edu in the links in
[gtps]/home/theorem/project/dist
=============================================================================
PBA						2006 Nov 3

changed
/home/httpd/html/tps3.tar.gz
to
/home/httpd/tps3.tar.gz
in
/afs/andrew.cmu.edu/mcs/math/TPS/admin/tps-dist/make-tar.exe

since the file structure on gtps has changed
=============================================================================
Moritz Hardt & PBA					2006 Nov 14

		Instructions for using TPS with GNU CLISP

Installed in /home/theorem/project/dist two files which explain how to use
TPS with GNU CLISP. The file README.gnuclisp gives general instructions, while
run-tps3gnuclisp is a shell script loading tps3 using clisp.

Files created:
/home/theorem/project/dist/README.gnuclisp
/home/theorem/project/dist/run-tps3gnuclisp
=============================================================================
PBA							2007 June 25
	Updated grader manual
changed
coming.mss  records.mss
=============================================================================
D'Arcy MacIsaac						2006 October

Released to beta an 'xtrafonts' collection, which includes the fonts
used by xetps, to the Andrew computing environment. Now students using
xetps on Andrew will not have to worry about getting these fonts on
their fontpath

=============================================================================
PBA	Note on font problem: UTF-8 vs. POSIX Locale	2008 Feb. 27

Added a note to the User manual that the reason for difficulties with
Xterm fonts might be that many recent Linux systems are using a UTF-8
locale while the TPS fonts seem to work only in the traditional POSIX
locale.
=============================================================================
CEB	TPS as an online system at tptp.org		2008 July

From: Chad Brown

Geoff Sutcliffe is working here in Saarbruecken at the moment.
He asked if I could help him include TPS as an online system at  
tptp.org:

http://www.tptp.org/cgi-bin/SystemOnTPTP

Chris Benzmuller's new version of LEO is there and Geoff (with Chris  
and others)
are working on a higher-order version of TPTP.

Geoff has a version of cmucl, which TPS more or less works under.
Unfortunately, a few things in TPS are buggy under the latest version  
of cmucl,
including translating to ND and printing timing information.
Also, tps3.patch causes a minor package name bug.

Geoff needs a version of TPS where I can give a 'problem file' on the  
command
line and TPS simply tries to prove the given theorem.  The 'theorem'  
is specified
by declaring constants, definitions, axioms, and finally the theorem  
to be proven.
The mode will be one of 7 'best modes' which can also be given on the  
command line.

I have experimented a bit and now have a tps3.ini initialization file
which can do what he wants.
====================================================================

PBA	Restoring tpsonline				2009 January 19

In  gtps:/home/httpd/tps.html changed from 

 <dd><img ALT="*" WIDTH=13 HEIGHT=13 src="red_arr.gif"> <A HREF="http://htps.math.cmu.edu:29090/">Try Running Tps or Etps Online via a Java Interface</A>

to

 <dd><img ALT="*" WIDTH=13 HEIGHT=13 src="red_arr.gif"> <A HREF="http://jtps.math.cmu.edu:29090/">Try Running Tps or Etps Online via a Java Interface</A>

since tpsonline is now on jtps


Copied /home/theorem/tps/.tpsrc from gtps to jtps, replacing the old version there
so that bliking symbol problem (see 
PBA		Blinking fonts instead of TPS symbols			2006 Oct 12
message above)
would be fixed

	I rebuilt TPS and ETPS on JTPS and executed
/home/theorem/tpsonline/run-tpsserver and now the web application is working
fine.

	Florin adjusted the boot files on JTPS so that tpsonline is started up
whenever JTPS boots up.
He apparently adjusted [jtps]/etc/rc.d/tpsonline
====================================================================

PBA							2009 March 16-20

Adjusted introductory note in
[jtps]/home/theorem/tpsonline/TPS-online-tutorial
to discuss the Java Applet Window.

Also adjusted the startup page for starting TPS under java to 
make the reference to privileges clearer.
Files changed:
/afs/andrew.cmu.edu/mcs/math/TPS/lisp/external-interface.lisp 
====================================================================
PBA and Adrian Dumitrasc				2009 August 28 & Sept 2

		CALLING TPS ON ANDREW

The old version of
/afs/andrew.cmu.edu/mcs/math/etps/tps/amd64_linux26/tps3
which is now called
/afs/andrew.cmu.edu/mcs/math/etps/tps/amd64_linux26/tps3.old.old
said:
---------
#!/bin/csh -f

set tps_user=`/usr/bin/whoami`
set tps_homedir=`grep $tps_user /etc/passwd |awk -F: '{printf("%s/",$6)}' -`
if ($tps_user != "" && $tps_homedir != "") then
 limit datasize 20m
 alisp -I /afs/andrew/mcs/math/etps/tps/@sys/.tps.dxl -- -user $tps_user -homedir $tps_homedir $*
 else
  echo Cannot determine user's name and home directory.
endif
-------------------------------------------------
	In the old version,
`grep $tps_user /etc/passwd |awk -F: '{printf("%s/",$6)}' -`
was used to establish the tps_homedir.
For example, on gtps (which still uses the old system)
/etc/passwd contains the line
pa01:x:2001:2001:Peter Andrews:/home/pa01:/bin/tcsh
of which the 6th entry is
/home/pa01

However, in summer 2009 the operating system on linux machines on
andrew was changed so that /etc/passwd no longer contains the desired
information, so this part of the code does not work.

------------------------------------------------------------------

A temporary fix for this was
---------
#!/bin/csh -f

set tps_user=`/usr/bin/whoami`
set tps_homedir=`grep $tps_user /etc/passwd |awk -F: '{printf("%s/",$6)}' -`
echo $tps_user $tps_homedir
if ($tps_user != "" ) then
 limit datasize 20m
 alisp -I /afs/andrew/mcs/math/etps/tps/@sys/.tps.dxl -- -user $tps_user -homedir $tps_homedir $*
 else
  echo Cannot determine user's name and home directory.
endif

---------
diff tps3.old.old the-temporary fix

< if ($tps_user != "" && $tps_homedir != "") then
---
> echo $tps_user $tps_homedir			[[This line is just for diagnosis and can be deleted]]
> if ($tps_user != "" ) then

--------------------------------------------------------
The new version of
/afs/andrew.cmu.edu/mcs/math/etps/tps/amd64_linux26/tps3
says
---------
#!/bin/csh -f  

set tps_user=$USER
set tps_homedir=$HOME
if ($tps_user != "" && $tps_homedir != "") then
 limit datasize 20m
 alisp -I /afs/andrew/mcs/math/etps/tps/@sys/.tps.dxl -- -user $tps_user -homedir $tps_homedir $*
 else
  echo Cannot determine user's name and home directory.
endif
====================================================================
PBA	Fixing LOCALE on Andrew Linux Machines		2009 Sept. 15

Many recent Linux systems are using a UTF-8 locale, while the TPS
fonts seem to work only in the traditional POSIX locale. To get the
standard POSIX behavior, one can unset the environment variable
LC_ALL. This can be accomplished by executing the Linux command setenv
LC_ALL C.

Defined /afs/andrew.cmu.edu/mcs/math/etps/etfonts.cshrc
and put into etps-no-xset.cshrc and etps.cshrc the line
alias etfonts "source /afs/andrew.cmu.edu/mcs/math/etps/etfonts.cshrc"
to set the locale and the fontpath when running etps on Andrew Linux 
Machines.

====================================================================
PBA 	INSTALLED EXERCISE X8030A IN ETPS		2010 January 20 

Installed exercise x8030a in ETPS. (The same wff is called tttpQ0Axiom1 
in tpslib. Also added a note to the documentation about how to do
this.)

Files changed:
ml.exp, ml2-theorems.lisp
/home/theorem/project/doc/etps/thms.mss
/home/theorem/project/doc/user/set-up.tex
/home/theorem/project/doc/user/rule-example.tex
====================================================================
RC	UPDATED MACHINE-INSTANCE TO 64-BIT MACHINES	2010 November 10

The relevant lines now read
#+(and :excl (or :linux86 :linux86-64))(fix-machine-instance)
#+(and :excl (or :linux86 :linux86-64))

Files changed:
tps3-save.lisp

====================================================================
RC	TPTP library contributions			2010 November

Translated many items from the tptp library into the tps library

Files created:
/afs/andrew.cmu.edu/mcs/math/TPS/tpslib/tptp
====================================================================
RC      INSTALLED LIBRARY COMMAND FOR TPTP LIBRARY      2010 December 8

Two new commands, INSERT-TPTP and INSERT-TPTP*, and one flag,
AUTO-LIB-DIR, have been added to enable conversion from TPTP Problems
to TPS library items.

Files changed:
library2.lisp, core.exp
/home/theorem/project/doc/user/library.tex
/home/theorem/project/doc/prog/library-rewrite.tex
/afs/andrew.cmu.edu/mcs/math/TPS/utilities/format.tps
/afs/andrew.cmu.edu/mcs/math/TPS/utilities/README-TPTP-to-TPS-library

====================================================================
Cris Perdue	COMPATIBILITY WITH CMUCL 20		 2011 Jan 13

TPS worked well with CMUCL through version 18c.
Under version 19 etree-nat didn;t work
Under version 20 it didn't recognize diy, etc. These problems 
have now been corrected.

As discussed, this assumes that CMUCL is version 19 or version 20.
I have updated the files to use only the :cmu feature and not :cmu19
or :cmu20, without changing the behavior from what you have seen.

The crucial change to special.exp, makes sure
that the symbol LOCAL is properly exported.

The change in otl-cmddef.lisp avoids use of throwfail
at compile-time, which obscures the compile-time error messages 

Use of the CL-USER package rather than USER is a change that has been
in the language for about 20 years now, so it should be plenty safe

UNLOCK-ALL-PACKAGES call avoids another conversation with
the interactive debugger in CMUCL.

Files changed:
Makefile                          
make-tps-windows.lisp             
tps-build.lisp                    
tps-compile.lisp                  
tps3.ini                          
tps3.patch                        
lisp/maint.lisp                   
lisp/otl-cmddef.lisp              
lisp/special.exp                  
lisp/tops20.lisp                  

====================================================================
PBA	Minor changes in TPS download process 		2011 Jan 26

	Changed tpsunix to tps3 in the instructions.
	Modified creation of the TPS tar file so that it contains the
RELEASEDATE file. The RELEASEDATE file is accessible on the web at 
http://gtps.math.cmu.edu/tps-sys.html

Files changed:
/srv/www/cgi-bin/tpsdist.pl
/afs/andrew/mcs/math/TPS/admin/tps-dist/make-tar.exe
/home/httpd/tps-sys.html
====================================================================
CEB & PBA   Added CASC facilities to the TPS tar file 	2011 Feb 3


The TPS distribution now contains a directory casc with instructions
and facilities for running TPS in the CASC competition.

Files changed:
/afs/andrew.cmu.edu/mcs/math/TPS/casc
[gtps]/home/theorem/project/dist/casc

====================================================================
RC & PBA	Improved help messages for		2011 Feb 6
		SAVE-ETREE and RESTORE-ETREE

Files changed:
ftrees.lisp
====================================================================
RC              COMPATIBILITY WITH SBCL		 2011 Feb. 25

TPS now runs under Steel Bank Common Lisp (SBCL). 
TPS source files now use 'defconstnt' instead of 'defconst' to avoid 
a conflict with emacs-lisp.

files changed:
boot0.lisp lib-ops.lisp maint.lisp ms98-dagify.lisp ms98-top.lisp timing.lisp
tops20.lisp tps3-error.lisp tps3-save.lisp
argtyp.lisp linereadp.lisp macsys.lisp ms90-3-node.lisp ms98-macros.lisp
scrdoc.lisp s-eqn-top.lisp timing.lisp
special.exp
Makefile
tps-build.lisp tps-compile.lisp etps-build.lisp etps-compile.lisp

[gtps]/home/theorem/project/doc/prog/intro.tex

====================================================================
PBA		PROGRAMMER'S GUIDE		2011 March 2
		& TAR FILE

	Added programmer's guide to the TPS tar file and the TPS web
site, and put a cautionary note in the introduction. Also added
tpsjobs-done to the TPS tar file.

files changed:
[gtps]/home/theorem/project/doc/prog/intro.tex
[gtps]/home/theorem/project/dist/doc
[gtps]/home/theorem/project/dist/doc/README
[gtps]/home/httpd/tps-mans.html
====================================================================
RC		LATEXDOC			2011 March 9

The TPS Facilities Guide, which is produced automatically, was
originally formatted for Scribe. A method of automatically producing a
version of the manual formatted for latex has been developed,
including a command LATEXDOC analogous to SCRIBEDOC.

files changed or created:
/home/theorem/project/doc/facilities:
latex-facilities-cmd.lisp    latex-manual.tex		   scribe-facilities-temp.lisp
latex-facilities.lisp	     latex-preamble-short.tex	   scribe-manual-cmd.mss
latex-facilities-short.lisp  latex-preamble.tex		   scribe-manual.mss
latex-facilities-temp.lisp   README			   scribe-manual-short.mss
latex-manual-cmd.tex	     scribe-facilities-cmd.lisp    scribe-manual-temp.mss
latex-manual-short.tex	     scribe-facilities.lisp	   scribe-preamble.mss
latex-manual-temp.tex	     scribe-facilities-short.lisp  scribe-preamble-short.mss

/home/theorem/project/doc/lib:
tpsdoc.tex

/home/theorem/project/doc/prog:
help.tex

/home/theorem/project/doc/user:
set-up.tex

lisp:
defpck.lisp  deftex.lisp  latexdoc.lisp  maint.exp
====================================================================
RC		AUTO-KEYWORDS			2011 May 13

Added the AUTO-KEYWORDS code to INSERT-TPTP AND INSERT-TPTP*.
Enhanced the help message for AUTO-KEYWORDS.
Files changed:
llibrary2.lisp

===========================================================
RC	EXTEND THE TEST TOP-LEVEL TO MS-98	2011 May 13

The TEST top-level now can be used  with DEFAULT-MS set to  MS-98.


Files changed: 
test-top-search.lisp
==========================================================
RC	EXTEND THE TEST TOP-LEVEL 	2011 June 15
	TO MS03-7 and MS04-2

Files changed: 
ext-search.lisp  ms04-search.lisp  test-top-search.lisp  test-top-top.lisp
==========================================================
PBA	TPS3.INI ON ANDREW		2012 Feb 4

	When we try to run tps3 on an andrew cluster machine or unix
server, we have problems loading tps3.ini if all the available
directories are included in the backup-lib-dir. Got message
; Loading /afs/andrew.cmu.edu/mcs/math/etps/tps/amd64_linux26/tps3.ini
Error: File #P"/tmp/directoryG1395" does not exist.
	Therefore almost all of the directories are now commented out 
from the instruction to set-flag backup-lib-dir in the file
/afs/andrew.cmu.edu/mcs/math/etps/tps/amd64_linux26/tps3.ini
	Hardware improvements may make it possible to restore the
original version of the file at a later date.

Files changed: 
/afs/andrew.cmu.edu/mcs/math/etps/tps/amd64_linux26/tps3.ini
==========================================================
PBA	NEW LOCATION FOR TAR FILE 	2016 October 8

To accomodate changes in gtps several years ago, changed
ftp/pub to theorem/tarfiles

Files changed: 

/afs/andrew.cmu.edu/mcs/math/TPS/admin/tps-dist/make-tar.exe
home/pa01/pba/tps-dist.hlp
==========================================================